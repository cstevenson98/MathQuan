(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    455926,      10873]
NotebookOptionsPosition[    432637,      10527]
NotebookOutlinePosition[    433314,      10549]
CellTagsIndexPosition[    433271,      10546]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Using \[OpenCurlyDoubleQuote]mathQu.wl\[CloseCurlyDoubleQuote]", "Title",
 CellChangeTimes->{{3.784269893663621*^9, 3.7842699103511477`*^9}, {
  3.828522030257181*^9, 
  3.8285220651164427`*^9}},ExpressionUUID->"9a6541f6-6e5a-4a0b-81ae-\
684aa90ced29"],

Cell["\tConor Stevenson -- 2021 University of St Andrews", "Subsubtitle",
 CellChangeTimes->{{3.7842699137840157`*^9, 3.7842699335020723`*^9}, {
  3.828522069433734*^9, 
  3.8285220703608036`*^9}},ExpressionUUID->"cd367d62-e6f8-4e51-8feb-\
e88431a7f824"],

Cell["\<\
Mathematica has extensive linear algebraic capability including all the \
standard LAPACK routines and dense and sparse matrix functions. These \
techniques are central to the numerical solution of quantum problems, \
particularly in finite quantum systems and open quantum systems.

I here developed a straight-forward package which includes much of the \
familiar base features of the popular QuTiP library for python. That is, the \
standard spin and boson operators in sparse matrix form, along with \
time-evolution using master equations of both Lindblad and Redfield form.

This Notebook is mainly to walk through each of the features to show their \
use as applied to a variety of quantum problems.

Personally, I find the use of Mathematica akin to using Jupyter Notebooks, \
with a lot of the planning and \[OpenCurlyDoubleQuote]thinking out loud\
\[CloseCurlyDoubleQuote] happening in .nb files before being migrated to \
dedicated Wolfram and bash scripts to automate research tasks such as data \
collection and plot output.

I would also like to make a comment on efficiency. The main complaint of \
Mathematica as a performant numerical solution to physics problems is that it\
\[CloseCurlyQuote]s slow. This is not so, so long as one uses the in-built \
Mathematica functions which are implemented directly in C (LAPACK). For and \
Do loops should be avoided, as should any symbolic features except at the \
highest levels and when needed in specific scenarios (one of which I \
highlight below). Additionally, be cautious to always have numeric data be of \
the floating point type explicitly -- if using integers in place of floats \
this can implicitly request things to be computed in terms of, say, \
infinite-precision integer arithmetic which is slower. Having said that, \
certain operations benefit from symbolic algorithms, but this is a bit of an \
art.\
\>", "Text",
 CellChangeTimes->{{3.8285220886203737`*^9, 3.828522455004927*^9}, {
  3.8285226280082946`*^9, 3.82852287677265*^9}, {3.828523126309218*^9, 
  3.8285231265088778`*^9}},ExpressionUUID->"24652ef9-fa9b-4466-b8e4-\
62ecfeba1919"],

Cell[CellGroupData[{

Cell["\<\
Full definitions of all the spin operator and operator combination functions\
\>", "Subsection",
 CellChangeTimes->{{3.752402899780325*^9, 
  3.752402919424013*^9}},ExpressionUUID->"e6d358c6-3334-4296-a59b-\
d3b9da42052c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "MaTeX`"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Id", ",", "Sigmax", ",", "Sigmaz", ",", "Sigmay", ",", "Sigmap", ",", 
      "Sigmam"}], "}"}], "=", 
    RowBox[{"SparseArray", "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", GridBox[{
          {"1", "0"},
          {"0", "1"}
         }], ")"}], ",", 
       RowBox[{"(", GridBox[{
          {"0", "1"},
          {"1", "0"}
         }], ")"}], ",", 
       RowBox[{"(", GridBox[{
          {"1", "0"},
          {"0", 
           RowBox[{"-", "1"}]}
         }], ")"}], ",", 
       RowBox[{"(", GridBox[{
          {"0", 
           RowBox[{"-", "\[ImaginaryI]"}]},
          {"\[ImaginaryI]", "0"}
         }], ")"}], ",", 
       RowBox[{"(", GridBox[{
          {"0", "1"},
          {"0", "0"}
         }], ")"}], ",", 
       RowBox[{"(", GridBox[{
          {"0", "0"},
          {"1", "0"}
         }], ")"}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Sigma]", "x"], "=", "Sigmax"}], ";", 
   RowBox[{
    SubscriptBox["\[Sigma]", "y"], "=", "Sigmay"}], ";", 
   RowBox[{
    SubscriptBox["\[Sigma]", "z"], "=", "Sigmaz"}], ";", 
   RowBox[{
    SuperscriptBox["\[Sigma]", "+"], "=", "Sigmap"}], ";", 
   RowBox[{
    SuperscriptBox["\[Sigma]", "-"], "=", "Sigmam"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SpinOpSite", "[", 
     RowBox[{"Op_", ",", "n_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"SpinOpSite", "[", 
       RowBox[{"Op", ",", "n", ",", "i"}], "]"}], "=", 
      RowBox[{"Tensor", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         TagBox[GridBox[{
            {"\[Piecewise]", GridBox[{
               {"Op", 
                RowBox[{"i", "\[Equal]", "j"}]},
               {"Id", "True"}
              },
              AllowedDimensions->{2, Automatic},
              Editable->True,
              
              GridBoxAlignment->{
               "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{1.}}, "RowsIndexed" -> {}},
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.84]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.4]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}},
              Selectable->True]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.35]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}],
          "Piecewise",
          DeleteWithContents->True,
          Editable->False,
          SelectWithContents->True,
          Selectable->False,
          StripWrapperBoxes->True], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FermionBasisDown", "[", 
    RowBox[{"n_", ",", "1"}], "]"}], ":=", 
   RowBox[{"SpinOpSite", "[", 
    RowBox[{
     SuperscriptBox["\[Sigma]", "-"], ",", "n", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FermionBasisDown", "[", 
    RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Dot", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"MatrixExp", "[", 
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]", " ", 
          RowBox[{
           RowBox[{"SpinOpSite", "[", 
            RowBox[{
             SuperscriptBox["\[Sigma]", "+"], ",", "n", ",", "j"}], "]"}], 
           ".", 
           RowBox[{"SpinOpSite", "[", 
            RowBox[{
             SuperscriptBox["\[Sigma]", "-"], ",", "n", ",", "j"}], "]"}]}]}],
          "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], ".", 
    RowBox[{"SpinOpSite", "[", 
     RowBox[{
      SuperscriptBox["\[Sigma]", "-"], ",", "n", ",", "i"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AntiComm", "[", 
     RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"A", ".", "B"}], "+", 
     RowBox[{"B", ".", "A"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[ScriptCapitalI]", "n_Integer"], ":=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", "1."}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["2", "n"], ",", 
        SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Lower", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Lower", "[", "n", "]"}], "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[Equal]", 
           RowBox[{"i", "+", "1"}]}], ",", 
          SqrtBox["i"], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}], "//", "SparseArray"}]}], 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Raise", "[", "n_Integer", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Raise", "[", "n", "]"}], "=", 
      RowBox[{
       RowBox[{"Lower", "[", "n", "]"}], "\[Transpose]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fock", "[", 
    RowBox[{"nn_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"UnitVector", "[", 
     RowBox[{"nn", ",", 
      RowBox[{"m", "+", "1"}]}], "]"}], "//", "SparseArray"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NullVector", "[", "nn_", "]"}], ":=", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "nn", "}"}]}], "]"}], "//", "SparseArray"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Coherent", "[", 
     RowBox[{"nn_", ",", "\[Alpha]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "\[Alpha]", "]"}], "2"]}], "/", "2"}], "]"}], 
     RowBox[{
      RowBox[{"MatrixExp", "[", 
       RowBox[{"\[Alpha]", " ", 
        RowBox[{"Raise", "[", "nn", "]"}]}], "]"}], ".", 
      RowBox[{"Fock", "[", 
       RowBox[{"nn", ",", "0"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nF", "[", 
    RowBox[{"\[Omega]_", ",", "\[Mu]_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Omega]", "-", "\[Mu]"}], ")"}], "/", "T"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ja", "[", 
     RowBox[{"\[Omega]_", ",", "\[Omega]c_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[Omega]", "<", "0."}], ",", "0.", ",", 
      RowBox[{"\[Omega]", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"1", "-", 
          RowBox[{"\[Omega]", "/", "\[Omega]c"}]}], "]"}], "/", 
        "\[Omega]c"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AntiComm", "[", 
       RowBox[{
        RowBox[{"FermionBasisDown", "[", 
         RowBox[{"4", ",", "i"}], "]"}], ",", 
        RowBox[{
         RowBox[{"FermionBasisDown", "[", 
          RowBox[{"4", ",", "i"}], "]"}], "\[HermitianConjugate]"}]}], "]"}], 
      "\[Equal]", 
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["2", "4"], ",", 
         SuperscriptBox["2", "4"]}], "}"}], "]"}]}], ",", "1", ",", "0"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7524029541000557`*^9, 3.7524029787039104`*^9}, {
   3.752403012977374*^9, 3.752403155188507*^9}, {3.7524032848368998`*^9, 
   3.7524032957453456`*^9}, {3.752403471653829*^9, 3.752403594553835*^9}, {
   3.7524036260518513`*^9, 3.752403712587524*^9}, {3.752580755814713*^9, 
   3.7525808398156967`*^9}, {3.752580880452037*^9, 3.752580903912773*^9}, {
   3.778582168147667*^9, 3.7785821684543457`*^9}, {3.779085831917513*^9, 
   3.77908583522187*^9}, {3.7790859739653893`*^9, 3.779086036906725*^9}, {
   3.779086216321287*^9, 3.779086299765209*^9}, {3.779087339758369*^9, 
   3.779087374491026*^9}, {3.779087451943493*^9, 3.779087481762833*^9}, {
   3.779130800681019*^9, 3.7791308246701527`*^9}, {3.7791308818322678`*^9, 
   3.7791309497757673`*^9}, 3.779161067829756*^9, {3.779166152359089*^9, 
   3.779166162748077*^9}, {3.779166213869049*^9, 3.779166226984789*^9}, {
   3.779166289651268*^9, 3.7791662958385983`*^9}, 3.77927807931539*^9, 
   3.779278385107893*^9, 3.7792795119717093`*^9, {3.781591780883235*^9, 
   3.7815917946819363`*^9}, {3.784382095601736*^9, 3.784382211389722*^9}, {
   3.7854374493802147`*^9, 3.785437468777533*^9}, 3.7854375081398983`*^9, {
   3.7858362645558777`*^9, 3.78583626476232*^9}, {3.809938424100964*^9, 
   3.8099384927343187`*^9}, {3.809938602859049*^9, 3.809938612681089*^9}, {
   3.8099386522628527`*^9, 3.8099387074837914`*^9}, {3.810026743589511*^9, 
   3.810026759360602*^9}, {3.81045717772586*^9, 3.810457211592564*^9}, {
   3.810457253290311*^9, 3.810457363660892*^9}, {3.81045759559686*^9, 
   3.8104576016414127`*^9}, {3.810461955623769*^9, 3.810462097626955*^9}, {
   3.810462143539164*^9, 3.810462216341311*^9}, {3.810462266579268*^9, 
   3.810462309780086*^9}, {3.810462358601213*^9, 3.810462369736787*^9}, {
   3.810462450526062*^9, 3.810462777559969*^9}, {3.8285235028867617`*^9, 
   3.8285235056557913`*^9}},ExpressionUUID->"3dae8cad-8af4-4daf-b5f7-\
7ccf859d290d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"L", "[", 
    RowBox[{"\[Omega]c_", ",", "\[Mu]_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"nF", "[", 
         RowBox[{"\[Omega]", ",", "\[Mu]", ",", "T"}], "]"}]}], ")"}], 
      RowBox[{"ja", "[", 
       RowBox[{"\[Omega]", ",", "\[Omega]c"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]", ",", "0", ",", "5"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sdown", "[", 
    RowBox[{"\[Omega]p_", ",", "\[Omega]c_", ",", "\[Mu]_", ",", "T_"}], 
    "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"nF", "[", 
         RowBox[{"\[Omega]", ",", "\[Mu]", ",", "T"}], "]"}]}], ")"}], " ", 
      FractionBox[
       RowBox[{"ja", "[", 
        RowBox[{"\[Omega]", ",", "\[Omega]c"}], "]"}], 
       RowBox[{"\[Omega]", "-", "\[Omega]p"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]", ",", "0", ",", "\[Omega]p", ",", "\[Infinity]"}], 
      "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<PrincipalValue\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sup", "[", 
    RowBox[{"\[Omega]p_", ",", "\[Omega]c_", ",", "\[Mu]_", ",", "T_"}], 
    "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"nF", "[", 
       RowBox[{"\[Omega]", ",", "\[Mu]", ",", "T"}], "]"}], " ", 
      FractionBox[
       RowBox[{"ja", "[", 
        RowBox[{"\[Omega]", ",", "\[Omega]c"}], "]"}], 
       RowBox[{"\[Omega]", "-", "\[Omega]p"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]", ",", "0", ",", "\[Omega]p", ",", "\[Infinity]"}], 
      "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<PrincipalValue\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8099387103016376`*^9, 3.809938751155712*^9}, {
   3.8099388485598507`*^9, 3.809938914647908*^9}, {3.809938947981216*^9, 
   3.809939105051347*^9}, {3.809939195838532*^9, 3.809939198378809*^9}, {
   3.8099392802946033`*^9, 3.809939323511849*^9}, 3.809942355107957*^9, {
   3.809942462289371*^9, 3.809942465976995*^9}, {3.809945590750607*^9, 
   3.809945599089279*^9}, {3.80994747659958*^9, 3.8099474790151863`*^9}, {
   3.809957455178482*^9, 3.8099574618625097`*^9}, {3.809957513148328*^9, 
   3.80995751943511*^9}, {3.810017297668744*^9, 3.810017330309875*^9}, {
   3.810018193898939*^9, 3.810018214621132*^9}},
 CellLabel->
  "In[279]:=",ExpressionUUID->"64f09110-8704-405a-b419-265879908b21"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]c", "=", "5."}], ",", 
     RowBox[{"\[Mu]", "=", "3."}], ",", 
     RowBox[{"T", "=", "0.1"}]}], "}"}], ",", 
   RowBox[{"GraphicsRow", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"nF", "[", 
            RowBox[{"\[Omega]", ",", "\[Mu]", ",", "T"}], "]"}]}], ")"}], 
         RowBox[{"ja", "[", 
          RowBox[{"\[Omega]", ",", "\[Omega]c"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ListLinePlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"Sdown", "[", 
            RowBox[{"x", ",", "\[Omega]c", ",", "\[Mu]", ",", "T"}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "10."}], ",", "10.", ",", 
           RowBox[{"20.", "/", "219"}]}], "}"}]}], "]"}]}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8099391077576017`*^9, 3.8099391865135307`*^9}, {
  3.809939221042955*^9, 3.809939262302004*^9}, {3.809939300814755*^9, 
  3.809939344936776*^9}, {3.809942373557108*^9, 3.809942410816886*^9}, {
  3.8099446571750927`*^9, 3.809944658035961*^9}, {3.8100179346725197`*^9, 
  3.810018019723794*^9}, {3.8100390686284513`*^9, 3.810039128739778*^9}, {
  3.810039427255187*^9, 3.8100394506375303`*^9}, {3.8100394863191967`*^9, 
  3.8100395355930862`*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"2674cfca-836d-4988-a99b-5bed0697764d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "going", " ", "to", " ", "construct", " ", "the", 
    " ", "left", " ", "and", " ", "right", " ", "dissipators", " ", "for", 
    " ", "reservoirs", " ", "at"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fermionicLower", "[", 
      RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"fermionicLower", "[", 
        RowBox[{"n", ",", "i"}], "]"}], "=", 
       RowBox[{"Tensor", "@@", 
        RowBox[{"Table", "[", 
         RowBox[{
          TagBox[GridBox[{
             {"\[Piecewise]", GridBox[{
                {
                 RowBox[{"Lower", "[", "2", "]"}], 
                 RowBox[{"j", "\[Equal]", "i"}]},
                {"Id", "True"}
               },
               AllowedDimensions->{2, Automatic},
               Editable->True,
               
               GridBoxAlignment->{
                "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{1.}}, "RowsIndexed" -> {}},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}},
               Selectable->True]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{1.}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.35]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           "Piecewise",
           DeleteWithContents->True,
           Editable->False,
           SelectWithContents->True,
           Selectable->False,
           StripWrapperBoxes->True], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FermiHubbardModel", "[", 
     RowBox[{"n_", ",", "\[Mu]0_", ",", "J_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cList", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"FermionBasisDown", "[", 
            RowBox[{"n", ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"H", "=", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["2", "n"], ",", 
             SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"H", "+=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"\[Mu]0", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "cList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "\[HermitianConjugate]"}], ".", 
            RowBox[{
            "cList", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"H", "+=", 
          RowBox[{
           RowBox[{"-", "J"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "cList", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "\[HermitianConjugate]"}], ".", 
              RowBox[{"cList", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}], "+", 
             RowBox[{
              RowBox[{
               RowBox[{"cList", "\[LeftDoubleBracket]", 
                RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], 
               "\[HermitianConjugate]"}], ".", 
              RowBox[{"cList", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}]}], 
            ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "H", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FermiHubbardTransport", "[", 
     RowBox[{"n_", ",", 
      RowBox[{"{", 
       RowBox[{"\[Mu]0_", ",", "J_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\[Kappa]list_", ",", "\[Omega]clist_", ",", "\[Mu]list_", ",", 
        "Tlist_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cList", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"FermionBasisDown", "[", 
            RowBox[{"n", ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"H", "=", 
         RowBox[{"FermiHubbardModel", "[", 
          RowBox[{"n", ",", "\[Mu]0", ",", "J"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "Eigeneners", ",", "Eigenstates", ",", 
        "Projectors", ",", "\[IndentingNewLine]", "\[CapitalGamma]down", ",", 
        "\[CapitalGamma]up", ",", "AdownList", ",", "AupList", ",", 
        "\[IndentingNewLine]", "DissipatorList"}], "\[IndentingNewLine]", 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Eigenstates", " ", "and", " ", "projectors"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eigeneners", "=", 
        RowBox[{"Eigenvalues", "[", "H", "]"}]}], ";", 
       RowBox[{"Eigenstates", "=", 
        RowBox[{"Eigenvectors", "[", "H", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Projectors", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", "#", ",", "#"}], "]"}], "&"}], "/@", 
         "Eigenstates"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Complex", " ", "damping", " ", "rate", " ", "of", " ", "nth", " ", 
         "Fermi", " ", "bath"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalGamma]down", "[", 
         RowBox[{"i_", ",", "\[Omega]_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
         "\[Kappa]list", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ja", "[", 
             RowBox[{"\[Omega]", ",", 
              RowBox[{
              "\[Omega]clist", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"nF", "[", 
               RowBox[{"\[Omega]", ",", 
                RowBox[{
                "\[Mu]list", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{
                "Tlist", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            FractionBox["\[ImaginaryI]", "\[Pi]"], 
            RowBox[{"Sdown", "[", 
             RowBox[{"\[Omega]", ",", 
              RowBox[{
              "\[Omega]clist", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "\[Mu]list", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "Tlist", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "]"}]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalGamma]up", "[", 
         RowBox[{"i_", ",", "\[Omega]_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
         "\[Kappa]list", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ja", "[", 
             RowBox[{"\[Omega]", ",", 
              RowBox[{
              "\[Omega]clist", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "]"}], 
            RowBox[{"nF", "[", 
             RowBox[{"\[Omega]", ",", 
              RowBox[{
              "\[Mu]list", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "Tlist", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "]"}]}], "+", 
           RowBox[{
            FractionBox["\[ImaginaryI]", "\[Pi]"], 
            RowBox[{"Sup", "[", 
             RowBox[{"\[Omega]", ",", 
              RowBox[{
              "\[Omega]clist", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "\[Mu]list", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "Tlist", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "]"}]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Contruct", " ", "the", " ", "Redfield", " ", "jump", " ", 
         "operators", " ", "for", " ", "electron", " ", "tunneling", " ", 
         "from", " ", "site", " ", "n", " ", "to", " ", "bath", " ", 
         RowBox[{"n", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"AdownList", "=", 
        RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalGamma]down", "[", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{
                "Eigeneners", "\[LeftDoubleBracket]", "l", 
                 "\[RightDoubleBracket]"}], "-", 
                RowBox[{
                "Eigeneners", "\[LeftDoubleBracket]", "m", 
                 "\[RightDoubleBracket]"}]}]}], "]"}], 
             RowBox[{
              RowBox[{
              "Projectors", "\[LeftDoubleBracket]", "l", 
               "\[RightDoubleBracket]"}], ".", 
              RowBox[{
              "cList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               ".", 
              RowBox[{
              "Projectors", "\[LeftDoubleBracket]", "m", 
               "\[RightDoubleBracket]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", 
              RowBox[{"2", "^", "n"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", 
              RowBox[{"2", "^", "n"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AupList", "=", 
        RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalGamma]up", "[", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{
                "Eigeneners", "\[LeftDoubleBracket]", "l", 
                 "\[RightDoubleBracket]"}], "-", 
                RowBox[{
                "Eigeneners", "\[LeftDoubleBracket]", "m", 
                 "\[RightDoubleBracket]"}]}]}], "]"}], 
             RowBox[{
              RowBox[{
              "Projectors", "\[LeftDoubleBracket]", "l", 
               "\[RightDoubleBracket]"}], ".", 
              RowBox[{
              "cList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               ".", 
              RowBox[{
              "Projectors", "\[LeftDoubleBracket]", "m", 
               "\[RightDoubleBracket]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", 
              RowBox[{"2", "^", "n"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", 
              RowBox[{"2", "^", "n"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Construct", " ", "site"}], "-", "by", "-", 
         RowBox[{"site", " ", "dissipator"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"DissipatorList", " ", "=", 
        RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"termdown", "=", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"SuperLR", "[", 
                 RowBox[{
                  RowBox[{
                  "AdownList", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                   RowBox[{
                   "cList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "\[HermitianConjugate]"}]}], 
                 "]"}], "-", 
                RowBox[{"SuperLR", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "cList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "\[HermitianConjugate]"}], ".", 
                   RowBox[{
                   "AdownList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{"IdentityMatrix", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "n"], ",", 
                    SuperscriptBox["2", "n"]}], "}"}], "]"}]}], "]"}], 
                "\[IndentingNewLine]", "+", 
                RowBox[{"SuperLR", "[", 
                 RowBox[{
                  RowBox[{
                  "cList", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                   RowBox[{
                   "AdownList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "\[HermitianConjugate]"}]}], 
                 "]"}], "-", 
                RowBox[{"SuperLR", "[", 
                 RowBox[{
                  RowBox[{"IdentityMatrix", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "n"], ",", 
                    SuperscriptBox["2", "n"]}], "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "AdownList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "\[HermitianConjugate]"}], ".", 
                   RowBox[{
                   "cList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"termup", "=", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"SuperLR", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "AupList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "\[HermitianConjugate]"}], ",", 
                  RowBox[{
                  "cList", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], "]"}], "-", 
                RowBox[{"SuperLR", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "cList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ".", 
                   RowBox[{
                    RowBox[{
                    "AdownList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "\[HermitianConjugate]"}]}], 
                  ",", 
                  RowBox[{"IdentityMatrix", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "n"], ",", 
                    SuperscriptBox["2", "n"]}], "}"}], "]"}]}], "]"}], 
                "\[IndentingNewLine]", "+", 
                RowBox[{"SuperLR", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "cList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "\[HermitianConjugate]"}], ",", 
                  RowBox[{
                  "AupList", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], "]"}], "-", 
                RowBox[{"SuperLR", "[", 
                 RowBox[{
                  RowBox[{"IdentityMatrix", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "n"], ",", 
                    SuperscriptBox["2", "n"]}], "}"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{
                   "AdownList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ".", 
                   RowBox[{
                    RowBox[{
                    "cList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "\[HermitianConjugate]"}]}]}], 
                 "]"}]}]}]}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"termdown", "+", 
             RowBox[{"termdown", "\[HermitianConjugate]"}]}]}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"+", "termup"}], "+", 
             RowBox[{"termup", "\[HermitianConjugate]"}]}], "*)"}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"RedfieldList", "=", 
    RowBox[{"Block", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", "2"}], ",", 
        RowBox[{"\[Mu]0", "=", "1."}], ",", 
        RowBox[{"J", "=", "0."}], ",", "\[IndentingNewLine]", 
        RowBox[{"\[Kappa]list", "=", 
         RowBox[{"{", 
          RowBox[{".1", ",", ".1", ",", ".1"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Omega]clist", "=", 
         RowBox[{"{", 
          RowBox[{"5.", ",", "5.", ",", "5."}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Mu]list", "=", 
         RowBox[{"{", 
          RowBox[{"5.", ",", "5.", ",", "5."}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Tlist", "=", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", "0.5", ",", "0.5"}], "}"}]}], ",", 
        "\[IndentingNewLine]", "H", ",", "\[IndentingNewLine]", 
        "\[ScriptCapitalD]list", ",", "\[ScriptCapitalL]tot", ",", 
        "\[IndentingNewLine]", "\[Rho]SS"}], "\[IndentingNewLine]", "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"H", "=", 
        RowBox[{"FermiHubbardModel", "[", 
         RowBox[{"n", ",", "\[Mu]0", ",", "J"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[ScriptCapitalD]list", "=", 
        RowBox[{"FermiHubbardTransport", "[", 
         RowBox[{"n", ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]0", ",", "J"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\[Kappa]list", ",", "\[Omega]clist", ",", "\[Mu]list", ",", 
            "Tlist"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Eigenvalues", "[", "H", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[ScriptCapitalL]tot", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"SuperComm", "[", "H", "]"}]}], "+", 
         RowBox[{"Total", "[", "\[ScriptCapitalD]list", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[ScriptCapitalL]Lind", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"SuperComm", "[", "H", "]"}]}], "+", " ", 
         RowBox[{"0.0001", 
          RowBox[{"Lindblad", "[", 
           RowBox[{"FermionBasisDown", "[", 
            RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{"0.0001", 
          RowBox[{"Lindblad", "[", 
           RowBox[{
            RowBox[{"FermionBasisDown", "[", 
             RowBox[{"n", ",", "2"}], "]"}], "\[HermitianConjugate]"}], 
           "]"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"\[ScriptCapitalL]tot", "//", "Print"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"\[ScriptCapitalL]Lind", ",", 
          RowBox[{"-", "1"}]}], "]"}], "//", "Print"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Rho]SS", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Eigenvectors", "[", 
           RowBox[{"\[ScriptCapitalL]Lind", ",", 
            RowBox[{"-", "1"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], "//", "toHilbert"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Rho]SS", "*=", 
        RowBox[{"1", "/", 
         RowBox[{"Tr", "[", "\[Rho]SS", "]"}]}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"FermionBasisDown", "[", 
                RowBox[{"n", ",", "i"}], "]"}], "\[HermitianConjugate]"}], 
              ".", 
              RowBox[{"FermionBasisDown", "[", 
               RowBox[{"n", ",", "i"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ".", "\[Rho]SS"}], 
          "]"}], "//", "Chop"}], "//", "Print"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"FermionBasisDown", "[", 
                RowBox[{"n", ",", "i"}], "]"}], "\[HermitianConjugate]"}], 
              ".", 
              RowBox[{"FermionBasisDown", "[", 
               RowBox[{"n", ",", "i"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ".", 
           RowBox[{"toHilbert", "[", 
            RowBox[{"\[ScriptCapitalL]tot", ".", 
             RowBox[{"Vectorise", "[", "\[Rho]SS", "]"}]}], "]"}]}], "]"}], "//",
          "Chop"}], "//", "Print"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Tr", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"FermionBasisDown", "[", 
               RowBox[{"n", ",", "i"}], "]"}], "\[HermitianConjugate]"}], ".", 
             RowBox[{"FermionBasisDown", "[", 
              RowBox[{"n", ",", "i"}], "]"}], ".", "\[Rho]SS"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "//", "Chop"}], "//", 
        "Print"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.809947519924878*^9, 3.809947569332129*^9}, {
   3.809948039458606*^9, 3.809948056306287*^9}, {3.809948317875773*^9, 
   3.8099483852078667`*^9}, {3.809948424148395*^9, 3.8099485520736933`*^9}, 
   3.809948926618207*^9, {3.809948956630784*^9, 3.8099491370990963`*^9}, {
   3.8099491951223173`*^9, 3.809949223017823*^9}, {3.809949363601625*^9, 
   3.8099494692797318`*^9}, {3.8099495419479647`*^9, 3.809949561716856*^9}, {
   3.809949607343601*^9, 3.8099496596927433`*^9}, {3.809949710054335*^9, 
   3.809949842191448*^9}, {3.809949875330742*^9, 3.8099498902013197`*^9}, {
   3.809950081439334*^9, 3.80995020873442*^9}, {3.809950481172928*^9, 
   3.80995054285951*^9}, {3.809950581235783*^9, 3.8099506966179667`*^9}, {
   3.8099507271930437`*^9, 3.809950803833375*^9}, {3.809950860731752*^9, 
   3.809950927950436*^9}, {3.8099511488019667`*^9, 3.809951153447633*^9}, {
   3.8099512087969093`*^9, 3.809951462350431*^9}, {3.80995149491591*^9, 
   3.809951506503789*^9}, {3.809951538443882*^9, 3.8099515839056063`*^9}, {
   3.809955115275443*^9, 3.809955237980029*^9}, {3.809955470112423*^9, 
   3.809955502638975*^9}, {3.8099571780024242`*^9, 3.809957229678849*^9}, {
   3.809957349036037*^9, 3.8099573516123457`*^9}, {3.810017349810175*^9, 
   3.810017371910901*^9}, {3.81001744356478*^9, 3.810017444404105*^9}, {
   3.81001749383353*^9, 3.810017549704894*^9}, {3.810017606529202*^9, 
   3.810017641730761*^9}, {3.810017762084551*^9, 3.8100178187181883`*^9}, {
   3.8100178994802933`*^9, 3.8100179092350397`*^9}, 3.810018073640456*^9, {
   3.810018133436195*^9, 3.8100181801957197`*^9}, {3.810018363434574*^9, 
   3.810018394170039*^9}, 3.8100185050521107`*^9, {3.81001911095951*^9, 
   3.810019122930608*^9}, {3.810019172274081*^9, 3.810019182967683*^9}, {
   3.810019252225539*^9, 3.8100194378408833`*^9}, {3.810019541157978*^9, 
   3.8100195938034143`*^9}, {3.810020160234063*^9, 3.8100201614990883`*^9}, {
   3.810020446635233*^9, 3.81002053057638*^9}, {3.810020648362792*^9, 
   3.810020686405672*^9}, {3.810020851466681*^9, 3.810021111853847*^9}, {
   3.810021202445155*^9, 3.810021253292383*^9}, {3.810021291641943*^9, 
   3.810021296439643*^9}, {3.810022517933169*^9, 3.8100226686949577`*^9}, {
   3.810022862144005*^9, 3.8100229372119417`*^9}, {3.810023187771207*^9, 
   3.810023210951592*^9}, {3.810023880682281*^9, 3.810023884430455*^9}, {
   3.8100240229347486`*^9, 3.8100240815586033`*^9}, {3.810024237957959*^9, 
   3.810024275243597*^9}, {3.810024930114163*^9, 3.810024960806938*^9}, {
   3.810024998441482*^9, 3.810025267612412*^9}, {3.810025318699492*^9, 
   3.810025377259637*^9}, 3.8100256312987757`*^9, {3.810026141853516*^9, 
   3.810026305649989*^9}, {3.81002638094116*^9, 3.8100266764033318`*^9}, {
   3.810026813258568*^9, 3.810026813705111*^9}, {3.810027510948174*^9, 
   3.8100276195458384`*^9}, 3.810027933354397*^9, {3.810027966374349*^9, 
   3.8100279996481113`*^9}, {3.810028029667705*^9, 3.810028040863804*^9}, {
   3.8100289028383713`*^9, 3.810028951665565*^9}, {3.810029160677545*^9, 
   3.810029161901497*^9}, {3.8100294146508293`*^9, 3.810029415144853*^9}, {
   3.8100310721793613`*^9, 3.810031110884076*^9}, {3.810031363452684*^9, 
   3.810031377673606*^9}, {3.810031523005352*^9, 3.810031523077203*^9}, {
   3.8100315829839277`*^9, 3.810031619607256*^9}, {3.810031656885921*^9, 
   3.810031664860053*^9}, {3.810031715468183*^9, 3.8100317936012783`*^9}, {
   3.810031824564839*^9, 3.810031828223686*^9}, {3.8100318839755297`*^9, 
   3.810031937704968*^9}, {3.8100320131520767`*^9, 3.810032028431802*^9}, {
   3.810032566232006*^9, 3.810032579429536*^9}, {3.810032778932313*^9, 
   3.810032827313855*^9}, {3.810033133307884*^9, 3.8100331513379583`*^9}, {
   3.810463407023649*^9, 3.810463479148491*^9}, {3.810463539610661*^9, 
   3.810463544472748*^9}, {3.810465143515758*^9, 3.810465212551289*^9}, {
   3.810465538290996*^9, 3.810465540214293*^9}, {3.810465715545569*^9, 
   3.810465720392984*^9}, {3.8104657763576736`*^9, 3.810465778644418*^9}, {
   3.8104658277107983`*^9, 3.8104658644088783`*^9}, {3.810465915099831*^9, 
   3.8104660563856792`*^9}, {3.810466551468625*^9, 3.8104665582001333`*^9}, {
   3.8104667745512257`*^9, 3.81046681186036*^9}, {3.8104669675624323`*^9, 
   3.8104669680503597`*^9}, 3.810466999386141*^9, 3.8104670790698566`*^9, {
   3.81046715211897*^9, 3.810467206888359*^9}, {3.810467252338249*^9, 
   3.810467345828848*^9}, 3.810467383651374*^9, {3.810467418588684*^9, 
   3.8104674435614967`*^9}},
 CellLabel->
  "In[442]:=",ExpressionUUID->"ddd986c8-1c40-42da-8b38-49dac05edf17"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FermiHubbardModel", "[", 
   RowBox[{"3", ",", "10.", ",", "0.01"}], "]"}], "//", 
  "Eigenvalues"}]], "Input",
 CellChangeTimes->{{3.810465270670122*^9, 3.8104652852615747`*^9}, {
  3.810465328126658*^9, 3.810465329381921*^9}, {3.8104656149493437`*^9, 
  3.810465649815207*^9}},
 CellLabel->
  "In[321]:=",ExpressionUUID->"a8ebe624-eae2-44b3-8473-b672fa534667"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8100264470757504`*^9, 
  3.810026463652474*^9}},ExpressionUUID->"841f3749-93f3-4719-bd3c-\
5a674d4c75cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FermiHubbardModel", "[", 
   RowBox[{"3", ",", "\[Mu]", ",", "J"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.81002389169855*^9, 3.810023919387377*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"ff930e79-fb54-4e46-846f-495579bf6ee1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]Lorentzian", "[", 
    RowBox[{"\[Omega]0_", ",", "a_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"a", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["a", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"#", "-", "\[Omega]0"}], ")"}], "2"], "+", 
         SuperscriptBox["a", "2"]}]], "+", 
       RowBox[{"I", " ", 
        FractionBox[
         RowBox[{"#", "-", "\[Omega]0"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"#", "-", "\[Omega]0"}], ")"}], "2"], "+", 
          SuperscriptBox["a", "2"]}]]}]}], ")"}]}], "&"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.785836280177291*^9, 3.7858363201822767`*^9}, {
  3.785836384132866*^9, 3.785836390166657*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"204c0c21-9098-4e09-a003-0b4e70dd73d2"],

Cell["\<\
Mathematica outputs eigensystems in the order of increasing eigenvalue.\
\>", "Text",
 CellChangeTimes->{{3.7524032408787603`*^9, 
  3.752403279402273*^9}},ExpressionUUID->"efaa4c7d-7842-46c8-8943-\
e901b56610d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Tensor", "[", "oper__", "]"}], ":=", 
    RowBox[{"KroneckerProduct", "[", "oper", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Allow", " ", "for", " ", "the", " ", "notation", " ", 
    RowBox[{"A", " ", "\[CircleTimes]", " ", 
     RowBox[{"B", ":"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CircleTimes", "[", "oper__", "]"}], ":=", 
   RowBox[{"Tensor", "[", "oper", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.752403310310183*^9, 3.752403330169671*^9}, {
   3.7524033628637357`*^9, 3.7524033641300154`*^9}, {3.75240341114476*^9, 
   3.752403439776677*^9}, {3.7524037309768853`*^9, 3.7524037409061584`*^9}, 
   3.7524380322181916`*^9, {3.7532904985512075`*^9, 3.7532905191003857`*^9}, {
   3.7532905510268736`*^9, 3.753290580499654*^9}, {3.7790858482136374`*^9, 
   3.77908585265187*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"59e8dcb7-d84c-4d9a-9c85-b60dd571a4cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Superoperators", "Subsection",
 CellChangeTimes->{{3.7524029242112556`*^9, 
  3.7524029285637493`*^9}},ExpressionUUID->"44d65023-07d0-4aa4-bc98-\
4d2d9ea1c09c"],

Cell["\<\
Superoperators are the analogue of operators acting on wavefunctions extended \
to density matrices. We wish to perform meaningful operations on density \
matrices \[Rho] so that we can build dynamical equations and solve for steady \
states, etc. Let us first take the density operator (matrix) \[Rho] and make \
a mapping from this to a vectorised version of \[Rho],\
\>", "Text",
 CellChangeTimes->{{3.7524037752721043`*^9, 3.752403921305231*^9}, {
  3.7524039605756216`*^9, 
  3.752404002514451*^9}},ExpressionUUID->"75679fcb-6d09-4191-8339-\
0ff6b84ad41f"],

Cell[CellGroupData[{

Cell["\<\
\t\t\[Rho] \[LongRightArrow] |\[Rho]\[RightAngleBracket]\[RightAngleBracket].
\
\>", "Subsubsubsubsection",
 CellChangeTimes->{{3.7524040119240427`*^9, 
  3.7524040784417515`*^9}},ExpressionUUID->"a28bb186-20f2-44da-b2c0-\
91082fdf4b55"],

Cell["\<\
This is possible by using Mathematica\[CloseCurlyQuote]s \
\[OpenCurlyQuote]Flatten[]\[CloseCurlyQuote]. It removes brackets to effect a \
vectorisation:\
\>", "Text",
 CellChangeTimes->{{3.7524040881271734`*^9, 3.7524041364854574`*^9}, {
  3.752404202906603*^9, 
  3.752404203578201*^9}},ExpressionUUID->"4aa6145b-e948-4287-9f8d-\
5caed4184481"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Vectorise", "[", "mat_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"mat", "\[Transpose]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7524041391369286`*^9, 3.7524041589266014`*^9}, {
  3.7524065329817*^9, 3.752406559185114*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"7d56c287-4d0e-4167-960f-eaa45eb6b0f3"],

Cell["\<\
Vectorisation in this manner is the result you get when you stack up the \
columns in a vector from left to right.\
\>", "Text",
 CellChangeTimes->{{3.7524065984605064`*^9, 
  3.7524066289729433`*^9}},ExpressionUUID->"b9016e34-1a93-4e4b-914c-\
81b28cd844d7"],

Cell[BoxData[
 RowBox[{"Vectorise", "[", 
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["c", "##"], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7524042065664897`*^9, 3.7524042458326817`*^9}, 
   3.7527657041571074`*^9},
 CellLabel->
  "In[180]:=",ExpressionUUID->"bb63ba91-911e-4baf-87e8-4667d8b1fc43"],

Cell["\<\
It is possible to invert this operation simply by using ArrayReshape:\
\>", "Text",
 CellChangeTimes->{{3.752765568073462*^9, 3.752765608588591*^9}, {
  3.752765818833599*^9, 
  3.752765821248074*^9}},ExpressionUUID->"73aaf152-b23f-47d9-b97a-\
e8a9836d0e60"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toHilbert", "[", "vect_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ArrayReshape", "[", 
     RowBox[{"vect", ",", 
      RowBox[{"{", 
       RowBox[{
        SqrtBox[
         RowBox[{"Length", "[", "vect", "]"}]], ",", 
        SqrtBox[
         RowBox[{"Length", "[", "vect", "]"}]]}], "}"}]}], "]"}], 
    "\[Transpose]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.752765610914179*^9, 3.752765681370473*^9}, {
  3.752765750027845*^9, 3.7527657508142023`*^9}, {3.7527667700038977`*^9, 
  3.752766778328246*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"851d5e77-02e3-4b74-a50a-aab265c2aa0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["c", "##"], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "==", 
  RowBox[{"toHilbert", "[", 
   RowBox[{"Vectorise", "[", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["c", "##"], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.752765686680977*^9, 3.752765739282625*^9}, {
  3.7527657864638443`*^9, 3.7527657973383007`*^9}, {3.76882330817766*^9, 
  3.768823311583707*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"fa5ea1a5-8727-4d83-80df-2bfd26c9eeb7"],

Cell["When we encounter an operator expression of the form", "Text",
 CellChangeTimes->{{3.752404286875544*^9, 3.7524042949884653`*^9}, {
  3.752404328882131*^9, 
  3.7524043386811266`*^9}},ExpressionUUID->"45a8a8a8-fe2f-4451-a878-\
caeb8d19c26d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\t\tABC...\[Rho]...XYZ,", "Subsubsubsubsection",
 CellChangeTimes->{{3.7524043500879574`*^9, 
  3.752404408816919*^9}},ExpressionUUID->"7db30a52-c1bc-49df-8a23-\
8363b8960b4f"],

Cell["\<\
the result is some other density matrix. In the superoperator analogy, the \
new state is a vectorised density matrix \[Gamma] such that \
\>", "Text",
 CellChangeTimes->{{3.752404404900082*^9, 
  3.7524044627478523`*^9}},ExpressionUUID->"c13877c1-a28f-4a92-9ff9-\
1e61c09f6838"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\t\t|\[Gamma]\[RightAngleBracket]\[RightAngleBracket] = ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[ScriptCapitalS]", "^"], TraditionalForm]],ExpressionUUID->
  "e1a3b279-1577-4aa4-865c-7dca5de302a4"],
 " |\[Rho]\[RightAngleBracket]\[RightAngleBracket],"
}], "Subsubsubsubsection",
 CellChangeTimes->{{3.752404488563984*^9, 3.7524045575810432`*^9}, {
  3.7524046099178534`*^9, 
  3.752404614412609*^9}},ExpressionUUID->"341a1913-fd2a-47e6-b4c5-\
fbd1f0e06ae3"],

Cell[TextData[{
 "where the superoperator ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[ScriptCapitalS]", "^"], TraditionalForm]],ExpressionUUID->
  "c5d5ead8-80f2-4c86-811d-425c86392302"],
 " is an operator which does the same operation as ABC...\[Rho]...XYZ but in \
the vectorised space. Since \[Rho] can appear in between any combination of \
operators, we need to conceive of left and right multiplication of density \
matrices to appropriately calculate the elements of ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[ScriptCapitalS]", "^"], TraditionalForm]],ExpressionUUID->
  "ff56d4e3-38d0-4783-849f-8048e604debf"],
 "."
}], "Text",
 CellChangeTimes->{{3.7524045603234797`*^9, 3.752404566237644*^9}, {
  3.7524046190504713`*^9, 3.7524046994863553`*^9}, {3.7524047403618135`*^9, 
  3.7524047696327925`*^9}, {3.752405176115368*^9, 
  3.7524052358280478`*^9}},ExpressionUUID->"249cd4e8-7808-4c43-b61e-\
6379ab302bfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SuperLR", "[", 
    RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
   RowBox[{"Tensor", "[", 
    RowBox[{
     RowBox[{"B", "\[Transpose]"}], ",", "A"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.752405701182703*^9, 3.752405732173995*^9}, {
   3.752406054582659*^9, 3.7524061163920655`*^9}, {3.7524063420701914`*^9, 
   3.7524063422650785`*^9}, {3.7524063885564322`*^9, 3.7524064383717475`*^9}, 
   3.752406564116284*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"61935a72-8996-4cd5-83ae-858493c11171"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Rho]", "=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalRho]", "##"], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"\[Rho]vec", "=", 
    RowBox[{"Vectorise", "[", "\[Rho]", "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vectorise", "[", 
     RowBox[{"Sigmax", ".", "\[Rho]", ".", "Sigmaz"}], "]"}], "==", 
    RowBox[{
     RowBox[{"SuperLR", "[", 
      RowBox[{"Sigmax", ",", "Sigmaz"}], "]"}], ".", "\[Rho]vec"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.752406136716362*^9, 3.7524061454893103`*^9}, {
   3.752406216850678*^9, 3.7524063294224844`*^9}, {3.7524064182203503`*^9, 
   3.7524064198603954`*^9}, {3.7524067213657866`*^9, 
   3.7524067226820283`*^9}, {3.7524394930547247`*^9, 3.752439493213643*^9}, 
   3.754700083275473*^9},
 CellLabel->
  "In[184]:=",ExpressionUUID->"d219b44e-3e74-4a04-b231-00fdd9c7c52c"],

Cell["\<\
Simple left (or right) multiplication can be achieved by setting one of A, B \
in the definition of SuperLR[] to an identity matrix.\
\>", "Text",
 CellChangeTimes->{{3.7524067317638893`*^9, 3.7524067337959146`*^9}, {
   3.7524380693597975`*^9, 3.752438113041649*^9}, 
   3.752741371044952*^9},ExpressionUUID->"2854c931-81c1-46c2-b632-\
1d0585bfe9f7"],

Cell[TextData[{
 "\tOften, we are interested in the commutator of the density matrix with \
some operator, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"[", 
     RowBox[{
      OverscriptBox["O", "^"], ",", " ", "\[Rho]"}], "]"}], "."}], 
   TraditionalForm]],ExpressionUUID->"f1f011ee-895d-4c82-97f1-3c3092af12e3"],
 " This is achieved with the following code:"
}], "Text",
 CellChangeTimes->{{3.7531833255472183`*^9, 
  3.753183385661895*^9}},ExpressionUUID->"e879f5bd-5afe-4342-828c-\
aff492ea092a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SuperComm", "[", "oper_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dims", "=", 
       RowBox[{"Dimensions", "[", "oper", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"SuperLR", "[", 
       RowBox[{"oper", ",", " ", 
        RowBox[{"IdentityMatrix", "[", "dims", "]"}]}], "]"}], "-", 
      RowBox[{"SuperLR", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "dims", "]"}], ",", "oper"}], 
       "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.753183387408177*^9, 3.753183523835288*^9}, {
  3.753183723360302*^9, 3.753183724490962*^9}, {3.753183811688159*^9, 
  3.753183816408598*^9}, {3.778502691646597*^9, 3.778502721772224*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"8016488b-2c3a-4787-8b74-9a88a21824dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SuperComm", "[", "Sigmaz", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.778502694343569*^9, 3.7785027114695168`*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"514efa67-3e6f-4e09-83da-60e4417d0d5c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hamiltonian operator for anisotropic XY Model", "Subsection",
 CellChangeTimes->{{3.7524029369059625`*^9, 
  3.7524029470171447`*^9}},ExpressionUUID->"243bebf4-710c-4e0c-be88-\
8cda197bba95"],

Cell[TextData[{
 "First, define spin hopping between adjacent sites ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "i"], "+"], TraditionalForm]],ExpressionUUID->
  "b42dcfa7-d030-48c8-959d-7b2984945a25"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", 
     RowBox[{"i", "+", "1"}]], "-"], TraditionalForm]],ExpressionUUID->
  "79bed5a4-2601-401e-88c5-b6c61bc534be"],
 " +",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "i"], "-"]}], TraditionalForm]],ExpressionUUID->
  "70e1b0aa-98da-4d12-9969-6869510b989a"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", 
     RowBox[{"i", "+", "1"}]], "+"], TraditionalForm]],ExpressionUUID->
  "c123abb7-6702-4039-85c9-dcb71618676b"],
 ":"
}], "Text",
 CellChangeTimes->{{3.7524378360261703`*^9, 3.7524378947623415`*^9}, {
  3.7524379308455615`*^9, 3.7524379400892396`*^9}, {3.7524395204539566`*^9, 
  3.7524395510813274`*^9}},ExpressionUUID->"3c2f73e1-9c63-4aff-9089-\
c9d67cd7a8be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hop", "=", 
   RowBox[{"{", 
    RowBox[{
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            SuperscriptBox["\[Sigma]", "+"], 
            RowBox[{"j", "\[Equal]", 
             RowBox[{"1", "+", "i"}]}]},
           {
            SuperscriptBox["\[Sigma]", "-"], 
            RowBox[{"j", "\[Equal]", "i"}]},
           {"Id", 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False], ",", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            SuperscriptBox["\[Sigma]", "-"], 
            RowBox[{"j", "\[Equal]", 
             RowBox[{"1", "+", "i"}]}]},
           {
            SuperscriptBox["\[Sigma]", "+"], 
            RowBox[{"j", "\[Equal]", "i"}]},
           {"Id", 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.752437572052167*^9, 3.7524376006746836`*^9}, {
   3.752438170326645*^9, 3.752438179283494*^9}, 3.752439538088792*^9, {
   3.752498372395605*^9, 3.752498381526099*^9}, {3.7524984229683237`*^9, 
   3.752498429243919*^9}, {3.784989981855721*^9, 3.784990005101543*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"53cbbadd-6dc4-4879-90ae-d1acb99ed212"],

Cell[TextData[{
 "as well as pair generating terms ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "i"], "+"], TraditionalForm]],ExpressionUUID->
  "ba490c13-c32e-49c6-907e-0fdf2f403682"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", 
     RowBox[{"i", "+", "1"}]], "+"], TraditionalForm]],ExpressionUUID->
  "151b3305-fd63-4ee4-9500-85b87e76c265"],
 " +",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "i"], "-"]}], TraditionalForm]],ExpressionUUID->
  "438ce693-73de-4918-9eaa-3024d2a9dcf7"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", 
     RowBox[{"i", "+", "1"}]], "-"], TraditionalForm]],ExpressionUUID->
  "9557b23e-26c8-4eac-a977-d750aed155eb"],
 ":"
}], "Text",
 CellChangeTimes->{{3.752437947013242*^9, 3.752437991862425*^9}, {
  3.752439528831132*^9, 3.7524395481490145`*^9}, {3.7524399275523767`*^9, 
  3.752439931380185*^9}},ExpressionUUID->"f575048a-2a90-4600-908f-\
db5af5bd0817"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pair", "=", 
   RowBox[{"{", 
    RowBox[{
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            SuperscriptBox["\[Sigma]", "+"], 
            RowBox[{"j", "\[Equal]", 
             RowBox[{"1", "+", "i"}]}]},
           {
            SuperscriptBox["\[Sigma]", "+"], 
            RowBox[{"j", "\[Equal]", "i"}]},
           {"Id", 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False], ",", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            SuperscriptBox["\[Sigma]", "-"], 
            RowBox[{"j", "\[Equal]", 
             RowBox[{"1", "+", "i"}]}]},
           {
            SuperscriptBox["\[Sigma]", "-"], 
            RowBox[{"j", "\[Equal]", "i"}]},
           {"Id", 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7524379700459785`*^9, 3.7524379785191145`*^9}, {
  3.752498431671307*^9, 3.752498444676502*^9}, {3.784990011956091*^9, 
  3.784990016921155*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"1a61cb6a-c37a-432a-bb46-b52592b3654f"],

Cell["\<\
Next we define a total spin-z operator, which for a chain of length n is \
given by:\
\>", "Text",
 CellChangeTimes->{{3.752438801133187*^9, 
  3.752438834696845*^9}},ExpressionUUID->"056778e9-930b-4b16-8ddf-\
ba74a0e40d53"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Szi", "=", 
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {
          SubscriptBox["\[Sigma]", "z"], 
          RowBox[{"j", "\[Equal]", "i"}]},
         {"Id", "True"}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}},
        Selectable->True]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SzT", "[", "n_", "]"}], ":=", 
   RowBox[{"Total", "[", 
    RowBox[{"Tensor", "@@@", 
     RowBox[{"Table", "[", 
      RowBox[{"Szi", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.752439083530562*^9, 3.7524392119186287`*^9}, {
   3.752496971679577*^9, 3.7524969733844624`*^9}, {3.752498446958371*^9, 
   3.752498448411022*^9}, {3.7525032168870363`*^9, 3.752503217144796*^9}, {
   3.778399082388772*^9, 3.778399099644568*^9}, 3.778402634806747*^9, 
   3.778402743899807*^9, {3.7784034972640743`*^9, 3.778403499090987*^9}, {
   3.7849900320945683`*^9, 3.7849900340649557`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"68911ace-f75a-4bc0-ad09-3c6eccc35af4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SzT", "[", "3", "]"}], "//", "Normal"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7790897456799307`*^9, 3.779089756766111*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"1bd9984c-0b91-4279-864d-20949533e689"],

Cell["\<\
When we have a chain of length n, the spin-z operator acting on site-i is \
given by the tensor product\
\>", "Text",
 CellChangeTimes->{{3.752439254869896*^9, 3.7524392946110096`*^9}, 
   3.752503223854349*^9},ExpressionUUID->"44679c90-e395-45ba-a468-\
0fd454aacb0c"],

Cell[CellGroupData[{

Cell[TextData[{
 "\t\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["\[ScriptCapitalI]", "^"], "1"], TraditionalForm]],
  ExpressionUUID->"044f9e5f-83f0-4232-a4f6-907dd48180d9"],
 " \[CircleTimes] ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["\[ScriptCapitalI]", "^"], "2"], TraditionalForm]],
  ExpressionUUID->"f6634021-d973-4a33-8edf-a3ef26fcf5a0"],
 " \[CircleTimes] \[CenterDot]\[CenterDot]\[CenterDot] \[CircleTimes] ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "i"], "z"], TraditionalForm]],ExpressionUUID->
  "aa6831cd-31b9-429b-a2de-587ce252220a"],
 " \[CircleTimes] \[CenterDot]\[CenterDot]\[CenterDot] ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CircleTimes]", " ", 
    SubscriptBox[
     OverscriptBox["\[ScriptCapitalI]", "^"], 
     RowBox[{"n", "-", "1"}]]}], TraditionalForm]],ExpressionUUID->
  "c5abf042-05db-4958-a365-b646153bf36e"],
 " \[CircleTimes] ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["\[ScriptCapitalI]", "^"], "n"], TraditionalForm]],
  ExpressionUUID->"ea19d378-9e29-47f2-bacd-0e694f818aa7"],
 "."
}], "Subsubsubsubsection",
 CellChangeTimes->{{3.7524393014810605`*^9, 3.7524394556412687`*^9}, 
   3.7524396039748507`*^9},ExpressionUUID->"63f11a1b-648c-4370-9550-\
a0e16e6c8e52"],

Cell[TextData[{
 "This product is achieved by building the array {",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["\[ScriptCapitalI]", "^"], "1"], TraditionalForm]],
  ExpressionUUID->"f0ffa09b-583c-4c51-9994-0d35b6aa3c69"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["\[ScriptCapitalI]", "^"], "2"], TraditionalForm]],
  ExpressionUUID->"3b0c4e9c-9e3a-49a9-8391-16b9a803ffe7"],
 ", ..., ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "i"], "z"], TraditionalForm]],ExpressionUUID->
  "ae76693d-74cc-42ea-a988-5d0aa539b284"],
 ", ..., ",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    SubscriptBox[
     OverscriptBox["\[ScriptCapitalI]", "^"], 
     RowBox[{"n", "-", "1"}]]}], TraditionalForm]],ExpressionUUID->
  "7208aaa1-d090-4f6a-87b9-4f03f35bf6e0"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["\[ScriptCapitalI]", "^"], "n"], TraditionalForm]],
  ExpressionUUID->"3078b087-6723-4a09-9ea6-11a255de6757"],
 "} and applying (@@) Tensor[] to it."
}], "Text",
 CellChangeTimes->{{3.75243960712004*^9, 
  3.7524397669198685`*^9}},ExpressionUUID->"eb911832-ba2a-4b4c-b22b-\
94127142e68a"],

Cell["\<\
\tThe transverse-field anisotropic XY model is described by the Hamiltonian\
\>", "Text",
 CellChangeTimes->{{3.752439772164864*^9, 
  3.7524398049839644`*^9}},ExpressionUUID->"f6803a27-b7a8-4ebd-a3af-\
9277e538fdc2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\t\t",
 Cell[BoxData[
  FormBox[
   OverscriptBox["H", "^"], TraditionalForm]],ExpressionUUID->
  "ac718b46-ef54-465d-b2f6-eaed46352fbe"],
 " = J ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sum]", "i"], TraditionalForm]],ExpressionUUID->
  "ec7f1cad-a69d-46da-8ffb-853ef2cad88d"],
 "(",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "i"], "+"], TraditionalForm]],ExpressionUUID->
  "bb4286b9-4921-498a-9bb6-9ce561a1c02b"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", 
     RowBox[{"i", "+", "1"}]], "-"], TraditionalForm]],ExpressionUUID->
  "ec2e697e-41b1-4f12-ab66-e7057f624bf7"],
 " + \[CapitalDelta]",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    RowBox[{
     FormBox[
      SuperscriptBox[
       SubscriptBox["\[Sigma]", "i"], "+"],
      TraditionalForm], 
     SuperscriptBox[
      SubscriptBox["\[Sigma]", 
       RowBox[{"i", "+", "1"}]], "+"]}]}], TraditionalForm]],ExpressionUUID->
  "0543a6eb-61a2-4be9-9628-10c942e80b81"],
 " + H.c.) + g ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["S", "z"], TraditionalForm]],ExpressionUUID->
  "e44134fd-45cc-49d0-82c2-ba312493562d"],
 "."
}], "Subsubsubsubsection",
 CellChangeTimes->{{3.752439812176816*^9, 3.752439841684824*^9}, {
   3.7524398743270173`*^9, 3.752439989940447*^9}, 
   3.796975152468102*^9},ExpressionUUID->"a17fe85e-e3c9-4c56-8412-\
bf1a011db1f8"],

Cell[TextData[{
 "In this equation, J is the magnetic coupling (J<0: ferromagnetic \
groundstate; J>0 antiferromagnetic groundstate), \[CapitalDelta] is a real \
number parameterising the degree of anisotropy, g is a magnetic field \
strength parameter and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["S", "z"], TraditionalForm]],ExpressionUUID->
  "108e34cd-8a4e-47b2-a6a9-7980036dba4c"],
 "= ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sum]", "i"], TraditionalForm]],ExpressionUUID->
  "40519d11-9f5a-495a-ab86-74fc2e23240b"],
 " ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "i"], "z"], TraditionalForm]],ExpressionUUID->
  "cce71d5d-b8c3-4eab-84a5-5cf039742782"],
 "."
}], "Text",
 CellChangeTimes->{{3.7524399980258083`*^9, 3.7524401489000893`*^9}, {
  3.752441073357723*^9, 3.7524410773394394`*^9}, {3.7721685164610357`*^9, 
  3.7721685166611767`*^9}, {3.7969751603969793`*^9, 
  3.796975163098435*^9}},ExpressionUUID->"ad2afcbc-dec5-41d0-abaa-\
085136228c43"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"toChain", "[", "n_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"Tensor", "@@@", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"n", "-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "&"}], "/@", 
          "#"}], ",", "1"}], "]"}]}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H0", "[", 
    RowBox[{"n_", ",", "g_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"toChain", "[", "n", "]"}], "[", "hop", "]"}], "+", 
    RowBox[{"g", " ", 
     RowBox[{"SzT", "[", "n", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", 
    RowBox[{"n_", ",", "\[CapitalDelta]_"}], "]"}], ":=", 
   RowBox[{"\[CapitalDelta]", " ", 
    RowBox[{
     RowBox[{"toChain", "[", "n", "]"}], "[", "pair", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HAnIsoXY", "[", 
    RowBox[{"n_", ",", "g_", ",", "\[CapitalDelta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"H0", "[", 
     RowBox[{"n", ",", "g"}], "]"}], "+", 
    RowBox[{"V", "[", 
     RowBox[{"n", ",", "\[CapitalDelta]"}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.752411719218313*^9, 3.752411724444327*^9}, {
   3.752411755723301*^9, 3.752411761459999*^9}, {3.752411953433939*^9, 
   3.7524120060815625`*^9}, {3.7524120465326543`*^9, 
   3.7524120531538277`*^9}, {3.7524121008875856`*^9, 
   3.7524121322797318`*^9}, {3.7524123156027417`*^9, 
   3.7524123164462433`*^9}, {3.752440347429764*^9, 3.7524403554061766`*^9}, {
   3.7524404912719307`*^9, 3.752440556491375*^9}, {3.7524406776875844`*^9, 
   3.752440685543048*^9}, {3.7524407715855103`*^9, 3.752440797682482*^9}, {
   3.752440851652404*^9, 3.75244085898518*^9}, {3.752441006751088*^9, 
   3.75244104324907*^9}, {3.752441178050444*^9, 3.752441202919123*^9}, {
   3.752441642615921*^9, 3.7524416432655525`*^9}, {3.7524429531547832`*^9, 
   3.7524429536624775`*^9}, {3.75249156622966*^9, 3.752491586601869*^9}, {
   3.752491971396854*^9, 3.752491971592125*^9}, {3.7524920219212112`*^9, 
   3.752492022065282*^9}, {3.752492122554846*^9, 3.7524921458614388`*^9}, {
   3.752492239036148*^9, 3.7524922903393307`*^9}, {3.752492322448409*^9, 
   3.752492415655781*^9}, {3.75249266784823*^9, 3.752492669073965*^9}, {
   3.752492743654325*^9, 3.7524927465881577`*^9}, 3.7524966266422977`*^9, {
   3.752496923543955*^9, 3.75249698917803*^9}, {3.752497036750103*^9, 
   3.752497048865493*^9}, {3.75249718075219*^9, 3.752497184178797*^9}, {
   3.752497243502934*^9, 3.752497245215816*^9}, {3.7524974077206*^9, 
   3.75249741176197*^9}, {3.752497573769466*^9, 3.7524976676978493`*^9}, 
   3.7524986955854177`*^9, {3.7524987568316717`*^9, 3.7524987669712553`*^9}, {
   3.75249917569236*^9, 3.75249918071402*^9}, {3.7524992301512947`*^9, 
   3.752499302079298*^9}, {3.752499504493944*^9, 3.752499521193376*^9}, {
   3.7525032333373423`*^9, 3.752503248965863*^9}, {3.752581150174621*^9, 
   3.7525811729439*^9}, {3.752589959185089*^9, 3.7525900179420977`*^9}, {
   3.7525901162691717`*^9, 3.752590127968554*^9}, 3.7784095469196653`*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"582d41b9-2e74-4abb-aba6-c770071fa34b"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"HAnIsoXY", "[", 
   RowBox[{"5", ",", "1", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7801421044130898`*^9, 3.780142204614249*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"e7f47351-afb9-411e-95f3-9249e6a57c85"],

Cell[TextData[{
 "The rather complicated function \[OpenCurlyQuote]toChain\[CloseCurlyQuote] \
does the following: it takes each of the piecewise definitions in hop and \
pair and then generates sets of operators which correspond to putting local \
spin operators on particular sites. What this means is that you generate a \
term of the form  {",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["\[ScriptCapitalI]", "^"], "1"], TraditionalForm]],
  ExpressionUUID->"768b214b-d45a-4216-8470-e29d67a4d1d9"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["\[ScriptCapitalI]", "^"], "2"], TraditionalForm]],
  ExpressionUUID->"0e47e558-4ddd-460c-9862-fd0e0cd628c1"],
 ", ..., ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "i"], "+"], ",", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", 
      RowBox[{"i", "+", "1"}]], "-"]}], TraditionalForm]],ExpressionUUID->
  "19f4b570-6e87-4ab4-912f-fa15adf7087f"],
 ", ..., ",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    SubscriptBox[
     OverscriptBox["\[ScriptCapitalI]", "^"], 
     RowBox[{"n", "-", "1"}]]}], TraditionalForm]],ExpressionUUID->
  "b4ae4552-4ae1-4847-a64c-7b94cc5d534a"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["\[ScriptCapitalI]", "^"], "n"], TraditionalForm]],
  ExpressionUUID->"9df521ad-dca6-4d7e-88fe-fe02d237cd6a"],
 "} for all i \[Element] [1, n-1] and then apply the tensor product to all of \
them. Then you total the result, which gives you the term ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sum]", "i"], TraditionalForm]],ExpressionUUID->
  "8287d40e-2eed-4905-8325-041453ca42cc"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "i"], "+"], 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", 
      RowBox[{"i", "+", "1"}]], "-"]}], TraditionalForm]],ExpressionUUID->
  "a8f68697-b1af-4645-9fa1-9cc209de5f81"],
 ". You then do this for all the terms in the Hamiltonian as above. \n\tNow, \
for the Hamiltonian above, if \[CapitalDelta] = 0, we have that [H, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["S", "z"], TraditionalForm]],ExpressionUUID->
  "23fdf41f-379e-4c2d-872d-71e4236cef51"],
 "] = 0. This means that all states of the Hamiltonian can be parameterised \
in terms of the number of up-spins in the state: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"|", 
    SubscriptBox["\[Epsilon]", 
     RowBox[{"r", ",", " ", 
      SubscriptBox["i", "r"]}]]}], TraditionalForm]],ExpressionUUID->
  "6e550af4-4f81-4677-a697-535a8cef70e4"],
 "\[RightAngleBracket]. Here, r is the number of up-spins (ranging from 0 to \
n) and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["i", "r"], TraditionalForm]],ExpressionUUID->
  "70e1bf22-e39a-4a5b-b822-6e8ed6c4661d"],
 " is a label designating which r-up-spin state we are referring to, and \
ranges from 0 to Binomial[N, r]. To transform to a basis ordered in terms of \
up-spins, we can simply transform into the basis of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["S", "z"], TraditionalForm]],ExpressionUUID->
  "1b7c9257-f065-4663-b13f-162c6462bea2"],
 ".  In the tensor product basis, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["S", "z"], TraditionalForm]],ExpressionUUID->
  "97b6bcdf-ec90-4803-a436-608596f8ea3a"],
 " is diagonal. Therefore, it\[CloseCurlyQuote]s eigenvalues are the values \
along the diagonal, and the eigenvectors are just the unit vectors in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckCapitalR]", 
    SuperscriptBox["2", "n"]], TraditionalForm]],ExpressionUUID->
  "f09f3638-f650-4d65-851a-04f6e00d96bd"],
 ". The eigenvectors in the spin-ordered basis |r, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["i", "r"], TraditionalForm]],ExpressionUUID->
  "b791885b-4e90-48fd-8e35-4b56869f17d9"],
 "\[RightAngleBracket] are therefore just a reordering of the unit vectors. \
We can stack these into a unitary U which allows us to switch between \
tensor-product basis and spin-ordered basis. "
}], "Text",
 CellChangeTimes->{{3.752500746533147*^9, 3.7525008325678587`*^9}, {
   3.7525010541947002`*^9, 3.7525012353164473`*^9}, {3.752501601552917*^9, 
   3.752501714757866*^9}, {3.752501762970211*^9, 3.7525019459911346`*^9}, {
   3.752502048441473*^9, 3.752502063786214*^9}, 3.752502360208424*^9, {
   3.7526545596125317`*^9, 3.752654586946498*^9}, {3.752654735649476*^9, 
   3.752654816348083*^9}, {3.75265489777006*^9, 
   3.752654987847465*^9}},ExpressionUUID->"465edc96-a196-41e2-856e-\
8951a6f54c8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TotalSpinBasis", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SuperscriptBox["2", "n"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         SuperscriptBox["2", "n"]}], "}"}]}], "]"}], "\[LeftDoubleBracket]", 
     RowBox[{"Ordering", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SzT", "[", "n", "]"}], "//", "Normal"}], "//", "Diagonal"}], 
      "]"}], "\[RightDoubleBracket]"}], "//", "SparseArray"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.752589189097035*^9, 3.752589287949287*^9}, {
   3.752589343839655*^9, 3.752589384145146*^9}, 3.7525894929883738`*^9, {
   3.75258961254151*^9, 3.752589629580391*^9}, {3.7525897058911858`*^9, 
   3.752589759520351*^9}, {3.752590140554941*^9, 3.7525901472594137`*^9}, {
   3.752590316374889*^9, 3.752590317453927*^9}, {3.752654082126316*^9, 
   3.7526541164306602`*^9}, {3.7526541498052797`*^9, 3.752654163035904*^9}, 
   3.752654488874731*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"8511841e-3bf6-40b8-a87a-282c1c33030c"],

Cell[TextData[{
 "We can then take this basis and transform the Hamiltonian into the \
spin-ordered basis. Then, one can extract the r-spin sectors by selecting the \
correct range within the full matrix. Since the blocks are dimension ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"n"},
      {"r"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "79d36a93-8b7c-4f73-b828-ee4d413afe34"],
 " \[Times]  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"n"},
      {"r"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "c925c139-073c-4475-8db6-3fd7436dc4c3"],
 ", the position of the top left element of sub-block r is { f[n, r], f[n, r] \
}, where f[n, r] is given by"
}], "Text",
 CellChangeTimes->{{3.752655017263075*^9, 3.7526550483733788`*^9}, {
  3.75265509366054*^9, 3.7526551287450657`*^9}, {3.75274344925309*^9, 
  3.752743580191142*^9}, {3.7527436544574633`*^9, 
  3.752743662137443*^9}},ExpressionUUID->"a59316a3-3c5b-459f-94dd-\
a7bd0570435f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"m_", ",", "0"}], "]"}], ":=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"m_", ",", "r_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"m", ",", 
      RowBox[{"r", "-", "1"}]}], "]"}], "+", 
    RowBox[{"Binomial", "[", 
     RowBox[{"m", ",", 
      RowBox[{"r", "-", "1"}]}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7527430081675577`*^9, 3.752743059754788*^9}, {
  3.752743112677125*^9, 3.7527431135462513`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"7c0bbc33-8ebb-41c9-95ef-fbb0020185b4"],

Cell[TextData[{
 "This amounts to just summing the dimensions of all previous sub-matrices as \
we traverse the full ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", "n"], "\[Times]", 
    SuperscriptBox["2", "n"]}], TraditionalForm]],ExpressionUUID->
  "7de2c54a-cb93-4f8b-ae9e-8070b01626f4"],
 " matrix. This allows one to break up the full Hamiltonian, say, and find \
the eigenvectors of each of the sub blocks separately, which is cumulatively \
much more efficient than solving for the eigensystem of the full system."
}], "Text",
 CellChangeTimes->{{3.752743599120242*^9, 3.752743646101934*^9}, {
  3.752765858553822*^9, 
  3.7527659348308268`*^9}},ExpressionUUID->"65b2de77-3a9d-4881-b599-\
00696bc5ec22"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"H0Blocks", "[", 
    RowBox[{"n_", ",", "g_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"U", "=", 
        RowBox[{"TotalSpinBasis", "[", "n", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"H0full", "=", 
        RowBox[{"H0", "[", 
         RowBox[{"n", ",", "g"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H0full", "=", 
       RowBox[{"U", ".", "H0full", ".", 
        RowBox[{"U", "\[Transpose]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"H0full", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"n", ",", "m"}], "]"}], ";;", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"n", ",", 
               RowBox[{"m", "+", "1"}]}], "]"}], "-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"n", ",", "m"}], "]"}], ";;", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"n", ",", 
               RowBox[{"m", "+", "1"}]}], "]"}], "-", "1"}]}]}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.752652020490638*^9, 3.7526521281468277`*^9}, {
  3.752652829653125*^9, 3.7526528721833477`*^9}, {3.752652964896491*^9, 
  3.7526529659307756`*^9}, {3.752653014262164*^9, 3.752653046963352*^9}, {
  3.752653663691526*^9, 3.752653695025568*^9}, {3.752653898609908*^9, 
  3.752653938676289*^9}, {3.752654224704953*^9, 3.7526542505647163`*^9}, {
  3.752654285094431*^9, 3.7526543325400867`*^9}, {3.7526545420517187`*^9, 
  3.7526545517862*^9}, {3.7527437249457483`*^9, 3.7527437536105337`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"9bb5849d-5140-491a-846f-663e85aee910"],

Cell[TextData[{
 "We can perform a similar operation for the pairing terms, but now with an \
offset of \[PlusMinus]2. (In fact, here we only extract the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Sigma]", "-"], TraditionalForm]],ExpressionUUID->
  "1d97eca5-f81f-4d4c-a3dc-509fa295fb86"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Sigma]", "-"], TraditionalForm]],ExpressionUUID->
  "b3ddbf41-b401-4172-9995-cc289c322e74"],
 " terms. The ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Sigma]", "+"], TraditionalForm]],ExpressionUUID->
  "2ca3ddf4-aab3-46ee-ac72-fe106724b85d"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Sigma]", "+"], TraditionalForm]],ExpressionUUID->
  "cc627a02-03d7-4a1b-80d9-f81348bb00af"],
 " terms are simply found by applying #\[Transpose] & /@ to the result of \
MinusMinusBlock.)"
}], "Text",
 CellChangeTimes->{{3.752765939313644*^9, 
  3.752766134994383*^9}},ExpressionUUID->"dfe298a6-5f55-406f-b923-\
0b66001e5bef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MinusBlocks", "[", 
   RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"U", "=", 
       RowBox[{"TotalSpinBasis", "[", "n", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]mT", "=", 
       RowBox[{"Tensor", "@@", 
        RowBox[{"Table", "[", 
         RowBox[{
          TagBox[GridBox[{
             {"\[Piecewise]", GridBox[{
                {"Sigmam", 
                 RowBox[{"i", "\[Equal]", "j"}]},
                {"Id", "True"}
               },
               AllowedDimensions->{2, Automatic},
               Editable->True,
               
               GridBoxAlignment->{
                "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{1.}}, "RowsIndexed" -> {}},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}},
               Selectable->True]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{1.}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.35]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           "Piecewise",
           DeleteWithContents->True,
           Editable->False,
           SelectWithContents->True,
           Selectable->False], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Sigma]mT", "=", 
      RowBox[{"U", ".", "\[Sigma]mT", ".", 
       RowBox[{"U", "\[Transpose]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[Sigma]mT", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"n", ",", "m"}], "]"}], ";;", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"n", ",", 
              RowBox[{"m", "+", "1"}]}], "]"}], "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"n", ",", 
             RowBox[{"m", "+", "1"}]}], "]"}], ";;", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"n", ",", 
              RowBox[{"m", "+", "2"}]}], "]"}], "-", "1"}]}]}], 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "0", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.753346299351735*^9, 3.7533464654670134`*^9}, {
  3.753346514679819*^9, 3.753346533868761*^9}, {3.753346594670725*^9, 
  3.753346618048254*^9}, {3.7533467328810835`*^9, 3.753346760598112*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"175a8bd5-481a-482c-8461-5e259d45648a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MinusMinusBlocks", "[", 
    RowBox[{"n_", ",", "\[CapitalDelta]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"U", "=", 
        RowBox[{"TotalSpinBasis", "[", "n", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Vfull", "=", 
        RowBox[{"V", "[", 
         RowBox[{"n", ",", "\[CapitalDelta]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Vfull", "=", 
       RowBox[{"U", ".", "Vfull", ".", 
        RowBox[{"U", "\[Transpose]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Vfull", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"n", ",", "m"}], "]"}], ";;", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"n", ",", 
               RowBox[{"m", "+", "1"}]}], "]"}], "-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"n", ",", 
              RowBox[{"m", "+", "2"}]}], "]"}], ";;", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"n", ",", 
               RowBox[{"m", "+", "3"}]}], "]"}], "-", "1"}]}]}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "0", ",", 
           RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7526565761821003`*^9, 3.7526565966724463`*^9}, {
   3.7526568799549007`*^9, 3.752656918522143*^9}, {3.752657250527074*^9, 
   3.752657250793973*^9}, {3.7526601862103786`*^9, 3.752660228899735*^9}, 
   3.7526731437066193`*^9, {3.752673177152935*^9, 3.752673219348013*^9}, {
   3.752742003936983*^9, 3.75274200415265*^9}, {3.7527420865786552`*^9, 
   3.752742114029606*^9}, {3.75274223367238*^9, 3.752742248538776*^9}, {
   3.752742279138956*^9, 3.752742322324191*^9}, {3.752743308671958*^9, 
   3.752743327571323*^9}, {3.75334677804006*^9, 3.753346799531677*^9}, {
   3.7533468451853695`*^9, 3.753346849168084*^9}, {3.753346888385476*^9, 
   3.7533468959231324`*^9}, 3.753346967394947*^9, {3.772180246396658*^9, 
   3.772180261595331*^9}, {3.772180404347365*^9, 3.7721804462232103`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"947884b6-16d8-42e0-868e-28f5c9c37c45"],

Cell[TextData[{
 "Finally, it would be useful to be able to convert from a list of blocks to \
a full ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", "n"], "\[Times]", 
    SuperscriptBox["2", "n"]}], TraditionalForm]],ExpressionUUID->
  "a82acfaa-5786-409c-a00e-1aec8244d5dd"],
 " matrix. This is achieved by the following code. The variable mm is the \
offset from the main diagonal (mm = 0 for H0Blocks and mm = 2 for \
MinusMinusBlocks)."
}], "Text",
 CellChangeTimes->{{3.752766462721858*^9, 
  3.752766584028701*^9}},ExpressionUUID->"df7b57d4-7563-4a6d-a14e-\
e08464005fd4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Blockto2N", "[", 
   RowBox[{"blockList_", ",", "mm_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"Length", "[", "blockList", "]"}], "-", "1", "+", 
        RowBox[{"Abs", "[", "mm", "]"}]}]}], ",", "\[IndentingNewLine]", 
      "out"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"out", "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["2", "n"], ",", 
          SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mm", "\[GreaterEqual]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"out", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"n", ",", 
               RowBox[{"i", "+", "mm"}]}], "]"}], ";;", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"n", ",", 
                RowBox[{"i", "+", "mm", "+", "1"}]}], "]"}], "-", "1"}]}], 
            ",", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"n", ",", "i"}], "]"}], ";;", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"n", ",", 
                RowBox[{"i", "+", "1"}]}], "]"}], "-", "1"}]}]}], 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{"blockList", "\[LeftDoubleBracket]", 
           RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"out", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"n", ",", "i"}], "]"}], ";;", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"n", ",", 
                RowBox[{"i", "+", "1"}]}], "]"}], "-", "1"}]}], ",", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"n", ",", 
               RowBox[{"i", "-", "mm"}]}], "]"}], ";;", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"n", ",", 
                RowBox[{"i", "-", "mm", "+", "1"}]}], "]"}], "-", "1"}]}]}], 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{"blockList", "\[LeftDoubleBracket]", 
           RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{
          RowBox[{"Length", "[", "blockList", "]"}], "-", "1"}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "out"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.752757307106048*^9, 3.7527573312347*^9}, {
   3.752759441989574*^9, 3.752759455371566*^9}, {3.7527597057260723`*^9, 
   3.75275972351622*^9}, {3.7527600283549128`*^9, 3.752760047328231*^9}, {
   3.7527601012684307`*^9, 3.752760109143465*^9}, {3.7527601554041433`*^9, 
   3.75276017606314*^9}, {3.7527602089713783`*^9, 3.752760211416321*^9}, {
   3.752760246967383*^9, 3.75276047461154*^9}, {3.7527605489685497`*^9, 
   3.7527605729235497`*^9}, {3.752760708121696*^9, 3.7527607808732033`*^9}, {
   3.7527608118933353`*^9, 3.752760814788417*^9}, {3.7527626333526917`*^9, 
   3.752762639415002*^9}, 3.753347161201269*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"27fea042-22aa-4c43-a242-0ac013a7f749"],

Cell["\<\
Now that we have the definition of the physical system we want to study, it \
is required that we define the relevant operations to deal with the dynamics \
and steady-states of open quantum systems defined by master equations.\
\>", "Text",
 CellChangeTimes->{{3.75276661470424*^9, 
  3.752766752602293*^9}},ExpressionUUID->"45a58041-7735-486a-984e-\
caae16a3d890"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OnesBlock", "[", 
    RowBox[{"n_", ",", "r_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Binomial", "[", 
        RowBox[{"n", ",", "r"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Binomial", "[", 
        RowBox[{"n", ",", "r"}], "]"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7824713901878777`*^9, 3.782471443426015*^9}, {
  3.7824869765079308`*^9, 3.782486980023954*^9}, {3.782487056823907*^9, 
  3.782487131881428*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"1b345f93-2c1d-45fb-9fe2-f000bd233076"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OnesFull", "[", "n_", "]"}], ":=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Band", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"n", ",", "r"}], "]"}], ",", 
          RowBox[{"f", "[", 
           RowBox[{"n", ",", "r"}], "]"}]}], "}"}], "]"}], "\[Rule]", 
       RowBox[{"OnesBlock", "[", 
        RowBox[{"n", ",", "r"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "0", ",", "n"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7824713723992662`*^9, 3.7824713747292213`*^9}, {
  3.782471447046687*^9, 3.7824715195919313`*^9}, {3.7824745698455877`*^9, 
  3.782474570077676*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"fdb3adec-20fa-481b-a16c-e6204f3cae66"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OnesFullk", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[GreaterEqual]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Band", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"n", ",", "r"}], "]"}], ",", 
              RowBox[{"f", "[", 
               RowBox[{"n", ",", 
                RowBox[{"r", "+", "k"}]}], "]"}]}], "}"}], "]"}], "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Binomial", "[", 
                RowBox[{"n", ",", "r"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Binomial", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"r", "+", "k"}]}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Band", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"n", ",", 
                RowBox[{"r", "+", 
                 RowBox[{"Abs", "[", "k", "]"}]}]}], "]"}], ",", 
              RowBox[{"f", "[", 
               RowBox[{"n", ",", "r"}], "]"}]}], "}"}], "]"}], "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Binomial", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"r", "+", 
                  RowBox[{"Abs", "[", "k", "]"}]}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Binomial", "[", 
                RowBox[{"n", ",", "r"}], "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", 
          RowBox[{"n", "-", 
           RowBox[{"Abs", "[", "k", "]"}]}]}], "}"}]}], "\[IndentingNewLine]",
        "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["2", "n"], ",", 
        SuperscriptBox["2", "n"]}], "}"}]}], "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{
     RowBox[{"-", "n"}], "\[LessEqual]", "k", "\[LessEqual]", "n"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.78249159032607*^9, 3.782491597748455*^9}, {
  3.782493981182987*^9, 3.782493995824133*^9}, {3.782494026657896*^9, 
  3.782494087654543*^9}, {3.782494175723814*^9, 3.782494193710829*^9}, {
  3.782494428688367*^9, 3.782494526539693*^9}, {3.7824945589545393`*^9, 
  3.78249456441442*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"2a21a298-50e4-4e60-8154-0d17ee2b5c1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SuperBasisPositions", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"SuperBasisPositions", "[", 
       RowBox[{"n", ",", "k"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"OnesFullk", "[", 
            RowBox[{"n", ",", "k"}], "]"}], "//", "Vectorise"}], "//", 
          "Normal"}], ",", "1"}], "]"}], "//", "Flatten"}]}], ")"}], "/;", 
    RowBox[{
     RowBox[{"-", "n"}], "\[LessEqual]", "k", "\[LessEqual]", "n"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7824946994090843`*^9, 3.782494714332871*^9}, {
  3.7824947743797617`*^9, 3.782494817289118*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"7b14e44e-504d-4ee5-a988-046fcecb9f86"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"SuperBasisPositions", "[", 
     RowBox[{"3", ",", "k"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", 
      RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "]"}], "//", 
  "Flatten"}]], "Input",
 CellChangeTimes->{{3.782494821669237*^9, 3.782494883123993*^9}, {
   3.782496044067965*^9, 3.782496063384693*^9}, 3.782496175115307*^9},
 CellLabel->
  "In[212]:=",ExpressionUUID->"47ccf236-4d1f-4bf9-a618-240f681d842e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SuperBlocksGet", "[", 
    RowBox[{"\[ScriptCapitalL]_", ",", "n_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"\[ScriptCapitalL]", "\[LeftDoubleBracket]", 
        RowBox[{"SuperBasisPositions", "[", 
         RowBox[{"n", ",", "k"}], "]"}], "\[RightDoubleBracket]"}], 
       "\[Transpose]"}], "\[LeftDoubleBracket]", 
      RowBox[{"SuperBasisPositions", "[", 
       RowBox[{"n", ",", "k"}], "]"}], "\[RightDoubleBracket]"}], ")"}], 
    "\[Transpose]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7824963029496193`*^9, 3.782496333387919*^9}, {
  3.782496386981997*^9, 3.782496405867076*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"2420181a-dc11-4933-8e7b-fc8c83c2ba77"],

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{"n", "=", "8"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"H", "=", 
    RowBox[{"Blockto2N", "[", 
     RowBox[{
      RowBox[{"H0Blocks", "[", 
       RowBox[{"n", ",", "10."}], "]"}], ",", "0"}], "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"U", "=", 
    RowBox[{"TotalSpinBasis", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Construct", " ", "Lindbladian", " ", "in", " ", "the", " ", "total"}], 
     "-", 
     RowBox[{"spin", " ", "basis"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"\[ScriptCapitalL]", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"SuperComm", "[", "H", "]"}]}], "+", 
     RowBox[{"Total", "[", 
      RowBox[{"Lindblad", "/@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"U", ".", "#", ".", 
            RowBox[{"U", "\[Transpose]"}]}], "&"}], "@", 
          RowBox[{"(", 
           RowBox[{"Tensor", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              TagBox[GridBox[{
                 {"\[Piecewise]", GridBox[{
                    {"Sigmam", 
                    RowBox[{"j", "\[Equal]", "i"}]},
                    {"Id", "True"}
                   },
                   AllowedDimensions->{2, Automatic},
                   Editable->True,
                   
                   GridBoxAlignment->{
                    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                   
                   GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {{1.}}, "RowsIndexed" -> {}},
                   GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}},
                   Selectable->True]}
                },
                
                GridBoxAlignment->{
                 "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {{1.}}, "RowsIndexed" -> {}},
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.35]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               "Piecewise",
               DeleteWithContents->True,
               Editable->False,
               SelectWithContents->True,
               Selectable->False,
               StripWrapperBoxes->True], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"kisZeroPositions", "=", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"OnesFull", "[", "n", "]"}], "//", "Vectorise"}], "//", 
        "Normal"}], ",", "1"}], "]"}], "//", "Flatten"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"reduced\[ScriptCapitalL]", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
        "\[ScriptCapitalL]", "\[LeftDoubleBracket]", "kisZeroPositions", 
         "\[RightDoubleBracket]"}], "\[Transpose]"}], "\[LeftDoubleBracket]", 
       "kisZeroPositions", "\[RightDoubleBracket]"}], ")"}], 
     "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"\[ScriptCapitalL]SuperBlocks", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SuperBlocksGet", "[", 
       RowBox[{"\[ScriptCapitalL]", ",", "n", ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "n"}], ",", "n", ",", "1"}], "]"}], ",", "Abs"}], 
         "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[ScriptCapitalL]InverseBlocks", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"PseudoInverse", "[", 
        RowBox[{
        "\[ScriptCapitalL]SuperBlocks", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], "]"}], ",", 
       RowBox[{"Inverse", "/@", 
        RowBox[{"\[ScriptCapitalL]SuperBlocks", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}]}], "]"}]}], ";"}], 
   "*)"}], ")"}]], "Input",
 CellChangeTimes->{{3.7824717648831463`*^9, 3.7824718080118217`*^9}, {
   3.78247184057882*^9, 3.782471898328861*^9}, {3.782471942759061*^9, 
   3.782472071796206*^9}, {3.782472174980914*^9, 3.782472176285557*^9}, {
   3.7824726267300797`*^9, 3.7824726863988523`*^9}, {3.782472953225382*^9, 
   3.782472980924843*^9}, 3.782473060431643*^9, {3.782473093189776*^9, 
   3.782473093555024*^9}, {3.7824731686979637`*^9, 3.782473198885689*^9}, 
   3.782473242611166*^9, 3.7824733427503138`*^9, 3.782487398938416*^9, {
   3.782487861896779*^9, 3.782487862112093*^9}, {3.782487995340023*^9, 
   3.7824880387305737`*^9}, 3.782488597786563*^9, 3.782488734434045*^9, {
   3.782489667710874*^9, 3.782489688041189*^9}, 3.78248973815096*^9, 
   3.782489803320343*^9, 3.782489895950406*^9, 3.782490068250107*^9, {
   3.7824908437508574`*^9, 3.782490843971306*^9}, 3.782491086673524*^9, {
   3.7824911386077833`*^9, 3.782491138695677*^9}, {3.782496428680574*^9, 
   3.7824964357340307`*^9}, {3.782629865641674*^9, 3.782629954076428*^9}, {
   3.782630006184556*^9, 3.7826301358756742`*^9}, {3.782630184454043*^9, 
   3.782630193569326*^9}, {3.782633325919765*^9, 3.7826333349148197`*^9}, {
   3.782633394168046*^9, 3.782633457955368*^9}, {3.782633509077404*^9, 
   3.78263351381327*^9}, {3.782633611480969*^9, 3.782633623031513*^9}, {
   3.782633656994773*^9, 3.782633672441277*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"449274c7-2e03-42d8-aff9-832e79fcc7f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "\[ScriptCapitalL]SuperBlocks", "\[LeftDoubleBracket]", "7", 
    "\[RightDoubleBracket]"}], "//", "PseudoInverse"}], ";"}]], "Input",
 CellChangeTimes->{{3.7826354250759068`*^9, 3.7826354462782717`*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"d9416076-9868-4c7d-8218-ff0fb97159ff"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ground state properties of the XY model", "Subsection",
 CellChangeTimes->{{3.7969740575075417`*^9, 
  3.796974068006584*^9}},ExpressionUUID->"d18599da-45bb-4350-8716-\
9521ebda7ff6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ToPure", "[", "psi_", "]"}], ":=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", "psi", ",", "psi"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GroundState", "[", "H_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Eigenvectors", "[", "H", "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Site", "[", 
    RowBox[{"oper_", ",", "j_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Tensor", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "j"}], ",", "oper", ",", "Id"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7969742688895273`*^9, 3.796974316149149*^9}, {
  3.796974413681986*^9, 3.796974463654598*^9}, {3.796974936014126*^9, 
  3.7969749560209427`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"e6c00a1c-e139-48bc-98aa-95626455800c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extracting information from density matrices", "Subsection",
 CellChangeTimes->{{3.7527636451832314`*^9, 
  3.752763691518364*^9}},ExpressionUUID->"b061796f-15ac-4471-8fca-\
2ae9e0cd43c2"],

Cell[CellGroupData[{

Cell["Expectation values", "Subsubsection",
 CellChangeTimes->{{3.752764980916397*^9, 
  3.7527649839610653`*^9}},ExpressionUUID->"af6abe0d-b71d-48f4-84e6-\
efd0900ea99e"],

Cell[TextData[{
 "A density matrix \[Rho] encodes a state of a complex system entangled in \
non-trivial ways. The expectation value of some arbitrary operator ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["X", "^"], TraditionalForm]],ExpressionUUID->
  "e16dbb6e-30f4-4f22-89a9-d16e612e085e"],
 " is given by "
}], "Text",
 CellChangeTimes->{{3.7527636943383512`*^9, 3.752763732274363*^9}, {
  3.752763770840353*^9, 
  3.752763800466241*^9}},ExpressionUUID->"9bf8a601-a55f-406f-8d5c-\
46e9b697f44d"],

Cell[CellGroupData[{

Cell[TextData[{
 "\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[LeftAngleBracket]", 
    OverscriptBox["X", "^"]}], TraditionalForm]],ExpressionUUID->
  "9d54ea67-ea06-4e06-924c-8c70022308d9"],
 "\[RightAngleBracket] = Tr {",
 Cell[BoxData[
  FormBox[
   OverscriptBox["X", "^"], TraditionalForm]],ExpressionUUID->
  "b46ed39b-a799-442e-b673-07f3bbc5a3ce"],
 "\[Rho]}."
}], "Subsubsubsubsection",
 CellChangeTimes->{{3.75276380699271*^9, 
  3.752763855367302*^9}},ExpressionUUID->"854c3152-42de-4deb-a69a-\
2c96a661db7c"],

Cell["Therefore, it is easy to calculate using Mathematica with", "Text",
 CellChangeTimes->{{3.752763862792447*^9, 
  3.752763881333049*^9}},ExpressionUUID->"ea961ad9-2661-4b73-ab0e-\
d8aabf9f50dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Expect", "[", 
    RowBox[{"oper_", ",", "\[Rho]_"}], "]"}], ":=", 
   RowBox[{"Tr", "[", 
    RowBox[{"oper", ".", "\[Rho]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.75276388828623*^9, 3.7527639165987177`*^9}, {
  3.752764233705852*^9, 3.752764269421919*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"debc9315-6715-4d9d-a4df-d9a059894932"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Steady-states of Liovillian \[ScriptCapitalL]", "Subsubsection",
 CellChangeTimes->{{3.752764993876347*^9, 3.752765001016403*^9}, {
  3.752765143880087*^9, 
  3.75276515412418*^9}},ExpressionUUID->"78f3e632-6df5-4410-a409-\
869263b1d5eb"],

Cell["\<\
A \[OpenCurlyQuote]master equation\[CloseCurlyQuote] is a dynamical equation \
of motion for the elements of a density matrix \[Rho]. A generic density \
matrix has the form \
\>", "Text",
 CellChangeTimes->{{3.752765161405652*^9, 
  3.752765195240388*^9}},ExpressionUUID->"5d97b636-d503-4b51-afcd-\
20aa5a3bd37a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Lindblad", "[", "oper_", "]"}], ":=", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"SuperLR", "[", 
      RowBox[{"oper", ",", 
       RowBox[{"oper", "\[HermitianConjugate]"}]}], "]"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"SuperLR", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"oper", "\[HermitianConjugate]"}], ".", "oper"}], ",", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"oper", "//", "Dimensions"}], "]"}]}], "]"}], "+", 
      RowBox[{"SuperLR", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"oper", "//", "Dimensions"}], "]"}], ",", 
        RowBox[{
         RowBox[{"oper", "\[HermitianConjugate]"}], ".", "oper"}]}], "]"}]}], 
     ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.752764556186252*^9, 3.752764739020739*^9}, {
  3.753198887786976*^9, 3.753198889412189*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"0b3c1959-e670-4ec3-9836-4c6aa43f1046"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SteadyState", "[", 
    RowBox[{"H_", ",", "collapse_"}], "]"}], ":=", 
   RowBox[{"NullSpace", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"SuperComm", "[", "H", "]"}]}], "+", 
     RowBox[{"Total", "[", 
      RowBox[{"Lindblad", "/@", "collapse"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.752766919571018*^9, 3.752766930850718*^9}, {
  3.752766967316287*^9, 3.752767071389059*^9}, {3.752767103251075*^9, 
  3.752767182895472*^9}, {3.752767254499299*^9, 3.752767292163835*^9}, {
  3.752767554100926*^9, 3.752767579376176*^9}, {3.75276792520923*^9, 
  3.7527679399377413`*^9}, {3.753104922479765*^9, 3.753104945951116*^9}, {
  3.753105015787386*^9, 3.753105022995653*^9}, {3.753105428454288*^9, 
  3.753105526844184*^9}, {3.7531055748970013`*^9, 3.75310560339909*^9}, {
  3.7531056352011213`*^9, 3.7531057891946*^9}, {3.753105977040925*^9, 
  3.753105982940473*^9}, {3.753106267084923*^9, 3.753106306750175*^9}, {
  3.753106357616873*^9, 3.753106369139181*^9}, {3.75318328522285*^9, 
  3.753183293112595*^9}, {3.753183548244425*^9, 3.753183607834367*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"4caa0fba-7761-42da-9aa5-b9e0dcc410aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"HAnIsoXY", "[", 
    RowBox[{"nn", ",", "10.", ",", "0.1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"\[ScriptCapitalL]sparse", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"SuperComm", "[", "H", "]"}]}], "+", 
     RowBox[{"0.01", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"Lindblad", "/@", 
        RowBox[{"{", 
         RowBox[{"Tensor", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            TagBox[GridBox[{
               {"\[Piecewise]", GridBox[{
                  {"Sigmam", 
                   RowBox[{"i", "\[Equal]", "1"}]},
                  {"Id", "True"}
                 },
                 AllowedDimensions->{2, Automatic},
                 Editable->True,
                 
                 GridBoxAlignment->{
                  "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{1.}}, "RowsIndexed" -> {}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}},
                 Selectable->True]}
              },
              
              GridBoxAlignment->{
               "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{1.}}, "RowsIndexed" -> {}},
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.35]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.4]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             "Piecewise",
             DeleteWithContents->True,
             Editable->False,
             SelectWithContents->True,
             Selectable->False], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nn"}], "}"}]}], "]"}]}], "}"}]}], "]"}]}]}]}],
    ")"}], ";"}]}], "Input",
 CellChangeTimes->{{3.753184273770667*^9, 3.753184381712083*^9}, {
   3.753184655261259*^9, 3.753184676466457*^9}, {3.7688195027056313`*^9, 
   3.768819502880796*^9}, {3.7688197928183327`*^9, 3.76881980112372*^9}, {
   3.768820006932405*^9, 3.768820007233637*^9}, {3.7688201621666117`*^9, 
   3.768820190361451*^9}, {3.768820932878724*^9, 3.768820933027316*^9}, 
   3.7688212171879168`*^9, {3.7688214982957373`*^9, 3.768821510819147*^9}, {
   3.768822216997333*^9, 3.768822217236925*^9}, {3.768822363071262*^9, 
   3.768822378196878*^9}, {3.76882262487042*^9, 3.768822627855052*^9}, {
   3.7688226742956457`*^9, 3.7688226856285057`*^9}, 3.768822756614745*^9, {
   3.7688228533351183`*^9, 3.768822853405118*^9}, 3.768823163007099*^9, {
   3.7769385605409*^9, 3.776938587197609*^9}, {3.776938649184401*^9, 
   3.776938728313342*^9}, {3.77693894482215*^9, 3.776938966719833*^9}, {
   3.7769394173105164`*^9, 3.776939419921385*^9}, {3.778411840356824*^9, 
   3.778411851424328*^9}, 3.7784855675464153`*^9, {3.780579123926071*^9, 
   3.780579158758766*^9}, {3.780579195091017*^9, 3.780579201982821*^9}, {
   3.780579350525757*^9, 3.7805793579762993`*^9}, 3.780579391955072*^9, {
   3.780918102272296*^9, 3.7809181175216703`*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"974c49ec-57d0-48b0-a376-c219d2e9f988"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SIGMAM", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"Sigmam", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorProduct", "@@", "SIGMAM"}], "//", "ByteCount"}]}], "Input",
 CellChangeTimes->{{3.784655037866543*^9, 3.784655161129115*^9}, {
  3.78465580788234*^9, 3.784655844883189*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"b9a3ca9a-4044-4650-b533-c8b65e3b2de0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Master equations", "Subsection",
 CellChangeTimes->{{3.7531848883984127`*^9, 
  3.753184896051874*^9}},ExpressionUUID->"a06ccba4-fb4a-444e-899c-\
3de90decc58f"],

Cell["\<\
In this section we define some forms of master equation we want to solve. The \
main type of master equation is the Bloch-Redfield master equation of the form\
\>", "Text",
 CellChangeTimes->{{3.7531848985873137`*^9, 3.753184942012821*^9}, {
  3.753185327035448*^9, 
  3.753185329115307*^9}},ExpressionUUID->"31fd13b1-2941-4a22-9e4d-\
b802d3cd42c2"],

Cell[CellGroupData[{

Cell[TextData[{
 "\t\t",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[Rho]", "."], TraditionalForm]],ExpressionUUID->
  "fd710c3d-c1e0-4229-9e65-63c8dfdb9a41"],
 " = -\[ImaginaryI] [H, \[Rho]] + ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", "i"], 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"\[Omega]", ",", 
       RowBox[{"\[Omega]", "'"}]}]], 
     RowBox[{
      RowBox[{"J", "(", 
       RowBox[{"\[Omega]", "'"}], ")"}], "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         SubscriptBox["A", 
          RowBox[{"\[Omega]", "'"}]], "i"], "\[Rho]", " ", 
        SuperscriptBox[
         SuperscriptBox[
          SubscriptBox["A", "\[Omega]"], "i"], "\[Dagger]"]}], "-", 
       RowBox[{
        SuperscriptBox[
         SuperscriptBox[
          SubscriptBox["A", "\[Omega]"], "i"], "\[Dagger]"], 
        SuperscriptBox[
         SubscriptBox["A", 
          RowBox[{"\[Omega]", "'"}]], "i"], "\[Rho]"}], "  ", "+", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["A", "\[Omega]"], "i"], "\[Rho]", " ", 
        SuperscriptBox[
         SuperscriptBox[
          SubscriptBox["A", 
           RowBox[{"\[Omega]", "'"}]], "i"], "\[Dagger]"]}], "-", " ", 
       RowBox[{"\[Rho]", " ", 
        SuperscriptBox[
         SuperscriptBox[
          SubscriptBox["A", 
           RowBox[{"\[Omega]", "'"}]], "i"], "\[Dagger]"], 
        SuperscriptBox[
         SubscriptBox["A", "\[Omega]"], "i"]}]}], " ", "]"}]}]}], 
   TraditionalForm]],ExpressionUUID->"9c01eb91-98ac-4525-ae9f-a25913269b69"],
 "."
}], "Subsubsubsubsection",
 CellChangeTimes->{{3.75318494998188*^9, 3.7531850701666727`*^9}, {
   3.7531851131677017`*^9, 3.753185281930008*^9}, 
   3.753193099420608*^9},ExpressionUUID->"0719a73d-da3d-40b7-b95b-\
f8f5b8c2d949"],

Cell[TextData[{
 "Here, J(\[Omega]) is the spectral density of all baths,  and the operators ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["A", "\[Omega]"], "i"], TraditionalForm]],ExpressionUUID->
  "95a1c38b-e22b-4268-afe9-3c3f39c90874"],
 " are given by"
}], "Text",
 CellChangeTimes->{{3.753185285290794*^9, 3.75318530065823*^9}, {
  3.753193062106586*^9, 
  3.753193091778157*^9}},ExpressionUUID->"eaaa4f34-198e-4281-8561-\
3dd86d8b54d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\t\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["A", "\[Omega]"], "i"], TraditionalForm]],ExpressionUUID->
  "81004e9e-31c0-40ec-a8cd-2ecb32e23d6b"],
 " = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"\[Epsilon]", ",", "\[Nu]"}]], 
    RowBox[{
     SubscriptBox["\[Delta]", 
      RowBox[{
       RowBox[{"\[Epsilon]", "-", "\[Nu]"}], ",", " ", "\[Omega]"}]], 
     SubscriptBox["\[CapitalPi]", "\[Epsilon]"], 
     SuperscriptBox[
      SubscriptBox["\[Sigma]", "i"], "-"], 
     SubscriptBox["\[CapitalPi]", "\[Nu]"]}]}], TraditionalForm]],
  ExpressionUUID->"26213e87-e858-4737-8100-8a12f371f0fa"]
}], "Subsubsubsubsection",
 CellChangeTimes->{{3.753193095750875*^9, 
  3.753193222598886*^9}},ExpressionUUID->"cc6656fa-6f47-4cae-bc96-\
e89894ca1ca1"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalPi]", "e"], "=", 
      RowBox[{"|", "\[Epsilon]"}]}], "\[RightAngleBracket]"}], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[Epsilon]", "|"}]}]}], TraditionalForm]],ExpressionUUID->
  "8dfaf946-4d30-441e-abd9-606326375511"],
 " is the projection operator onto the eigenstate |\[Epsilon]\
\[RightAngleBracket]. Note first that  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", "\[Omega]"], 
    SuperscriptBox[
     SubscriptBox["A", "\[Omega]"], "i"]}], TraditionalForm]],ExpressionUUID->
  "edb3856f-ef27-4cc2-9c90-ba80bd2579f3"],
 " = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "i"], "-"], TraditionalForm]],ExpressionUUID->
  "e14c6733-81f1-4c98-8d75-238d10513ac0"],
 ". This is because we just get resolutions of identities. However, the \
non-trivial step is calculating  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"\[Omega]", "'"}]], 
    RowBox[{
     RowBox[{"J", "(", 
      RowBox[{"\[Omega]", "'"}], ")"}], 
     SuperscriptBox[
      SubscriptBox["A", 
       RowBox[{"\[Omega]", "'"}]], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "09f63eb6-cdb2-4e27-9c1f-0368b1b7397e"],
 ". We therefore make this into a function of it\[CloseCurlyQuote]s own. We \
can rewrite "
}], "Text",
 CellChangeTimes->{{3.75319322894981*^9, 3.753193298141341*^9}, {
   3.753193436645191*^9, 3.7531934495995617`*^9}, {3.753193647988904*^9, 
   3.7531936778287687`*^9}, {3.7531937334318438`*^9, 3.753193814143421*^9}, {
   3.753193863475679*^9, 3.753193879966543*^9}, {3.753194008924951*^9, 
   3.7531940183499327`*^9}, 3.75319407256264*^9, {3.753194135771337*^9, 
   3.75319414299746*^9}},ExpressionUUID->"823efcb3-366d-4e91-b1b0-\
3be9a31df830"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["A", "i"], " ", "=", " "}], TraditionalForm]],
  ExpressionUUID->"0a1fed22-93b6-454e-b9e5-8b83fdb23aad"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"\[Omega]", "'"}]], 
    RowBox[{"J", "(", 
     RowBox[{"\[Omega]", "'"}], ")"}], " "}], TraditionalForm]],
  ExpressionUUID->"266048da-450b-4c84-b732-f8d1df777c34"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["A", "\[Omega]"], "i"], TraditionalForm]],ExpressionUUID->
  "17c02fad-68bd-4af8-ba51-49c6f722e009"],
 " =  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"\[Epsilon]", ",", "\[Nu]"}]], 
    RowBox[{
     RowBox[{"J", "(", 
      RowBox[{"\[Epsilon]", "-", "\[Nu]"}], ")"}], 
     SubscriptBox["\[CapitalPi]", "\[Epsilon]"], 
     SuperscriptBox[
      SubscriptBox["\[Sigma]", "i"], "-"], 
     SubscriptBox["\[CapitalPi]", "\[Nu]"]}]}], TraditionalForm]],
  ExpressionUUID->"c1f4624e-0cc1-4c46-b4e7-f61d07dc76b5"],
 "."
}], "Subsubsubsubsection",
 CellChangeTimes->{{3.753194173646914*^9, 3.7531943270812397`*^9}, {
  3.75319449618927*^9, 3.7531944964935303`*^9}, {3.753196883633645*^9, 
  3.753196892038343*^9}},ExpressionUUID->"1992a218-eb91-413f-bbf3-\
b06478fe8a9e"],

Cell["All and all, the Bloch-Redfield master equation becomes", "Text",
 CellChangeTimes->{{3.753196904077899*^9, 
  3.753196916006761*^9}},ExpressionUUID->"b084223d-0d68-4459-89ee-\
0165507e71fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\t\t",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[Rho]", "."], TraditionalForm]],ExpressionUUID->
  "d901ed1a-4e98-44ed-b2ae-8480f0235bb8"],
 " = -\[ImaginaryI] [H, \[Rho]] + ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", "i"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["A", "i"], "\[Rho]", "  ", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "+"]}], "-", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "+"], 
       SuperscriptBox["A", "i"], "\[Rho]"}], "  ", "+", " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "-"], "\[Rho]", " ", 
       SuperscriptBox[
        SuperscriptBox["A", "i"], "\[Dagger]"]}], "-", " ", 
      RowBox[{"\[Rho]", " ", 
       SuperscriptBox[
        SuperscriptBox["A", "i"], "\[Dagger]"], 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "-"]}]}], " ", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"7daa7f2a-b81b-4dbd-8f1f-0c9b31d529aa"],
 "."
}], "Subsubsubsubsection",
 CellChangeTimes->{{3.753196929508424*^9, 
  3.753197058982782*^9}},ExpressionUUID->"d26e99f8-27ce-4e23-b4b9-\
f196ec5c8ef1"],

Cell[TextData[{
 "In this form, the things that would need to be calculated would be ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["A", "i"], TraditionalForm]],ExpressionUUID->
  "4931b763-b14c-4a1d-a311-4f95d095a32a"],
 " and then the superoperator corresponding to the sum  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", "i"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["A", "i"], "\[Rho]", "  ", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "+"]}], "-", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "+"], 
       SuperscriptBox["A", "i"], "\[Rho]"}], "  ", "+", " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "-"], "\[Rho]", " ", 
       SuperscriptBox[
        SuperscriptBox["A", "i"], "\[Dagger]"]}], "-", " ", 
      RowBox[{"\[Rho]", " ", 
       SuperscriptBox[
        SuperscriptBox["A", "i"], "\[Dagger]"], 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "-"]}]}], " ", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"7daa7f2a-b81b-4dbd-8f1f-0c9b31d529aa"],
 ", known as the dissipator \[ScriptCapitalD]. \n\tThere are a few numerical \
strategies we could take for this calculation. In a number conserving model, \
we know that the eigenstates of H have definite spin-number, r. So in these \
cases, the vast majority of terms in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"\[Epsilon]", ",", "\[Nu]"}]], 
    RowBox[{
     RowBox[{"J", "(", 
      RowBox[{"\[Epsilon]", "-", "\[Nu]"}], ")"}], 
     SubscriptBox["\[CapitalPi]", "\[Epsilon]"], 
     SuperscriptBox[
      SubscriptBox["\[Sigma]", "i"], "-"], 
     SubscriptBox["\[CapitalPi]", "\[Nu]"]}]}], TraditionalForm]],
  ExpressionUUID->"c1f4624e-0cc1-4c46-b4e7-f61d07dc76b5"],
 " are zero. In the HAnIsoXY[] function, this happens when \[CapitalDelta] = \
0. However, when \[CapitalDelta] \[NotEqual] 0, we can\[CloseCurlyQuote]t \
make this assumption, and we have to think of other approaches. One approach \
is just to calculate all the terms in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["A", "i"], TraditionalForm]],ExpressionUUID->
  "22b01503-265b-4bbe-8eb3-8ec695694e5c"],
 ", which is of course the worst we could do, but is numerically exact. \
Another would be to say, well, for small \[CapitalDelta], we can approximate \
the eigenstates of H using perturbation theory. This allows one to retain the \
definite spin-number reasoning, but would require a bit more analytic work to \
determine what the dissipator \[ScriptCapitalD] looks like at first order in \
perturbation theory. This will have an entire section devoted to it.\n\t\
Another possibility, indeed with inconsistent analysis, would be to calculate \
H for small \[CapitalDelta] but calculate \[ScriptCapitalD] in the \
\[CapitalDelta] = 0 case. A sort of \[OpenCurlyDoubleQuote]zeroth-order \
perturbation\[CloseCurlyDoubleQuote] theory. This should have a significantly \
less complex computation compared to the brute force method for small \
\[CapitalDelta] and even compared to the perturbative approach. Physically \
this is of interest, because the magnetic order in the groundstate of H \
changes abruptly as soon as \[CapitalDelta] is not exactly zero, so we should \
see non-trivial steady states even in this inconsistent theory. "
}], "Text",
 CellChangeTimes->{{3.753259162670073*^9, 3.7532592265164557`*^9}, {
  3.753259273787195*^9, 3.753259451605135*^9}, {3.7532594851186333`*^9, 
  3.7532595862276382`*^9}, {3.753259748421959*^9, 3.7532598488841057`*^9}, {
  3.7532598941805964`*^9, 3.7532598944684296`*^9}, {3.7532600300921593`*^9, 
  3.753260315892288*^9}},ExpressionUUID->"4267017f-22de-438d-b3d6-\
42ece6a65f8a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Brute force master equations", "Subsection",
 CellChangeTimes->{{3.7532581290578785`*^9, 
  3.7532581374122667`*^9}},ExpressionUUID->"f399adfc-1c85-4948-a92a-\
c9fb44dd19eb"],

Cell[TextData[{
 "The following code takes a brute-force approach to calculating \
\[ScriptCapitalL] in ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[Rho]", "."], TraditionalForm]],ExpressionUUID->
  "e7c52da0-5432-42a8-8215-f842c9d6f77f"],
 " = \[ScriptCapitalL] \[Rho], by simply enumerating all pairs {|\[Epsilon]\
\[RightAngleBracket], |\[Nu]\[RightAngleBracket]} and calculating all the \
eigenoperators. "
}], "Text",
 CellChangeTimes->{{3.7532581425927863`*^9, 
  3.7532582341895275`*^9}},ExpressionUUID->"30e85e41-cb61-479c-81c9-\
2b64eab21753"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EigOpBrute", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"evals_", ",", "evecs_"}], "}"}], ",", "J_"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"evals", "//", "Length"}]}], ",", "\[IndentingNewLine]", 
      "SigmamSite", ",", "\[IndentingNewLine]", "EigOpSite", ",", 
      "\[IndentingNewLine]", "bareEigOps"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Initialise", " ", "the", " ", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "-"], " ", "operators", " ", "for", 
       " ", "all", " ", "i"}], " ", "\[Element]", " ", 
      RowBox[{
       RowBox[{"[", 
        RowBox[{"1", ",", " ", "n"}], "]"}], "."}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SigmamSite", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Tensor", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Piecewise", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Sigmam", ",", 
                RowBox[{"i", "\[Equal]", "j"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Id", ",", "True"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Log", "[", 
              RowBox[{"2", ",", "n"}], "]"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Log", "[", 
           RowBox[{"2", ",", "n"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "These", " ", "are", " ", "the", " ", "projection", " ", "operators", 
       " ", "of", " ", "the", " ", "eigenstates", " ", 
       RowBox[{"given", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bareEigOps", "=", 
      RowBox[{"ParallelMap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SparseArray", "[", 
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", "#", ",", "#"}], "]"}], "]"}], "&"}], ",", 
        "evecs"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Enumeration", " ", "of", " ", "all", " ", "operators", " ", 
        RowBox[{
         SubscriptBox["\[Sum]", 
          RowBox[{"\[Epsilon]", ",", "\[Nu]"}]], 
         RowBox[{"J", 
          RowBox[{"(", 
           RowBox[{"\[Epsilon]", "-", "\[Nu]"}], ")"}], 
          SubscriptBox["\[CapitalPi]", "\[Epsilon]"], 
          SuperscriptBox[
           SubscriptBox["\[Sigma]", "i"], "-"], 
          SubscriptBox["\[CapitalPi]", "v"], " ", "for", " ", "each", " ", 
          "i"}]}]}], " ", "\[Element]", " ", 
       RowBox[{
        RowBox[{"[", 
         RowBox[{"1", ",", " ", "n"}], "]"}], "."}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"EigOpSite", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"ParallelTable", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"J", "[", 
               RowBox[{
                RowBox[{
                "evals", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "-", 
                RowBox[{
                "evals", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], "]"}], " ", 
              RowBox[{
               RowBox[{
               "bareEigOps", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ".", "#", ".", 
               RowBox[{
               "bareEigOps", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "n"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
         "]"}], "&"}], "/@", "SigmamSite"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "EigOpSite", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "super", " ", "operator", " ", "corresponding", " ", "to", 
     " ", "the", " ", "sum", " ", 
     RowBox[{
      FormBox[
       RowBox[{
        SubscriptBox["\[Sum]", "i"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[Sigma]", "i"], "+"], 
           SuperscriptBox["A", "i"], "\[Rho]"}], " ", "+", " ", 
          RowBox[{"\[Rho]", " ", 
           SuperscriptBox[
            SuperscriptBox["A", "i"], "\[Dagger]"], 
           SuperscriptBox[
            SubscriptBox["\[Sigma]", "i"], "-"]}], " ", "-", " ", 
          RowBox[{
           SuperscriptBox["A", "i"], "\[Rho]", " ", 
           SuperscriptBox[
            SubscriptBox["\[Sigma]", "i"], "+"]}], " ", "-", " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[Sigma]", "i"], "-"], "\[Rho]", " ", 
           SuperscriptBox[
            SuperscriptBox["A", "i"], "\[Dagger]"]}]}], ")"}]}],
       TraditionalForm], ".", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "You", " ", "would", " ", "need", " ", "to", " ", "add", " ", "the", 
         " ", "unitary", " ", "part"}], " ", "-", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "[", 
          RowBox[{"H", ",", " ", "\[Rho]"}], "]"}], " ", "to", " ", "find", 
         " ", "a", " ", "full", " ", 
         RowBox[{"Liouvillian", "."}]}]}], ")"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.781426937152625*^9, 3.781427001867256*^9}, {
  3.7815107153326073`*^9, 3.781510745652445*^9}, {3.7815108927769938`*^9, 
  3.78151090069375*^9}, {3.782152583823189*^9, 3.78215258674656*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"9762b6d3-118a-430f-abe7-ff561f6b41d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlochRedfieldBrute", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"evals_", ",", "evecs_"}], "}"}], ",", "J_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"evals", "//", "Length"}]}], ",", "\[IndentingNewLine]", 
      "SigmamSite", ",", "\[IndentingNewLine]", "EigOpSite", ",", 
      "\[IndentingNewLine]", "bareEigOps"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Initialise", " ", "the", " ", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "-"], " ", "operators", " ", "for", 
       " ", "all", " ", "i"}], " ", "\[Element]", " ", 
      RowBox[{
       RowBox[{"[", 
        RowBox[{"1", ",", " ", "n"}], "]"}], "."}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SigmamSite", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Tensor", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Piecewise", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Sigmam", ",", 
                RowBox[{"i", "\[Equal]", "j"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Id", ",", "True"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Log", "[", 
              RowBox[{"2", ",", "n"}], "]"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Log", "[", 
           RowBox[{"2", ",", "n"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "These", " ", "are", " ", "the", " ", "projection", " ", "operators", 
       " ", "of", " ", "the", " ", "eigenstates", " ", 
       RowBox[{"given", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bareEigOps", "=", 
      RowBox[{"ParallelMap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SparseArray", "[", 
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", "#", ",", "#"}], "]"}], "]"}], "&"}], ",", 
        "evecs"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Enumeration", " ", "of", " ", "all", " ", "operators", " ", 
        RowBox[{
         SubscriptBox["\[Sum]", 
          RowBox[{"\[Epsilon]", ",", "\[Nu]"}]], 
         RowBox[{"J", 
          RowBox[{"(", 
           RowBox[{"\[Epsilon]", "-", "\[Nu]"}], ")"}], 
          SubscriptBox["\[CapitalPi]", "\[Epsilon]"], 
          SuperscriptBox[
           SubscriptBox["\[Sigma]", "i"], "-"], 
          SubscriptBox["\[CapitalPi]", "v"], " ", "for", " ", "each", " ", 
          "i"}]}]}], " ", "\[Element]", " ", 
       RowBox[{
        RowBox[{"[", 
         RowBox[{"1", ",", " ", "n"}], "]"}], "."}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"EigOpSite", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"ParallelTable", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"J", "[", 
               RowBox[{
                RowBox[{
                "evals", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "-", 
                RowBox[{
                "evals", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], "]"}], " ", 
              RowBox[{
               RowBox[{
               "bareEigOps", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ".", "#", ".", 
               RowBox[{
               "bareEigOps", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "n"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
         "]"}], "&"}], "/@", "SigmamSite"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "The", " ", "super", " ", "operator", " ", "corresponding", " ", "to", 
       " ", "the", " ", "sum", " ", 
       RowBox[{
        FormBox[
         RowBox[{
          SubscriptBox["\[Sum]", "i"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              SubscriptBox["\[Sigma]", "i"], "+"], 
             SuperscriptBox["A", "i"], "\[Rho]"}], " ", "+", " ", 
            RowBox[{"\[Rho]", " ", 
             SuperscriptBox[
              SuperscriptBox["A", "i"], "\[Dagger]"], 
             SuperscriptBox[
              SubscriptBox["\[Sigma]", "i"], "-"]}], " ", "-", " ", 
            RowBox[{
             SuperscriptBox["A", "i"], "\[Rho]", " ", 
             SuperscriptBox[
              SubscriptBox["\[Sigma]", "i"], "+"]}], " ", "-", " ", 
            RowBox[{
             SuperscriptBox[
              SubscriptBox["\[Sigma]", "i"], "-"], "\[Rho]", " ", 
             SuperscriptBox[
              SuperscriptBox["A", "i"], "\[Dagger]"]}]}], ")"}]}],
         TraditionalForm], ".", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "You", " ", "would", " ", "need", " ", "to", " ", "add", " ", "the",
            " ", "unitary", " ", "part"}], " ", "-", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", "[", 
            RowBox[{"H", ",", " ", "\[Rho]"}], "]"}], " ", "to", " ", "find", 
           " ", "a", " ", "full", " ", 
           RowBox[{"Liouvillian", "."}]}]}], ")"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Total", "[", 
      RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"SuperLR", "[", 
          RowBox[{
           RowBox[{
           "EigOpSite", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{
            "SigmamSite", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "\[Transpose]"}]}], "]"}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"SuperLR", "[", 
          RowBox[{
           RowBox[{
           "SigmamSite", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{
            "EigOpSite", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "\[HermitianConjugate]"}]}], "]"}], 
         "\[IndentingNewLine]", "-", 
         RowBox[{"SuperLR", "[", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "EigOpSite", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[HermitianConjugate]"}], ".", 
            RowBox[{
            "SigmamSite", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}]}], "]"}], "\[IndentingNewLine]", "-", 
         RowBox[{"SuperLR", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "SigmamSite", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[Transpose]"}], ".", 
            RowBox[{
            "EigOpSite", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Log", "[", 
           RowBox[{"2", ",", "n"}], "]"}]}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.75318538701831*^9, 3.753185409570177*^9}, {
   3.753192651966921*^9, 3.753192780339867*^9}, {3.753192852663538*^9, 
   3.7531928685867662`*^9}, {3.7531929174964237`*^9, 
   3.7531929440412273`*^9}, {3.753197178727171*^9, 3.753197272372538*^9}, {
   3.753197330959075*^9, 3.75319734048586*^9}, {3.753197440239664*^9, 
   3.7531974815791693`*^9}, {3.753197525529869*^9, 3.753197776630391*^9}, {
   3.753197826552299*^9, 3.753197859119817*^9}, {3.753197965822526*^9, 
   3.753197985382596*^9}, {3.753198060568192*^9, 3.753198071542903*^9}, {
   3.7531981256760483`*^9, 3.753198139201416*^9}, {3.753198592336348*^9, 
   3.753198632734634*^9}, 3.753198963279666*^9, {3.753290295636125*^9, 
   3.753290325542996*^9}, {3.7534702102561183`*^9, 3.753470252501072*^9}, {
   3.753470283847002*^9, 3.7534702939524035`*^9}, {3.7534707293695436`*^9, 
   3.7534708389676485`*^9}, {3.7534708725833297`*^9, 3.753471028073374*^9}, {
   3.7534711635594378`*^9, 3.7534712109878044`*^9}, {3.7534712716065025`*^9, 
   3.753471342662483*^9}, {3.7534716656813707`*^9, 3.753471683537671*^9}, {
   3.753517500461341*^9, 3.75351750064878*^9}, {3.778523610367668*^9, 
   3.778523616614518*^9}, 3.778523722673563*^9, {3.7785237573329697`*^9, 
   3.778523767308632*^9}, 3.781427616486068*^9, 3.781434823540629*^9},
 CellLabel->"In[51]:=",ExpressionUUID->"2c7c5f50-1a02-44ff-99ee-cdbb4bdc639b"],

Cell[TextData[{
 "When the spectral density is simply a constant, namely J(\[Omega]) = 1, \
then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["A", "i"], "=", 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "i"], "-"]}], TraditionalForm]],ExpressionUUID->
  "540e77ff-4b15-4193-ade4-3ec6a3046e12"],
 ", thus"
}], "Text",
 CellChangeTimes->{{3.7534718681745615`*^9, 3.753471919007553*^9}, {
  3.7536191914713373`*^9, 3.7536192672599783`*^9}, {3.753619314780788*^9, 
  3.753619356340197*^9}, {3.7541619686051607`*^9, 
  3.754162092879121*^9}},ExpressionUUID->"733cabd6-617e-49fb-b7cb-\
73c0f0b94ef9"],

Cell[CellGroupData[{

Cell[TextData[{
 "\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", "i"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["A", "i"], "\[Rho]", "  ", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "+"]}], "-", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "+"], 
       SuperscriptBox["A", "i"], "\[Rho]"}], "  ", "+", " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "-"], "\[Rho]", " ", 
       SuperscriptBox[
        SuperscriptBox["A", "i"], "\[Dagger]"]}], "-", " ", 
      RowBox[{"\[Rho]", " ", 
       SuperscriptBox[
        SuperscriptBox["A", "i"], "\[Dagger]"], 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "i"], "-"]}]}], " ", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"07316fd4-df61-4cc3-a5cc-14b704663653"],
 " = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", "i"], 
    RowBox[{"\[ScriptCapitalL]", "[", 
     SuperscriptBox[
      SubscriptBox["\[Sigma]", "i"], "-"], "]"}]}], TraditionalForm]],
  ExpressionUUID->"945aeaa5-500c-47bf-a1cd-2bb1842c436e"],
 ": "
}], "Subsubsubsubsection",
 CellChangeTimes->{{3.754162095673314*^9, 
  3.7541620968779993`*^9}},ExpressionUUID->"642f9b30-910d-435a-9990-\
992e2ae55140"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"nn", "=", "3"}], ";", 
    RowBox[{
     RowBox[{
      RowBox[{"BlochRedfieldBrute", "[", 
       RowBox[{
        RowBox[{"Eigensystem", "[", 
         RowBox[{"HAnIsoXY", "[", 
          RowBox[{"nn", ",", "1.", ",", "1."}], "]"}], "]"}], ",", 
        RowBox[{"1", "&"}]}], "]"}], "//", "Chop"}], "//", "Round"}]}], ")"}],
   "==", 
  RowBox[{"Total", "[", 
   RowBox[{"Lindblad", "/@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Tensor", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Piecewise", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Sigmam", ",", 
              RowBox[{"i", "\[Equal]", "j"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Id", ",", "True"}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nn"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "nn"}], "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7534704038373294`*^9, 3.753470512823837*^9}, {
   3.753471557574064*^9, 3.753471559873745*^9}, {3.7534717117149525`*^9, 
   3.753471857756607*^9}, {3.753617401932555*^9, 3.7536174192398767`*^9}, 
   3.7785238548256598`*^9},
 CellLabel->"In[63]:=",ExpressionUUID->"ad3423e6-6361-4e6f-a89a-f3c0bbb3190d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unperturbed Dissipator", "Subsection",
 CellChangeTimes->{{3.778741668687191*^9, 3.778741675651906*^9}, 
   3.785836136600267*^9},ExpressionUUID->"936a3811-3de8-4928-ac71-\
7084a9745b7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ZeroDeltaEigOp", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"evalsList_", ",", " ", "evecsList_"}], "}"}], ",", " ", "J_"}],
     "]"}], " ", ":=", " ", "\n", "  ", 
   RowBox[{"Module", "[", "\n", "   ", 
    RowBox[{
     RowBox[{"{", "\n", "    ", 
      RowBox[{
       RowBox[{"outerList", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", " ", "#", ",", " ", "#"}], "]"}], " ", 
           "&"}], ",", " ", "evecsList", ",", " ", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\n", "    ", "outerPairs",
        ",", "\n", "    ", "EigOpBlock", ",", "\n", "    ", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{
         RowBox[{"Length", "[", "evalsList", "]"}], " ", "-", " ", "1"}]}], 
       ",", "\n", "    ", "SigmamSitesBlocks", ",", "\n", "    ", 
       "SigmamSite", ",", "\n", "    ", "U", ",", "\n", "    ", "EigOpSite"}],
       "\n", "    ", "}"}], ",", "\n", "   ", 
     RowBox[{
      RowBox[{"SigmamSitesBlocks", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"MinusBlocks", "[", 
          RowBox[{"n", ",", " ", "j"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "n"}], "}"}]}], "]"}]}], ";", "\n", "   ", 
      "\n", "   ", 
      RowBox[{"SigmamSite", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Tensor", " ", "@@", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            TagBox[GridBox[{
               {"\[Piecewise]", GridBox[{
                  {"Sigmam", 
                   RowBox[{"i", "==", "j"}]},
                  {"Id", "True"}
                 },
                 AllowedDimensions->{2, Automatic},
                 Editable->True,
                 
                 GridBoxAlignment->{
                  "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{1.}}, "RowsIndexed" -> {}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}},
                 Selectable->True]}
              },
              
              GridBoxAlignment->{
               "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{1.}}, "RowsIndexed" -> {}},
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.35]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.4]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             "Piecewise",
             DeleteWithContents->True,
             Editable->False,
             SelectWithContents->True,
             Selectable->False], " ", ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "n"}], "}"}]}], "]"}]}], ";", "\n", "   ", 
      "\n", "   ", 
      RowBox[{"U", " ", "=", " ", 
       RowBox[{"TotalSpinBasis", "[", "n", "]"}]}], ";", "\n", "   ", "\n", 
      "   ", 
      RowBox[{"outerPairs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "evalsList", "\[LeftDoubleBracket]", "r", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "outerList", "\[LeftDoubleBracket]", "r", 
              "\[RightDoubleBracket]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"evalsList", "\[LeftDoubleBracket]", 
              RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"outerList", "\[LeftDoubleBracket]", 
              RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"r", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EigOpBlock", "[", 
        RowBox[{"oper_", ",", "pair_"}], "]"}], ":=", 
       RowBox[{"Total", "[", 
        RowBox[{"Flatten", "[", "\n", "      ", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"J", "[", 
              RowBox[{
               RowBox[{"pair", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1", ",", "i"}], "\[RightDoubleBracket]"}], 
               "-", 
               RowBox[{"pair", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1", ",", "j"}], 
                "\[RightDoubleBracket]"}]}], "]"}], 
             RowBox[{
              RowBox[{"pair", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2", ",", "i"}], "\[RightDoubleBracket]"}], 
              ".", "oper", ".", 
              RowBox[{"pair", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "2", ",", "j"}], 
               "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"pair", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"pair", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
             "}"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], ";", "\n", "   ", 
      "\n", "  ", 
      RowBox[{"EigOpSite", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"U", "\[Transpose]"}], ".", "#", ".", "U"}], "&"}], "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Blockto2N", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"EigOpBlock", "[", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
                "]"}], "&"}], "/@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "SigmamSitesBlocks", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "outerPairs", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ",", " ", 
            RowBox[{"-", "1"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}]}], ";", "\n", "   ", 
      "\n", "   ", "EigOpSite"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.780905147658004*^9, 3.7809052121938553`*^9}, {
  3.780905243835806*^9, 3.7809052483420963`*^9}, {3.781094707560791*^9, 
  3.781095064731511*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"2572b0e9-90c6-4591-9462-a7e1896bdd16"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlochRedfieldZero\[CapitalDelta]", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"evalsList_", ",", "evecsList_"}], "}"}], ",", "J_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"outerList", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", "#", ",", "#"}], "]"}], "&"}], ",", 
          "evecsList", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "outerPairs", ",", "\[IndentingNewLine]", "EigOpBlock", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"Length", "[", "evalsList", "]"}], "-", "1"}]}], ",", 
       "\[IndentingNewLine]", "SigmamSitesBlocks", ",", "\[IndentingNewLine]",
        "SigmamSite", ",", "\[IndentingNewLine]", "U", ",", 
       "\[IndentingNewLine]", "EigOpSite"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SigmamSitesBlocks", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"MinusBlocks", "[", 
          RowBox[{"n", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"SigmamSite", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Tensor", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            TagBox[GridBox[{
               {"\[Piecewise]", GridBox[{
                  {"Sigmam", 
                   RowBox[{"i", "\[Equal]", "j"}]},
                  {"Id", "True"}
                 },
                 AllowedDimensions->{2, Automatic},
                 Editable->True,
                 GridBoxAlignment->{
                  "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{1.}}, "RowsIndexed" -> {}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}},
                 Selectable->True]}
              },
              
              GridBoxAlignment->{
               "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{1.}}, "RowsIndexed" -> {}},
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.35]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.4]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             "Piecewise",
             DeleteWithContents->True,
             Editable->False,
             SelectWithContents->True,
             Selectable->False], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"U", "=", 
       RowBox[{"TotalSpinBasis", "[", "n", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"outerPairs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "evalsList", "\[LeftDoubleBracket]", "r", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "outerList", "\[LeftDoubleBracket]", "r", 
              "\[RightDoubleBracket]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"evalsList", "\[LeftDoubleBracket]", 
              RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"outerList", "\[LeftDoubleBracket]", 
              RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EigOpBlock", "[", 
        RowBox[{"oper_", ",", "pair_"}], "]"}], ":=", 
       RowBox[{"Total", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"J", "[", 
              RowBox[{
               RowBox[{"pair", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1", ",", "i"}], "\[RightDoubleBracket]"}], 
               "-", 
               RowBox[{"pair", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1", ",", "j"}], 
                "\[RightDoubleBracket]"}]}], "]"}], " ", 
             RowBox[{
              RowBox[{"pair", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2", ",", "i"}], "\[RightDoubleBracket]"}], 
              ".", "oper", ".", 
              RowBox[{"pair", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "2", ",", "j"}], 
               "\[RightDoubleBracket]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"pair", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"pair", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
             "}"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"EigOpSite", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"U", "\[Transpose]"}], ".", "#", ".", "U"}], "&"}], "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Blockto2N", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"EigOpBlock", "[", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
                "]"}], "&"}], "/@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "SigmamSitesBlocks", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "outerPairs", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Total", "[", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SuperLR", "[", 
           RowBox[{
            RowBox[{
            "EigOpSite", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{
             "SigmamSite", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[Transpose]"}]}], "]"}], 
          "\[IndentingNewLine]", "+", 
          RowBox[{"SuperLR", "[", 
           RowBox[{
            RowBox[{
            "SigmamSite", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{
             "EigOpSite", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[HermitianConjugate]"}]}], "]"}], 
          "\[IndentingNewLine]", "-", 
          RowBox[{"SuperLR", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"2", "^", "n"}], ",", 
                RowBox[{"2", "^", "n"}]}], "}"}], "]"}], "//", 
             "SparseArray"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
              "EigOpSite", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "\[HermitianConjugate]"}], ".", 
             RowBox[{
             "SigmamSite", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}], "]"}], "\[IndentingNewLine]", 
          "-", 
          RowBox[{"SuperLR", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "SigmamSite", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "\[Transpose]"}], ".", 
             RowBox[{
             "EigOpSite", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"2", "^", "n"}], ",", 
                RowBox[{"2", "^", "n"}]}], "}"}], "]"}], "//", 
             "SparseArray"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.75334581586335*^9, 3.7533458427118683`*^9}, {
   3.7533459724051332`*^9, 3.7533460096346817`*^9}, {3.7533461332404547`*^9, 
   3.753346133814124*^9}, {3.7533476187373505`*^9, 3.753347726762864*^9}, {
   3.7533482719686966`*^9, 3.753348406642062*^9}, {3.7533485192391796`*^9, 
   3.7533485378094788`*^9}, 3.753472377555415*^9, {3.753473835659206*^9, 
   3.7534738357911367`*^9}, {3.753473938787936*^9, 3.7534739640024543`*^9}, {
   3.753474008013151*^9, 3.7534741945659466`*^9}, {3.7534742337244415`*^9, 
   3.7534744693060493`*^9}, {3.7534745075250735`*^9, 3.7534746465201917`*^9}, 
   3.7534746934492207`*^9, 3.7534748711101155`*^9, {3.7534749805022564`*^9, 
   3.753475034629139*^9}, {3.753475141848518*^9, 3.7534751547720904`*^9}, {
   3.753475255777687*^9, 3.753475293875346*^9}, {3.7534753684122157`*^9, 
   3.75347537138156*^9}, {3.753475608335617*^9, 3.753475669317439*^9}, {
   3.753475879789412*^9, 3.7534758814054813`*^9}, {3.7534762141841617`*^9, 
   3.753476295662752*^9}, {3.7534763281998014`*^9, 3.7534763970394087`*^9}, {
   3.7534764686982803`*^9, 3.7534765179671345`*^9}, {3.7534765676722603`*^9, 
   3.7534765996403646`*^9}, {3.778409876715663*^9, 3.778409905616158*^9}, {
   3.778409971813931*^9, 3.778409973559041*^9}, {3.778410141776602*^9, 
   3.7784101661053*^9}, 3.778523920806758*^9, {3.778741700768798*^9, 
   3.7787417012537403`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"22c1df37-082d-4d5e-8273-4226e0748c4a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Perturbative approach", "Subsection",
 CellChangeTimes->{{3.772173745770509*^9, 
  3.772173748895711*^9}},ExpressionUUID->"a90d8dd0-7c18-43fb-af3c-\
6311bcc56292"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EigVecKet", "[", "r_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"r", "-", "2"}], "<", "0"}], ",", 
       RowBox[{
        SubscriptBox["\[Epsilon]", "r"], "+", 
        SubscriptBox["P", 
         RowBox[{"r", "+", "2"}]]}], ",", 
       RowBox[{
        RowBox[{"r", "+", "2"}], ">", "n"}], ",", " ", 
       RowBox[{
        SubscriptBox["\[Epsilon]", "r"], "+", 
        SubscriptBox["M", 
         RowBox[{"r", "-", "2"}]]}], ",", "True", ",", 
       RowBox[{
        SubscriptBox["\[Epsilon]", "r"], "+", 
        SubscriptBox["M", 
         RowBox[{"r", "-", "2"}]], "+", 
        SubscriptBox["P", 
         RowBox[{"r", "+", "2"}]]}]}], "]"}], "/;", 
     RowBox[{"0", "\[LessEqual]", "r", "\[LessEqual]", "n"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"&", " ", 
    RowBox[{"h", ".", "c", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EigVecBra", "[", "r_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"r", "-", "2"}], "<", "0"}], ",", 
       RowBox[{
        SubscriptBox["\[Epsilon]T", "r"], "+", 
        SubscriptBox["PT", 
         RowBox[{"r", "+", "2"}]]}], ",", 
       RowBox[{
        RowBox[{"r", "+", "2"}], ">", "n"}], ",", " ", 
       RowBox[{
        SubscriptBox["\[Epsilon]T", "r"], "+", 
        SubscriptBox["MT", 
         RowBox[{"r", "-", "2"}]]}], ",", "True", ",", 
       RowBox[{
        SubscriptBox["\[Epsilon]T", "r"], "+", 
        SubscriptBox["MT", 
         RowBox[{"r", "-", "2"}]], "+", 
        SubscriptBox["PT", 
         RowBox[{"r", "+", "2"}]]}]}], "]"}], "/;", 
     RowBox[{"0", "\[LessEqual]", "r", "\[LessEqual]", "n"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "expansion", " ", "of", " ", "the", " ", "outer", " ", 
     "products", " ", "are", " ", "encoded", " ", "as", " ", "the", " ", 
     "i"}], ",", 
    RowBox[{"jth", " ", "elements", " ", "of", " ", 
     RowBox[{"the", " ", "'"}], "matrix", " ", "of", " ", 
     RowBox[{"matrices", "'"}], " ", 
     RowBox[{"A", "\[Wedge]", "B"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EigOpZero", "[", 
     RowBox[{"r_", ",", "rp_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Epsilon]", "r"], "\[Wedge]", 
       SubscriptBox["\[Epsilon]T", "rp"]}], ")"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0", "\[LessEqual]", "r", "\[LessEqual]", "n"}], "&&", 
       RowBox[{"0", "\[LessEqual]", "rp", "\[LessEqual]", "n"}]}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EigOpFirst", "[", 
     RowBox[{"r_", ",", "rp_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rp", "+", "2"}], "\[LessEqual]", "n"}], ",", 
       RowBox[{
        SubscriptBox["\[Epsilon]", "r"], "\[Wedge]", 
        SubscriptBox["PT", 
         RowBox[{"rp", "+", "2"}]]}], ",", "0"}], "]"}], "+", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rp", "-", "2"}], "\[GreaterEqual]", "0"}], ",", 
       RowBox[{
        SubscriptBox["\[Epsilon]", "r"], "\[Wedge]", 
        SubscriptBox["MT", 
         RowBox[{"rp", "-", "2"}]]}], ",", "0"}], "]"}], "+", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"r", "+", "2"}], "\[LessEqual]", "n"}], ",", 
       RowBox[{
        SubscriptBox["P", 
         RowBox[{"r", "+", "2"}]], "\[Wedge]", 
        SubscriptBox["\[Epsilon]T", "rp"]}], ",", "0"}], "]"}], "+", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"r", "-", "2"}], "\[GreaterEqual]", "0"}], ",", 
       RowBox[{
        SubscriptBox["M", 
         RowBox[{"r", "-", "2"}]], "\[Wedge]", 
        SubscriptBox["\[Epsilon]T", "rp"]}], ",", "0"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EigOpZero", "[", 
     RowBox[{"r_", ",", "rp_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Epsilon]", "r"], "\[Wedge]", 
       SubscriptBox["\[Epsilon]T", "rp"]}], ")"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0", "\[LessEqual]", "r", "\[LessEqual]", "n"}], "&&", 
       RowBox[{"0", "\[LessEqual]", "rp", "\[LessEqual]", "n"}]}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EigOpFirst", "[", 
     RowBox[{"r_", ",", "rp_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rp", "+", "2"}], "\[LessEqual]", "n"}], ",", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "r"], "\[Wedge]", 
         SubscriptBox["PT", 
          RowBox[{"rp", "+", "2"}]]}], ",", "0"}], "]"}], "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rp", "-", "2"}], "\[GreaterEqual]", "0"}], ",", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "r"], "\[Wedge]", 
         SubscriptBox["MT", 
          RowBox[{"rp", "-", "2"}]]}], ",", "0"}], "]"}], "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "+", "2"}], "\[LessEqual]", "n"}], ",", 
        RowBox[{
         SubscriptBox["P", 
          RowBox[{"r", "+", "2"}]], "\[Wedge]", 
         SubscriptBox["\[Epsilon]T", "rp"]}], ",", "0"}], "]"}], "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "-", "2"}], "\[GreaterEqual]", "0"}], ",", 
        RowBox[{
         SubscriptBox["M", 
          RowBox[{"r", "-", "2"}]], "\[Wedge]", 
         SubscriptBox["\[Epsilon]T", "rp"]}], ",", "0"}], "]"}]}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0", "\[LessEqual]", "r", "\[LessEqual]", "n"}], "&&", 
       RowBox[{"0", "\[LessEqual]", "rp", "\[LessEqual]", "n"}]}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LeadingOrderQ", "[", 
     RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"A", "===", "\[Epsilon]T"}], "&&", 
       RowBox[{"B", "===", "\[Epsilon]"}]}], ")"}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"A", "===", "\[Epsilon]T"}], "&&", 
       RowBox[{"B", "===", "M"}]}], ")"}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"A", "===", "\[Epsilon]T"}], "&&", 
       RowBox[{"B", "===", "P"}]}], ")"}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"A", "===", "MT"}], "&&", 
       RowBox[{"B", "===", "\[Epsilon]"}]}], ")"}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"A", "===", "PT"}], "&&", 
       RowBox[{"B", "===", "\[Epsilon]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FirstOrderQ", "[", "elem_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"elem", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["PT", "_"], "\[Rule]", "0"}], ",", 
          RowBox[{
           SubscriptBox["MT", "_"], "\[Rule]", "0"}], ",", 
          RowBox[{
           SubscriptBox["P", "_"], "\[Rule]", "0"}], ",", 
          RowBox[{
           SubscriptBox["M", "_"], "\[Rule]", "0"}]}], "}"}]}], "//", 
       "TensorExpand"}], ")"}], "===", "0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PertVects", "[", 
    RowBox[{"{", 
     RowBox[{"eEner_", ",", "eVec_"}], "}"}], "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"Length", "[", "eEner", "]"}], "-", "1"}]}], ",", 
       "\[IndentingNewLine]", "\[CapitalXi]iiP2", ",", "Vmm", ",", 
       "\[CapitalXi]iiM2", ",", "Vpp", ",", "mi", ",", "pi", ",", "P2toN", 
       ",", "M0toNm2", ",", "M", ",", "P", ",", "Pr", ",", "Mr", ",", 
       "\[CapitalXi]iiP2denom", ",", "\[CapitalXi]iiM2denom"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalXi]iiP2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "eVec", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{"eVec", "\[LeftDoubleBracket]", 
            RowBox[{"i", "+", "2"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"MINUS", " ", 
        RowBox[{"SIGN", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[CapitalXi]iiP2denom", "=", 
       RowBox[{"-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                "eEner", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "i0", 
                "\[RightDoubleBracket]"}], "-", 
               RowBox[{
                RowBox[{"eEner", "\[LeftDoubleBracket]", 
                 RowBox[{"i", "+", "2"}], "\[RightDoubleBracket]"}], 
                "\[LeftDoubleBracket]", "i2", "\[RightDoubleBracket]"}]}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i0", ",", 
              RowBox[{"Binomial", "[", 
               RowBox[{"n", ",", 
                RowBox[{"i", "-", "1"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"Binomial", "[", 
               RowBox[{"n", ",", 
                RowBox[{"i", "+", "1"}]}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Vmm", "=", 
       RowBox[{"Normal", "/@", 
        RowBox[{"MinusMinusBlocks", "[", 
         RowBox[{"n", ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalXi]iiM2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"eVec", "\[LeftDoubleBracket]", 
            RowBox[{"i", "+", "2"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "eVec", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"MINUS", " ", 
        RowBox[{"SIGN", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[CapitalXi]iiM2denom", "=", 
       RowBox[{"-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"eEner", "\[LeftDoubleBracket]", 
                 RowBox[{"i", "+", "2"}], "\[RightDoubleBracket]"}], 
                "\[LeftDoubleBracket]", "i2", "\[RightDoubleBracket]"}], "-", 
               RowBox[{
                RowBox[{
                "eEner", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "i0", 
                "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"Binomial", "[", 
               RowBox[{"n", ",", 
                RowBox[{"i", "+", "1"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i0", ",", 
              RowBox[{"Binomial", "[", 
               RowBox[{"n", ",", 
                RowBox[{"i", "-", "1"}]}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Vpp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"#", "\[Transpose]"}], "]"}], "&"}], "/@", 
        RowBox[{"MinusMinusBlocks", "[", 
         RowBox[{"n", ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"Dimensions", ",", "\[CapitalXi]iiP2", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Dimensions", "/@", "Vmm"}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Perturbative", " ", "corrections"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
           "#2", ".", 
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[Transpose]"}]}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[CapitalXi]iiP2", ",", "Vmm"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
           "#2", ".", 
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[Transpose]"}]}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[CapitalXi]iiM2", ",", "Vpp"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "*", 
          RowBox[{
          "\[CapitalXi]iiP2denom", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Why", " ", 
        RowBox[{"aren", "'"}], "t", " ", "these", " ", "matched", "??"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"P", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "*", 
          RowBox[{
          "\[CapitalXi]iiM2denom", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "P", "]"}]}], "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Yeah", " ", "still", " ", "confused"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Rmemeber", " ", "the", " ", 
        RowBox[{
         RowBox[{"demonimator", " ", "!!"}], "!!"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Corrective", " ", "VECTORS"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{" ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[LeftAngleBracket]", 
            RowBox[{
             RowBox[{"r", "-", "2"}], ",", 
             RowBox[{
              SubscriptBox["j", 
               RowBox[{"r", "-", "2"}]], "|", 
              SubsuperscriptBox["\[ScriptCapitalP]", 
               SubscriptBox["i", "r"], 
               RowBox[{"(", 
                RowBox[{"r", "+", "2"}], ")"}]]}]}], "\[RightAngleBracket]"}],
            " ", "=", " ", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Sum]", 
              SubscriptBox["i", 
               RowBox[{"r", "+", "2"}]]], 
             SubsuperscriptBox["P", 
              RowBox[{
               SubscriptBox["i", "r"], 
               SubscriptBox["i", 
                RowBox[{"r", "+", "2"}]]}], 
              RowBox[{"(", 
               RowBox[{"r", "+", "2"}], ")"}]]}], "|", 
            RowBox[{"r", "+", "2"}]}]}], ",", 
          SubscriptBox["i", 
           RowBox[{"r", "+", "2"}]]}], "\[RightAngleBracket]"}], " ", "=", 
        " ", 
        SubscriptBox[
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ScriptCapitalP]", 
             RowBox[{"(", 
              RowBox[{"r", "+", "2"}], ")"}]], "\[Transpose]"}], ".", 
           SuperscriptBox["E", 
            RowBox[{"(", 
             RowBox[{"r", "+", "2"}], ")"}]]}], "]"}], 
         RowBox[{
          SubscriptBox["i", "r"], 
          SubscriptBox["j", 
           RowBox[{"r", "+", "2"}]]}]]}], "\[IndentingNewLine]", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "  ", "AND", "  ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[LeftAngleBracket]", 
            RowBox[{
             RowBox[{"r", "-", "2"}], ",", 
             RowBox[{
              SubscriptBox["j", 
               RowBox[{"r", "-", "2"}]], "|", 
              SubsuperscriptBox["\[ScriptCapitalM]", 
               SubscriptBox["i", "r"], 
               RowBox[{"(", 
                RowBox[{"r", "-", "2"}], ")"}]]}]}], "\[RightAngleBracket]"}],
            " ", "=", " ", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Sum]", 
              SubscriptBox["i", 
               RowBox[{"r", "-", "2"}]]], 
             SubsuperscriptBox["M", 
              RowBox[{
               SubscriptBox["i", "r"], 
               SubscriptBox["i", 
                RowBox[{"r", "-", "2"}]]}], 
              RowBox[{"(", 
               RowBox[{"r", "-", "2"}], ")"}]]}], "|", 
            RowBox[{"r", "-", "2"}]}]}], ",", 
          SubscriptBox["i", 
           RowBox[{"r", "-", "2"}]]}], "\[RightAngleBracket]"}], " ", "=", 
        " ", 
        SubscriptBox[
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ScriptCapitalM]", 
             RowBox[{"(", 
              RowBox[{"r", "-", "2"}], ")"}]], "\[Transpose]"}], ".", 
           SuperscriptBox["E", 
            RowBox[{"(", 
             RowBox[{"r", "-", "2"}], ")"}]]}], "]"}], 
         RowBox[{
          SubscriptBox["i", "r"], 
          SubscriptBox["j", 
           RowBox[{"r", "-", "2"}]]}]]}], "\[IndentingNewLine]", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"P2toN", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "P", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[Transpose]"}], ".", 
          RowBox[{"eVec", "\[LeftDoubleBracket]", 
           RowBox[{"i", "+", "2"}], "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Pr", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "~", "Join", "~", "P2toN"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"M0toNm2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[Transpose]"}], ".", 
          RowBox[{
          "eVec", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mr", "=", 
       RowBox[{"M0toNm2", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"Pr", ",", "Mr"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7744469298268795`*^9, 3.774446931766749*^9}, {
   3.7744469678548045`*^9, 3.774446970477044*^9}, {3.774611796333071*^9, 
   3.774611797258356*^9}, {3.7796924473150253`*^9, 3.779692453050643*^9}, 
   3.780215531503146*^9, 3.780382479586218*^9, {3.780509265754219*^9, 
   3.780509266842104*^9}, {3.780509521798291*^9, 3.780509522609282*^9}, {
   3.780509747422818*^9, 3.7805097889141827`*^9}, {3.78050985529541*^9, 
   3.780509882808784*^9}, {3.7805099699444304`*^9, 3.780510014333012*^9}, {
   3.7805102174831676`*^9, 3.7805102228279953`*^9}, {3.780510294634737*^9, 
   3.780510315332267*^9}, {3.7805104095902042`*^9, 3.78051042436419*^9}, {
   3.780510461224668*^9, 3.780510474275716*^9}, {3.780510740588191*^9, 
   3.780510893839368*^9}, {3.780510927898827*^9, 3.78051095252369*^9}, 
   3.78051159354841*^9, {3.780511670145547*^9, 3.780511721886586*^9}, {
   3.7805965132112703`*^9, 3.7805965603059464`*^9}, {3.7805966321262197`*^9, 
   3.78059666311235*^9}, {3.780596717569695*^9, 3.7805967959992123`*^9}, {
   3.780597031822158*^9, 3.780597239880027*^9}, 3.780597271544785*^9, {
   3.780597622599107*^9, 3.780597648458366*^9}, {3.780597707966721*^9, 
   3.7805978573841867`*^9}, {3.7805979157093563`*^9, 3.780597965106659*^9}, {
   3.780598018874263*^9, 3.7805980220039597`*^9}, {3.780599635767486*^9, 
   3.780599651933655*^9}, {3.780599760134016*^9, 3.7805997617618*^9}, {
   3.7805997993420067`*^9, 3.78059980358151*^9}, {3.780599960286664*^9, 
   3.780599967524186*^9}, {3.780600249948081*^9, 3.780600257347498*^9}, 
   3.780602431874395*^9, {3.780602743093939*^9, 3.7806027466100283`*^9}, 
   3.7806410393919153`*^9, {3.780900032213122*^9, 3.780900038943071*^9}, {
   3.7809326098393307`*^9, 3.780932610257308*^9}, {3.781512326152816*^9, 
   3.78151233488653*^9}, {3.781512546124605*^9, 3.781512564270276*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"8a0cf1f1-d58f-4636-bd4b-8310875eff9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EigOpPerturbative", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eEner_", ",", "eVec_"}], "}"}], ",", "\[CapitalDelta]_", ",", 
     "J_"}], "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"Length", "[", "eEner", "]"}], "-", "1"}]}], ",", 
       "\[IndentingNewLine]", "SigmaMinusChain", ",", "\[IndentingNewLine]", 
       "InnerMatrices", ",", "\[IndentingNewLine]", "EigOps", ",", 
       "\[IndentingNewLine]", "\[Sigma]mblocks", ",", "\[IndentingNewLine]", 
       "Pr", ",", "Mr", ",", "\[IndentingNewLine]", "\[Epsilon]v", ",", 
       "\[Sigma]M", ",", "\[Sigma]P", ",", "InnerRules", ",", 
       "\[IndentingNewLine]", "Operator", ",", "OperatorList", ",", "MatElem",
        ",", "ZeroOrderRules", ",", "FirstOrderRules", ",", 
       "\[IndentingNewLine]", "CurrMatElem", ",", "OuterFirstOrderRules", ",",
        "OuterSum", ",", "\[IndentingNewLine]", "CurrMatElemZero", ",", 
       "CurrMatElemFirst", ",", "U"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Sigma]mblocks", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"MinusBlocks", "[", 
          RowBox[{"n", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"InnerMatrices", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"EigVecBra", "[", "r", "]"}], ".", 
           SubscriptBox["\[Sigma]m", "i"], ".", 
           RowBox[{"EigVecKet", "[", "rp", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"rp", ",", "0", ",", "n"}], "}"}]}], "]"}], "//", 
        "TensorExpand"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"EigOps", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rp", "\[Equal]", 
            RowBox[{"r", "+", "1"}]}], ",", 
           RowBox[{
            RowBox[{"EigOpFirst", "[", 
             RowBox[{
              RowBox[{"r", "-", "1"}], ",", 
              RowBox[{"rp", "-", "1"}]}], "]"}], "+", 
            RowBox[{"EigOpZero", "[", 
             RowBox[{
              RowBox[{"r", "-", "1"}], ",", 
              RowBox[{"rp", "-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"rp", "\[Equal]", 
            RowBox[{"r", "+", "3"}]}], ",", 
           RowBox[{"EigOpZero", "[", 
            RowBox[{
             RowBox[{"r", "-", "1"}], ",", 
             RowBox[{"rp", "-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"rp", "\[Equal]", 
            RowBox[{"r", "-", "1"}]}], ",", 
           RowBox[{"EigOpZero", "[", 
            RowBox[{
             RowBox[{"r", "-", "1"}], ",", 
             RowBox[{"rp", "-", "1"}]}], "]"}], ",", "\n", "              ", 
           "True", ",", "0"}], "\n", "\t", "]"}], ",", "\n", "\t", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", 
           RowBox[{"n", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"rp", ",", "1", ",", 
           RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "All", " ", "those", " ", "matrix", " ", "elements", " ", "that", " ", 
        "are", " ", "zero", " ", "to", " ", "first", " ", "order", " ", "are",
         " ", 
        RowBox[{"removed", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"InnerMatrices", "=", 
       RowBox[{"InnerMatrices", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["A_", "q_"], ".", 
           SubscriptBox["\[Sigma]m", "i"], ".", 
           SubscriptBox["B_", "p_"]}], "\[RuleDelayed]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"LeadingOrderQ", "[", 
              RowBox[{"A", ",", "B"}], "]"}], "&&", 
             RowBox[{"p", "\[Equal]", 
              RowBox[{"q", "+", "1"}]}]}], ",", 
            RowBox[{
             SubscriptBox["A", "q"], ".", 
             SubscriptBox["\[Sigma]m", "i"], ".", 
             SubscriptBox["B", "p"]}], ",", "0"}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Pr", ",", "Mr"}], "}"}], "=", 
       RowBox[{"PertVects", "[", 
        RowBox[{"{", 
         RowBox[{"eEner", ",", "eVec"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"OperatorList", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ZeroOrderRules", "=", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Epsilon]T", "r_"], ".", 
            SubscriptBox["\[Sigma]m", "i"], ".", 
            SubscriptBox["\[Epsilon]", "s_"]}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"eVec", "\[LeftDoubleBracket]", 
             RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}], ".", 
            RowBox[{"\[Sigma]mblock", "\[LeftDoubleBracket]", 
             RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}], ".", 
            RowBox[{
             RowBox[{"eVec", "\[LeftDoubleBracket]", 
              RowBox[{"s", "+", "1"}], "\[RightDoubleBracket]"}], 
             "\[Transpose]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"FirstOrderRules", "=", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["\[Epsilon]T", "r_"], ".", 
              SubscriptBox["\[Sigma]m", "i"], ".", 
              SubscriptBox["P", "s_"]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"eVec", "\[LeftDoubleBracket]", 
               RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}], ".", 
              RowBox[{"\[Sigma]mblock", "\[LeftDoubleBracket]", 
               RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}], ".", 
              RowBox[{
               RowBox[{"Pr", "\[LeftDoubleBracket]", 
                RowBox[{"s", "+", "1"}], "\[RightDoubleBracket]"}], 
               "\[Transpose]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Epsilon]T", "r_"], ".", 
              SubscriptBox["\[Sigma]m", "i"], ".", 
              SubscriptBox["M", "s_"]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"eVec", "\[LeftDoubleBracket]", 
               RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}], ".", 
              RowBox[{"\[Sigma]mblock", "\[LeftDoubleBracket]", 
               RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}], ".", 
              RowBox[{
               RowBox[{"Mr", "\[LeftDoubleBracket]", 
                RowBox[{"s", "+", "1"}], "\[RightDoubleBracket]"}], 
               "\[Transpose]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["MT", "r_"], ".", 
              SubscriptBox["\[Sigma]m", "i"], ".", 
              SubscriptBox["\[Epsilon]", "s_"]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"Mr", "\[LeftDoubleBracket]", 
               RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}], ".", 
              RowBox[{"\[Sigma]mblock", "\[LeftDoubleBracket]", 
               RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}], ".", 
              RowBox[{
               RowBox[{"eVec", "\[LeftDoubleBracket]", 
                RowBox[{"s", "+", "1"}], "\[RightDoubleBracket]"}], 
               "\[Transpose]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["PT", "r_"], ".", 
              SubscriptBox["\[Sigma]m", "i"], ".", 
              SubscriptBox["\[Epsilon]", "s_"]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"Pr", "\[LeftDoubleBracket]", 
               RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}], ".", 
              RowBox[{"\[Sigma]mblock", "\[LeftDoubleBracket]", 
               RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}], ".", 
              RowBox[{
               RowBox[{"eVec", "\[LeftDoubleBracket]", 
                RowBox[{"s", "+", "1"}], "\[RightDoubleBracket]"}], 
               "\[Transpose]"}]}]}]}], "\[IndentingNewLine]", "}"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OuterSum", "[", "0", "]"}], "=", "0."}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OuterSum", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["P", "r_"], "\[Wedge]", 
             SubscriptBox["\[Epsilon]T", "s_"]}], ",", "eEnR_", ",", "eEnS_", 
            ",", "MatElem_"}], "]"}], ":=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"J", "[", 
              RowBox[{
               RowBox[{
               "eEnR", "\[LeftDoubleBracket]", "ir", 
                "\[RightDoubleBracket]"}], "-", 
               RowBox[{
               "eEnS", "\[LeftDoubleBracket]", "is", 
                "\[RightDoubleBracket]"}]}], "]"}], "*", 
             RowBox[{"MatElem", "\[LeftDoubleBracket]", 
              RowBox[{"ir", ",", "is"}], "\[RightDoubleBracket]"}], "*", 
             RowBox[{"SparseArray", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Band", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"n", ",", "r"}], "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"n", ",", "s"}], "]"}]}], "}"}], "]"}], "\[Rule]", 
                 RowBox[{"Outer", "[", 
                  RowBox[{"Times", ",", 
                   RowBox[{"Pr", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "ir"}], 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"eVec", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "is"}], 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"2", "^", "n"}], ",", 
                 RowBox[{"2", "^", "n"}]}], "}"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ir", ",", "1", ",", 
              RowBox[{"Binomial", "[", 
               RowBox[{"n", ",", 
                RowBox[{"r", "-", "2"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"is", ",", "1", ",", 
              RowBox[{"Binomial", "[", 
               RowBox[{"n", ",", "s"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OuterSum", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["M", "r_"], "\[Wedge]", 
             SubscriptBox["\[Epsilon]T", "s_"]}], ",", "eEnR_", ",", "eEnS_", 
            ",", "MatElem_"}], "]"}], ":=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"J", "[", 
              RowBox[{
               RowBox[{
               "eEnR", "\[LeftDoubleBracket]", "ir", 
                "\[RightDoubleBracket]"}], "-", 
               RowBox[{
               "eEnS", "\[LeftDoubleBracket]", "is", 
                "\[RightDoubleBracket]"}]}], "]"}], "*", 
             RowBox[{"MatElem", "\[LeftDoubleBracket]", 
              RowBox[{"ir", ",", "is"}], "\[RightDoubleBracket]"}], "*", 
             RowBox[{"SparseArray", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Band", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"n", ",", "r"}], "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"n", ",", "s"}], "]"}]}], "}"}], "]"}], "\[Rule]", 
                 RowBox[{"Outer", "[", 
                  RowBox[{"Times", ",", 
                   RowBox[{"Mr", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "ir"}], 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"eVec", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "is"}], 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"2", "^", "n"}], ",", 
                 RowBox[{"2", "^", "n"}]}], "}"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ir", ",", "1", ",", 
              RowBox[{"Binomial", "[", 
               RowBox[{"n", ",", 
                RowBox[{"r", "+", "2"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"is", ",", "1", ",", 
              RowBox[{"Binomial", "[", 
               RowBox[{"n", ",", "s"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OuterSum", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Epsilon]", "r_"], "\[Wedge]", 
             SubscriptBox["PT", "s_"]}], ",", "eEnR_", ",", "eEnS_", ",", 
            "MatElem_"}], "]"}], ":=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"J", "[", 
              RowBox[{
               RowBox[{
               "eEnR", "\[LeftDoubleBracket]", "ir", 
                "\[RightDoubleBracket]"}], "-", 
               RowBox[{
               "eEnS", "\[LeftDoubleBracket]", "is", 
                "\[RightDoubleBracket]"}]}], "]"}], "*", 
             RowBox[{"MatElem", "\[LeftDoubleBracket]", 
              RowBox[{"ir", ",", "is"}], "\[RightDoubleBracket]"}], "*", 
             RowBox[{"SparseArray", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Band", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"n", ",", "r"}], "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"n", ",", "s"}], "]"}]}], "}"}], "]"}], "\[Rule]", 
                 RowBox[{"Outer", "[", 
                  RowBox[{"Times", ",", 
                   RowBox[{"eVec", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "ir"}], 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"Pr", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "is"}], 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"2", "^", "n"}], ",", 
                 RowBox[{"2", "^", "n"}]}], "}"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ir", ",", "1", ",", 
              RowBox[{"Binomial", "[", 
               RowBox[{"n", ",", "r"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"is", ",", "1", ",", 
              RowBox[{"Binomial", "[", 
               RowBox[{"n", ",", 
                RowBox[{"s", "-", "2"}]}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OuterSum", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Epsilon]", "r_"], "\[Wedge]", 
             SubscriptBox["MT", "s_"]}], ",", "eEnR_", ",", "eEnS_", ",", 
            "MatElem_"}], "]"}], ":=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"J", "[", 
              RowBox[{
               RowBox[{
               "eEnR", "\[LeftDoubleBracket]", "ir", 
                "\[RightDoubleBracket]"}], "-", 
               RowBox[{
               "eEnS", "\[LeftDoubleBracket]", "is", 
                "\[RightDoubleBracket]"}]}], "]"}], "*", 
             RowBox[{"MatElem", "\[LeftDoubleBracket]", 
              RowBox[{"ir", ",", "is"}], "\[RightDoubleBracket]"}], "*", 
             RowBox[{"SparseArray", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Band", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"n", ",", "r"}], "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"n", ",", "s"}], "]"}]}], "}"}], "]"}], "\[Rule]", 
                 RowBox[{"Outer", "[", 
                  RowBox[{"Times", ",", 
                   RowBox[{"eVec", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "ir"}], 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"Mr", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "is"}], 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"2", "^", "n"}], ",", 
                 RowBox[{"2", "^", "n"}]}], "}"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ir", ",", "1", ",", 
              RowBox[{"Binomial", "[", 
               RowBox[{"n", ",", "r"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"is", ",", "1", ",", 
              RowBox[{"Binomial", "[", 
               RowBox[{"n", ",", 
                RowBox[{"s", "+", "2"}]}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Operator", "=", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["2", "n"], ",", 
              SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}], ";", " ", 
         RowBox[{"SetSharedVariable", "[", "Operator", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"MatElem", "=", 
             RowBox[{"InnerMatrices", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"r", "+", "1"}], ",", 
               RowBox[{"s", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MatElem", "\[Equal]", "0"}], ",", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"CurrMatElemZero", "=", 
             RowBox[{"MatElem", "/.", "ZeroOrderRules"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"CurrMatElemFirst", "=", 
             RowBox[{"MatElem", "/.", "FirstOrderRules"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"FirstOrderQ", "[", "MatElem", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Operator", "+=", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"J", "[", 
                    RowBox[{
                    RowBox[{"eEner", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "ir"}], 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"eEner", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "is"}], 
                    "\[RightDoubleBracket]"}]}], "]"}], "*", 
                   "\[IndentingNewLine]", 
                   RowBox[{"CurrMatElemZero", "\[LeftDoubleBracket]", 
                    RowBox[{"ir", ",", "is"}], "\[RightDoubleBracket]"}], "*", 
                   RowBox[{"SparseArray", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Band", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"n", ",", "r"}], "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"n", ",", "s"}], "]"}]}], "}"}], "]"}], "\[Rule]", 
                    RowBox[{"Outer", "[", 
                    RowBox[{"Times", ",", 
                    RowBox[{"eVec", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "ir"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"eVec", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "is"}], 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "n"], ",", 
                    SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"ir", ",", "1", ",", 
                    RowBox[{"Binomial", "[", 
                    RowBox[{"n", ",", "r"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"is", ",", "1", ",", 
                    RowBox[{"Binomial", "[", 
                    RowBox[{"n", ",", "s"}], "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Operator", "+=", 
                  RowBox[{"\[CapitalDelta]", " ", 
                   RowBox[{"OuterSum", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"eEner", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"eEner", "\[LeftDoubleBracket]", 
                    RowBox[{"s", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"MatElem", "/.", "ZeroOrderRules"}]}], "]"}]}]}], 
                 "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"EigOps", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"s", "+", "1"}]}], "\[RightDoubleBracket]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Epsilon]", "r"], "\[Wedge]", 
                    SubscriptBox["\[Epsilon]T", "s"]}], "\[Rule]", "0"}], 
                   "}"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Operator", "+=", 
             RowBox[{"\[CapitalDelta]", " ", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"J", "[", 
                  RowBox[{
                   RowBox[{"eEner", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "ir"}], 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{"eEner", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "is"}], 
                    "\[RightDoubleBracket]"}]}], "]"}], "*", 
                 "\[IndentingNewLine]", 
                 RowBox[{"CurrMatElemFirst", "\[LeftDoubleBracket]", 
                  RowBox[{"ir", ",", "is"}], "\[RightDoubleBracket]"}], "*", 
                 RowBox[{"SparseArray", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Band", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"n", ",", "r"}], "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{"n", ",", "s"}], "]"}]}], "}"}], "]"}], "\[Rule]", 
                    RowBox[{"Outer", "[", 
                    RowBox[{"Times", ",", 
                    RowBox[{"eVec", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "ir"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"eVec", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "is"}], 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["2", "n"], ",", 
                    SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"ir", ",", "1", ",", 
                  RowBox[{"Binomial", "[", 
                   RowBox[{"n", ",", "r"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"is", ",", "1", ",", 
                  RowBox[{"Binomial", "[", 
                   RowBox[{"n", ",", "s"}], "]"}]}], "}"}]}], 
               "\[IndentingNewLine]", "]"}]}]}], ";"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"r", ",", "0", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "0", ",", "n"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"OperatorList", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"OperatorList", ",", "Operator"}], "]"}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]mblock", ",", " ", "\[Sigma]mblocks"}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"U", "=", 
       RowBox[{"TotalSpinBasis", "[", "n", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"U", "\[Transpose]"}], ".", "#", ".", "U"}], "&"}], "/@", 
        "OperatorList"}], "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.78021319069783*^9, 3.7802132409075203`*^9}, {
   3.780213287295403*^9, 3.780213333834218*^9}, {3.78021373926357*^9, 
   3.78021379608197*^9}, {3.780213907123601*^9, 3.78021393886967*^9}, {
   3.780214026660863*^9, 3.780214026752551*^9}, {3.780214059303409*^9, 
   3.780214072489406*^9}, {3.780214113259005*^9, 3.780214304588482*^9}, {
   3.780214355961204*^9, 3.780214356163302*^9}, {3.780214393478994*^9, 
   3.78021447096806*^9}, {3.780214501573617*^9, 3.780214573883288*^9}, {
   3.780214625549904*^9, 3.780214649295231*^9}, {3.78021469060419*^9, 
   3.780214732586936*^9}, {3.7802147877025337`*^9, 3.780214850855308*^9}, {
   3.780215355673191*^9, 3.7802154129739847`*^9}, {3.78021545129909*^9, 
   3.780215502378845*^9}, {3.780215575979739*^9, 3.780215626848527*^9}, {
   3.78021566929526*^9, 3.780215690181882*^9}, {3.780215831410531*^9, 
   3.780215855875222*^9}, {3.78022131898864*^9, 3.7802213195774918`*^9}, {
   3.780221708780778*^9, 3.7802217527562*^9}, 3.78022179886749*^9, {
   3.78022183256493*^9, 3.780221834202196*^9}, {3.780222192102891*^9, 
   3.7802222604289913`*^9}, {3.7802226616751328`*^9, 3.780222728165207*^9}, {
   3.780222783940547*^9, 3.780222785370083*^9}, 3.780222890965802*^9, {
   3.780222922954608*^9, 3.780222926198011*^9}, {3.7802231908194942`*^9, 
   3.780223193240239*^9}, {3.7802233241233053`*^9, 3.780223332705924*^9}, {
   3.780223633379076*^9, 3.780223640946265*^9}, {3.780223799981432*^9, 
   3.780223818070314*^9}, {3.780223886670465*^9, 3.7802239587405863`*^9}, {
   3.78022514399378*^9, 3.7802251937731533`*^9}, {3.7802252779380207`*^9, 
   3.780225396505879*^9}, {3.7802286365424747`*^9, 3.78022863752221*^9}, {
   3.7802343561049957`*^9, 3.780234377892128*^9}, 3.780234412898037*^9, {
   3.780245368961182*^9, 3.780245373056418*^9}, {3.7802455870871897`*^9, 
   3.780245615373651*^9}, {3.7802463265833597`*^9, 3.780246327473434*^9}, 
   3.7802535657348423`*^9, {3.780292265471554*^9, 3.780292270595998*^9}, {
   3.780292681501669*^9, 3.780292682400856*^9}, {3.7802927148958893`*^9, 
   3.780292776477984*^9}, 3.7802928470480328`*^9, {3.7802929479164762`*^9, 
   3.780292952207459*^9}, {3.780293030289421*^9, 3.7802930376078444`*^9}, {
   3.780293091689954*^9, 3.780293094768516*^9}, {3.7802931439577093`*^9, 
   3.7802931459338617`*^9}, {3.780293184614929*^9, 3.7802932067090683`*^9}, {
   3.7802932468762503`*^9, 3.780293250835464*^9}, {3.78029328567523*^9, 
   3.780293293783792*^9}, {3.780293379637054*^9, 3.780293522249097*^9}, {
   3.780293598875589*^9, 3.780293628613415*^9}, {3.78029367299571*^9, 
   3.780293707889823*^9}, {3.780293748348709*^9, 3.780293756058152*^9}, {
   3.780295675320345*^9, 3.780295743256798*^9}, {3.7802958594949903`*^9, 
   3.780295892764776*^9}, 3.7802961348013897`*^9, {3.78029811539293*^9, 
   3.7802981607646837`*^9}, {3.7802982014381*^9, 3.780298212178321*^9}, {
   3.780298289281925*^9, 3.780298290042685*^9}, {3.7802983735870867`*^9, 
   3.78029838769233*^9}, {3.780298419838315*^9, 3.7802984492843657`*^9}, {
   3.780298484342807*^9, 3.78029848503975*^9}, {3.7802985918364697`*^9, 
   3.780298615165543*^9}, {3.780298741574218*^9, 3.78029874369991*^9}, {
   3.7802988228367777`*^9, 3.7802988774263372`*^9}, {3.7802989222698507`*^9, 
   3.78029897885695*^9}, 3.7802991054397087`*^9, 3.780299195266942*^9, {
   3.780299303083343*^9, 3.7802993582025957`*^9}, {3.780299473616023*^9, 
   3.780299475433288*^9}, 3.7802998117307034`*^9, {3.7803005136592216`*^9, 
   3.7803005235543213`*^9}, {3.780300585221589*^9, 3.7803006326733828`*^9}, {
   3.780300681584422*^9, 3.78030095157929*^9}, {3.780301007240341*^9, 
   3.780301049077353*^9}, {3.7803011462130632`*^9, 3.7803013811085863`*^9}, {
   3.780301439861929*^9, 3.7803014889048767`*^9}, {3.7803015410563927`*^9, 
   3.780301544817217*^9}, {3.780301617881106*^9, 3.780301629776454*^9}, {
   3.7803017034108458`*^9, 3.780301720043191*^9}, {3.780309492710792*^9, 
   3.780309499421495*^9}, {3.780309687212515*^9, 3.7803097547320023`*^9}, {
   3.780325545127383*^9, 3.780325563059408*^9}, {3.7803256004429197`*^9, 
   3.7803256046054363`*^9}, {3.78032563715834*^9, 3.7803256518751717`*^9}, {
   3.7803256843074102`*^9, 3.7803257654705544`*^9}, {3.780325949039324*^9, 
   3.7803259702853823`*^9}, {3.780328992821238*^9, 3.780329070092111*^9}, {
   3.780329164110268*^9, 3.780329203245082*^9}, {3.780341674383767*^9, 
   3.780341721884658*^9}, {3.780341762771994*^9, 3.780341786199707*^9}, {
   3.780341870569893*^9, 3.7803419716044817`*^9}, {3.780342118893841*^9, 
   3.780342199281498*^9}, 3.7803423013456306`*^9, {3.780342373349119*^9, 
   3.780342420238387*^9}, {3.780342450585737*^9, 3.780342470649433*^9}, {
   3.780342534883823*^9, 3.7803425386897297`*^9}, {3.780342578841343*^9, 
   3.780342590174041*^9}, 3.780343090048233*^9, {3.7803431395329933`*^9, 
   3.7803431630319*^9}, {3.780343198854829*^9, 3.7803431995930433`*^9}, 
   3.7803432323296223`*^9, {3.78034350781641*^9, 3.780343594504302*^9}, {
   3.780343643498723*^9, 3.780343691250792*^9}, {3.7803437229472322`*^9, 
   3.780343728159807*^9}, {3.7803437783396673`*^9, 3.780343858923109*^9}, {
   3.7803439331147127`*^9, 3.780343938610972*^9}, {3.780344283488138*^9, 
   3.780344306396985*^9}, {3.7803443367175217`*^9, 3.780344339203438*^9}, {
   3.78034441091278*^9, 3.7803444323325443`*^9}, 3.780344500858474*^9, 
   3.780382326182616*^9, {3.780382393045377*^9, 3.780382394700261*^9}, {
   3.780382508755495*^9, 3.780382607002021*^9}, {3.780382724295135*^9, 
   3.780382740078547*^9}, {3.780382868264316*^9, 3.780382873008819*^9}, 
   3.780383329733407*^9, {3.7803968415584917`*^9, 3.780396843786083*^9}, {
   3.780397407071354*^9, 3.780397438561406*^9}, {3.780397472624058*^9, 
   3.780397497284012*^9}, {3.7803976393105917`*^9, 3.7803976459506483`*^9}, {
   3.780397676025344*^9, 3.7803977611513987`*^9}, {3.7803977955344563`*^9, 
   3.780397850053192*^9}, {3.7803979213222513`*^9, 3.7803980522942047`*^9}, {
   3.780398105088908*^9, 3.780398119760324*^9}, {3.780404512064135*^9, 
   3.780404594403695*^9}, {3.780405818864719*^9, 3.7804058610830708`*^9}, {
   3.7804059005233803`*^9, 3.7804059090497007`*^9}, {3.7804059496781397`*^9, 
   3.78040596415187*^9}, {3.780406004619564*^9, 3.7804060424423733`*^9}, {
   3.780406521400588*^9, 3.780406555551488*^9}, {3.78040660428797*^9, 
   3.780406622938169*^9}, {3.780465307750411*^9, 3.780465309583138*^9}, {
   3.780488291553174*^9, 3.780488292910359*^9}, {3.7804883334881697`*^9, 
   3.780488335129265*^9}, {3.78048858213194*^9, 3.780488592842318*^9}, {
   3.7804886798359957`*^9, 3.7804886930172586`*^9}, 3.7804887362900257`*^9, {
   3.780488821410865*^9, 3.7804888481131163`*^9}, {3.780488988059884*^9, 
   3.7804890479485064`*^9}, {3.780489184639176*^9, 3.780489189040689*^9}, {
   3.780489356652432*^9, 3.780489374420714*^9}, {3.780509262511074*^9, 
   3.780509276289299*^9}, {3.780509431802649*^9, 3.780509442287693*^9}, {
   3.7805095111505537`*^9, 3.780509518656432*^9}, {3.7805095528322153`*^9, 
   3.780509637935858*^9}, {3.780509675442566*^9, 3.78050970036275*^9}, 
   3.780509743999296*^9, {3.780509888121719*^9, 3.780509927225451*^9}, 
   3.7805105170659533`*^9, {3.780511141219006*^9, 3.780511267012577*^9}, 
   3.780511316463086*^9, {3.780511349071492*^9, 3.780511350715169*^9}, 
   3.7805115717070007`*^9, {3.7805117864387207`*^9, 3.78051179933121*^9}, {
   3.780511872222473*^9, 3.780511896372563*^9}, {3.780511999783925*^9, 
   3.780512000384387*^9}, {3.780515768869606*^9, 3.780515774434924*^9}, 
   3.7805158262938967`*^9, {3.780515900375835*^9, 3.7805159017932377`*^9}, {
   3.7805159348083973`*^9, 3.780515937316455*^9}, {3.7805159914712143`*^9, 
   3.7805160266044397`*^9}, 3.7805553426945066`*^9, {3.7805556821343412`*^9, 
   3.780555684243815*^9}, 3.780555748637804*^9, 3.780556023770318*^9, {
   3.7805560874843388`*^9, 3.780556094097715*^9}, {3.780556182232197*^9, 
   3.780556248470435*^9}, {3.780556339663714*^9, 3.780556345886283*^9}, {
   3.7805564045173483`*^9, 3.780556441553522*^9}, {3.780556490990423*^9, 
   3.780556535372316*^9}, {3.780557365985498*^9, 3.780557391345644*^9}, {
   3.780557478848197*^9, 3.780557620881778*^9}, {3.78055765551408*^9, 
   3.780557698789968*^9}, 3.7805577343406773`*^9, {3.780557790167242*^9, 
   3.7805577925197477`*^9}, 3.7805631094595757`*^9, {3.780563239160606*^9, 
   3.780563248353971*^9}, {3.780563293293764*^9, 3.7805632943820057`*^9}, {
   3.780564223461876*^9, 3.7805642336235237`*^9}, 3.780582804810678*^9, {
   3.7805933799739447`*^9, 3.780593380071233*^9}, {3.780593625350726*^9, 
   3.780593741114987*^9}, {3.78059391162613*^9, 3.7805939478391542`*^9}, 
   3.780593983352787*^9, {3.7805940711345453`*^9, 3.780594141192301*^9}, {
   3.7805942913878403`*^9, 3.7805943251187572`*^9}, {3.780594415615057*^9, 
   3.7805944687949057`*^9}, 3.780594559171916*^9, {3.780594668796673*^9, 
   3.780594679847128*^9}, {3.780594744400857*^9, 3.7805947682092657`*^9}, {
   3.780594820231902*^9, 3.7805948208257437`*^9}, {3.7805948842269983`*^9, 
   3.7805948847434187`*^9}, 3.7805949764183407`*^9, {3.7805950612927217`*^9, 
   3.7805951051283693`*^9}, {3.78059516200368*^9, 3.78059516434862*^9}, {
   3.780595196169594*^9, 3.780595310587263*^9}, {3.78059551025699*^9, 
   3.7805955399699173`*^9}, 3.78059557422482*^9, {3.780595758045616*^9, 
   3.780595776601779*^9}, {3.78059591096309*^9, 3.780595946917795*^9}, {
   3.7805959810040617`*^9, 3.7805960864386873`*^9}, {3.7805986503670387`*^9, 
   3.780598673690774*^9}, {3.78059981407882*^9, 3.780599824697947*^9}, {
   3.7806000385698643`*^9, 3.780600062374386*^9}, {3.780600373517061*^9, 
   3.7806004143544397`*^9}, {3.7806004828539467`*^9, 3.780600484626897*^9}, {
   3.780600873988811*^9, 3.780600875618178*^9}, {3.780600992946567*^9, 
   3.780600994886588*^9}, {3.780601102045266*^9, 3.780601102967517*^9}, {
   3.780601133451974*^9, 3.780601157257317*^9}, {3.78060119500086*^9, 
   3.7806012353782053`*^9}, 3.780601285190174*^9, 3.780601330563251*^9, {
   3.7806015177087917`*^9, 3.7806015915716877`*^9}, {3.780601635041298*^9, 
   3.78060164032452*^9}, {3.780601917932291*^9, 3.780601947192561*^9}, {
   3.780602080575055*^9, 3.780602093642061*^9}, {3.780602161685895*^9, 
   3.780602184504792*^9}, 3.780602249941785*^9, {3.7806023743719273`*^9, 
   3.780602375709406*^9}, {3.780602513159452*^9, 3.780602517245661*^9}, {
   3.780602554273816*^9, 3.7806025544975777`*^9}, {3.780602596239946*^9, 
   3.7806026083539143`*^9}, {3.7806027520427322`*^9, 3.780602777915214*^9}, {
   3.780602822375355*^9, 3.780602864977805*^9}, {3.780602998017755*^9, 
   3.780603018299612*^9}, 3.780639412001031*^9, {3.780639603223627*^9, 
   3.780639626534774*^9}, {3.7806397310479403`*^9, 3.780639731634501*^9}, {
   3.7806399867616053`*^9, 3.780639989012925*^9}, {3.780640447750354*^9, 
   3.780640581579298*^9}, {3.7806406949600697`*^9, 3.780640876818481*^9}, {
   3.780640996231462*^9, 3.780640999897017*^9}, 3.780641296763857*^9, 
   3.780641516165145*^9, {3.780641604930129*^9, 3.78064160894239*^9}, {
   3.7806427468912563`*^9, 3.780642792031028*^9}, {3.780643299071206*^9, 
   3.780643302297917*^9}, {3.780643400646406*^9, 3.7806434100274878`*^9}, {
   3.780643488571479*^9, 3.780643508341861*^9}, {3.780644452763731*^9, 
   3.780644454196301*^9}, {3.780646720911079*^9, 3.78064673032484*^9}, {
   3.780646804158012*^9, 3.7806468117349377`*^9}, {3.780646853947654*^9, 
   3.780647062463736*^9}, {3.7806542981803207`*^9, 3.780654299689453*^9}, {
   3.7807347389398727`*^9, 3.780734757922872*^9}, {3.780933787914317*^9, 
   3.780933816032848*^9}, {3.780934533007592*^9, 3.780934535165902*^9}, {
   3.7809387001104507`*^9, 3.780938713822404*^9}, 3.781095382398079*^9, {
   3.7810954207729387`*^9, 3.781095515313581*^9}, {3.7810958852814407`*^9, 
   3.781095905544235*^9}, {3.781096069772983*^9, 3.7810960873612223`*^9}, 
   3.781096160061133*^9, {3.784970998258293*^9, 3.784971018249241*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"35377d4c-a3cf-4340-bdd9-34e3be7783da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlochRedfieldPert", "[", 
   RowBox[{"eSys_", ",", "Delta_", ",", "J_"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"eSys", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "//", "Length"}], ")"}], "-", 
        "1"}]}], ",", "SigmamSite", ",", 
      RowBox[{"EigOpSite", "=", 
       RowBox[{"EigOpPerturbative", "[", 
        RowBox[{"eSys", ",", "Delta", ",", "J"}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SigmamSite", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Tensor", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Piecewise", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Sigmam", ",", 
                RowBox[{"i", "\[Equal]", "j"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Id", ",", "True"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Total", "[", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"SuperLR", "[", 
          RowBox[{
           RowBox[{"EigOpSite", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"SigmamSite", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Transpose]"}]}], "]"}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"SuperLR", "[", 
          RowBox[{
           RowBox[{"SigmamSite", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"EigOpSite", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[HermitianConjugate]"}]}], 
          "]"}], "\[IndentingNewLine]", "-", 
         RowBox[{"SuperLR", "[", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"2", "^", "n"}], ",", 
              RowBox[{"2", "^", "n"}]}], "}"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"EigOpSite", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[HermitianConjugate]"}], ".", 
            RowBox[{"SigmamSite", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "\[IndentingNewLine]",
          "-", 
         RowBox[{"SuperLR", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"SigmamSite", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Transpose]"}], ".", 
            RowBox[{"EigOpSite", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"2", "^", "n"}], ",", 
              RowBox[{"2", "^", "n"}]}], "}"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7809348004394207`*^9, 3.780934800466312*^9}, {
   3.780938451547153*^9, 3.7809385060226917`*^9}, {3.784190963494092*^9, 
   3.784190973374778*^9}, 3.7841913018494663`*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"f8ba7f8d-bd25-4920-b694-f3e29b049bd3"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Observations regarding ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "SS"], TraditionalForm]],ExpressionUUID->
  "b8f292b3-34d8-42d3-8751-cb31a6f99d61"]
}], "Subsection",
 CellChangeTimes->{{3.780932402641176*^9, 
  3.780932414299593*^9}},ExpressionUUID->"6dbd48af-73cc-4617-b406-\
5501773b2862"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ss", "[", 
    RowBox[{
    "nn_", ",", "g_", ",", "\[CapitalDelta]_", ",", "J_", ",", "option_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myH", ",", "eigS", ",", "SPspec", ",", "SPbndwid", ",", 
       "my\[ScriptCapitalD]", ",", "my\[ScriptCapitalL]", ",", "\[Rho]out", 
       ",", "eval"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myH", "=", 
       RowBox[{"HAnIsoXY", "[", 
        RowBox[{"nn", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eigS", "=", 
       RowBox[{"Eigensystem", "[", "myH", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"option", "\[Equal]", "\"\<BruteForce\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"my\[ScriptCapitalD]", "=", 
         RowBox[{"BlochRedfieldBrute", "[", 
          RowBox[{
           RowBox[{"Eigensystem", "[", "myH", "]"}], ",", "J"}], "]"}]}], ",",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"option", "\[Equal]", "\"\<UnperturbedDissipator\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"my\[ScriptCapitalD]", "=", 
         RowBox[{"BlochRedfieldZero\[CapitalDelta]", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Eigensystem", "/@", 
              RowBox[{"H0Blocks", "[", 
               RowBox[{"nn", ",", "g"}], "]"}]}], ")"}], "\[Transpose]"}], 
           ",", "J"}], "]"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"option", "\[Equal]", "\"\<Perturbative\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"my\[ScriptCapitalD]", "=", 
         RowBox[{"BlochRedfieldPert", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Eigensystem", "/@", 
              RowBox[{"H0Blocks", "[", 
               RowBox[{"nn", ",", "g"}], "]"}]}], ")"}], "\[Transpose]"}], 
           ",", "\[CapitalDelta]", ",", "J"}], "]"}]}], " ", ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"option", "\[Equal]", "\"\<Lindblad\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"my\[ScriptCapitalD]", "=", 
         RowBox[{"J", " ", 
          RowBox[{"Total", "[", 
           RowBox[{"Lindblad", "/@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Tensor", "@@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Piecewise", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Sigmam", ",", 
                    RowBox[{"i", "\[Equal]", "j"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Id", ",", "True"}], "}"}]}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "nn"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "nn"}], "}"}]}], "]"}]}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        OverscriptBox["\[Rho]", "."], " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[ImaginaryI]", "[", 
            RowBox[{"H", ",", " ", "\[Rho]"}], "]"}]}], " ", "+", " ", 
          "\[ScriptCapitalD]\[Rho]"}], " ", "..."}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"my\[ScriptCapitalL]", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"SuperComm", "[", "myH", "]"}]}], "+", 
        "my\[ScriptCapitalD]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nn", "\[LessEqual]", "6"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"eval", ",", "\[Rho]out"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Eigensystem", "[", 
            RowBox[{
             RowBox[{"my\[ScriptCapitalL]", "//", "Threshold"}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"Method", "\[Rule]", 
              RowBox[{"{", "\"\<Arnoldi\>\"", "}"}]}]}], "]"}], 
           "\[Transpose]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"eval", ",", "\[Rho]out"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Eigensystem", "[", 
            RowBox[{
             RowBox[{"my\[ScriptCapitalL]", "//", "Threshold"}], ",", "1", 
             ",", 
             RowBox[{"Method", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Arnoldi\>\"", ",", 
                RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "30000"}], ",", 
                RowBox[{"\"\<Criteria\>\"", "\[Rule]", "\"\<RealPart\>\""}]}],
                "}"}]}]}], "]"}], "\[Transpose]"}], "\[LeftDoubleBracket]", 
          "1", "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]out", "=", 
       RowBox[{"toHilbert", "[", "\[Rho]out", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Checking that state is steady. Norm[\[ScriptCapitalL] \[Rho]] = \
\>\"", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"my\[ScriptCapitalL]", ".", 
             RowBox[{"Vectorise", "[", "\[Rho]out", "]"}]}], ")"}], "//", 
           "Norm"}], ",", "\"\< | Found Eigenvalue = \>\"", ",", "eval"}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"\[Rho]out", "/", 
        RowBox[{"Tr", "[", "\[Rho]out", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7531948552308617`*^9, 3.753194884921897*^9}, {
   3.753195024299632*^9, 3.7531950319076033`*^9}, 3.753195635256135*^9, {
   3.753195719188428*^9, 3.753195731935561*^9}, {3.753196628175289*^9, 
   3.7531966443067083`*^9}, 3.753196771617518*^9, 3.753197916519184*^9, 
   3.753198012986847*^9, {3.753198620193124*^9, 3.7531986496277313`*^9}, {
   3.753198681287228*^9, 3.753198686867028*^9}, {3.753198728294704*^9, 
   3.7531987293546247`*^9}, {3.753198823969431*^9, 3.753198825371895*^9}, {
   3.753198912511096*^9, 3.753198956387532*^9}, {3.7531989883094263`*^9, 
   3.753198992680778*^9}, {3.753199033254727*^9, 3.7531990335695467`*^9}, {
   3.753199085239078*^9, 3.753199106281451*^9}, {3.7531998547162523`*^9, 
   3.7531998607563953`*^9}, {3.753208193640674*^9, 3.75320819417183*^9}, {
   3.7532559412188168`*^9, 3.753255991084147*^9}, 3.753257288733617*^9, {
   3.7532573340128*^9, 3.753257338952971*^9}, 3.75325807369727*^9, {
   3.753258295584123*^9, 3.7532585879391856`*^9}, {3.7532606597268405`*^9, 
   3.7532606616207495`*^9}, {3.75328991584536*^9, 3.7532899441699796`*^9}, {
   3.7532900887097445`*^9, 3.7532901239504375`*^9}, {3.7532902350602107`*^9, 
   3.7532902785166655`*^9}, {3.7532903686492023`*^9, 3.753290368801157*^9}, {
   3.7532904078357363`*^9, 3.7532904576034813`*^9}, {3.753299241050955*^9, 
   3.7532992493083105`*^9}, {3.7532995997930365`*^9, 
   3.7532997197481666`*^9}, {3.753299803228671*^9, 3.7532998067866235`*^9}, 
   3.753299895011348*^9, {3.753300019119731*^9, 3.7533000503927*^9}, {
   3.753300258600078*^9, 3.7533002595955048`*^9}, {3.7533007665546317`*^9, 
   3.7533008705956573`*^9}, 3.7533020037039804`*^9, {3.753303067856969*^9, 
   3.7533030695729694`*^9}, 3.7533032079792166`*^9, 3.7533037278461986`*^9, {
   3.7533039185762877`*^9, 3.753303936483726*^9}, 3.7533048802315507`*^9, {
   3.7533051490923023`*^9, 3.753305152693225*^9}, {3.7533057316089287`*^9, 
   3.7533057321416197`*^9}, {3.7533497134590983`*^9, 3.753349720358121*^9}, {
   3.753350236134912*^9, 3.7533502450107965`*^9}, {3.7535189392775717`*^9, 
   3.753519132593301*^9}, {3.753620547572834*^9, 3.753620583091125*^9}, {
   3.7689101822900753`*^9, 3.768910283412747*^9}, {3.768911273629952*^9, 
   3.768911279725996*^9}, {3.768911369169817*^9, 3.768911418511404*^9}, {
   3.768911457527479*^9, 3.768911490431506*^9}, {3.768911596840716*^9, 
   3.768911604495344*^9}, {3.778489324457468*^9, 3.778489324903825*^9}, {
   3.7785777988726673`*^9, 3.7785778378037453`*^9}, {3.778577915029891*^9, 
   3.7785779274291897`*^9}, {3.778578036114554*^9, 3.778578092935842*^9}, {
   3.778578212582349*^9, 3.778578285262322*^9}, {3.77857833991553*^9, 
   3.778578344638527*^9}, {3.7785786438250303`*^9, 3.7785786498575983`*^9}, {
   3.778590582271921*^9, 3.778590603830577*^9}, 3.778590662156599*^9, {
   3.778590699179377*^9, 3.7785907043049583`*^9}, {3.780934331573818*^9, 
   3.7809343334209146`*^9}, {3.780934648497374*^9, 3.780934649042862*^9}, {
   3.780934849187975*^9, 3.78093484990479*^9}, 3.780935016649173*^9, 
   3.780935229780479*^9, {3.780937871940544*^9, 3.780937873853718*^9}, {
   3.7809379117712307`*^9, 3.780938046536126*^9}, {3.780938083839223*^9, 
   3.7809380870318117`*^9}, {3.78093821363945*^9, 3.780938224248314*^9}, 
   3.780938735483781*^9, {3.780985103537112*^9, 3.780985139336422*^9}, 
   3.781177594639845*^9, {3.78202448911166*^9, 3.782024504239588*^9}, {
   3.78202512336487*^9, 3.7820251332094603`*^9}, {3.7820491382323427`*^9, 
   3.7820491501632357`*^9}, {3.782049310776854*^9, 3.782049330059617*^9}, {
   3.782049442032072*^9, 3.782049453817854*^9}, {3.782147702486734*^9, 
   3.782147727767202*^9}, {3.782147769286976*^9, 3.782147785445634*^9}, {
   3.782148146828609*^9, 3.782148185906864*^9}, 3.782148321228853*^9, {
   3.7821492916096478`*^9, 3.78214931601217*^9}, {3.7821495228827333`*^9, 
   3.782149534442893*^9}, {3.782149711310609*^9, 3.7821497417364683`*^9}, {
   3.782150725371636*^9, 3.78215077393392*^9}, {3.782152010864056*^9, 
   3.7821520125037518`*^9}, 3.782152220092352*^9, {3.782152654448464*^9, 
   3.782152747830205*^9}, {3.782155007855364*^9, 3.782155100691915*^9}, 
   3.78215519496891*^9, {3.782155455893029*^9, 3.7821554562719727`*^9}, {
   3.782155524080783*^9, 3.782155525790783*^9}, {3.782155874805791*^9, 
   3.782155960500332*^9}, {3.782155998303278*^9, 3.782156113447439*^9}, {
   3.782156710364851*^9, 3.782156771305827*^9}, {3.78215683093887*^9, 
   3.7821568312196608`*^9}, {3.782157052033327*^9, 3.782157061316708*^9}, {
   3.782158740796371*^9, 3.7821587528247633`*^9}, 3.7821588750480824`*^9, {
   3.782158936541367*^9, 3.782158951195097*^9}, {3.782159134160522*^9, 
   3.782159153694214*^9}, 3.782159274683919*^9, 3.7821593324021797`*^9, {
   3.782159429633687*^9, 3.782159441514268*^9}, {3.783165674800481*^9, 
   3.7831656846650677`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"2911c71d-9210-4f5f-96b6-ebd1bb13b76d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SxSxCorrelations", "[", "\[Rho]_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"SigmaxSite", ",", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Log", "[", 
        RowBox[{"2", ",", 
         RowBox[{"\[Rho]", "//", "Length"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SigmaxSite", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Tensor", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Piecewise", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Sigmax", ",", 
                RowBox[{"i", "\[Equal]", "j"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Id", ",", "True"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Expect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "SigmaxSite", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ".", 
           RowBox[{
           "SigmaxSite", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], ",", "\[Rho]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7532993760980897`*^9, 3.7532995828677907`*^9}, {
   3.753299760770069*^9, 3.753299783627406*^9}, 3.753300119000405*^9, {
   3.753301523915452*^9, 3.753301527170577*^9}, {3.75330170390174*^9, 
   3.7533017205071793`*^9}, {3.7533031432695036`*^9, 3.7533031438441815`*^9}, 
   3.7533034852579947`*^9, {3.753519447789914*^9, 3.753519466267209*^9}, 
   3.753534462307106*^9, 3.778523936276245*^9, {3.780579538249015*^9, 
   3.780579538732872*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"e42d8cd5-bfff-4432-8ef2-52036a94a0e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SxSxDualityPlot", "[", "rhossDualityList_", "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Log", "[", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rhossDualityList", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], "//",
              "Dimensions"}], ")"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], "]"}]}], ",", "SxSxCorrList"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SxSxCorrList", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"SxSxCorrelations", ",", "rhossDualityList", ",", 
         RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"SxSxCorrList", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i", ",", "j"}], "\[RightDoubleBracket]"}], 
             "//", "Re"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"AxesLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<i\>\"", ",", 
               "\"\<\!\(TraditionalForm\`\[LeftAngleBracket]\*SuperscriptBox[\
SubscriptBox[\(\[Sigma]\), \(1\)], \(x\)] \*SuperscriptBox[SubscriptBox[\(\
\[Sigma]\), \(i\)], \(x\)]\[RightAngleBracket]\)\>\""}], "}"}]}], ",", 
            RowBox[{"Ticks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", "n"}], "]"}], ",", "Automatic"}], "}"}]}], 
            ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
            RowBox[{"Mesh", "\[Rule]", "All"}], ",", 
            RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7809341711378517`*^9, 3.7809342010699053`*^9}, 
   3.7809369671539288`*^9, {3.78093770176668*^9, 3.780937717811585*^9}, {
   3.78094006161766*^9, 3.780940065581039*^9}, {3.780940102033626*^9, 
   3.780940104708323*^9}, {3.78214691757012*^9, 3.782146918029105*^9}, {
   3.7821486382489443`*^9, 3.782148641689196*^9}, {3.7821486763767138`*^9, 
   3.782148811725297*^9}, {3.7821488669372053`*^9, 3.782148869625451*^9}, {
   3.78214897779373*^9, 3.782148980999876*^9}, {3.782154510113709*^9, 
   3.782154521885166*^9}, {3.782156326525003*^9, 3.782156350528618*^9}, {
   3.782760160462749*^9, 3.782760175119253*^9}, {3.782980656183414*^9, 
   3.782980669878887*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"896c8073-8d9b-4d0d-ae6a-8a4d6e7cb608"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DualityRhoSS", "[", 
   RowBox[{
   "n_", ",", "g_", ",", "\[CapitalDelta]_", ",", "Jpm_", ",", "method_"}], 
   "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"\[Rho]ss", "[", 
     RowBox[{"n", ",", 
      RowBox[{"gpm", " ", "g"}], ",", "\[CapitalDelta]", ",", 
      RowBox[{
       RowBox[{"J", "[", 
        RowBox[{"#", ",", "\[Omega]0pm"}], "]"}], "&"}], ",", "method"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"gpm", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Omega]0pm", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7821463825925083`*^9, 3.782146402771574*^9}, {
  3.782146506693643*^9, 3.782146596084301*^9}, {3.7821466800155783`*^9, 
  3.782146702668779*^9}, {3.782146775458598*^9, 3.7821467858860283`*^9}, {
  3.7821469753082333`*^9, 3.782147004937447*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"6ebc747b-e00e-457d-845d-e026dc77d950"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.785670833961478*^9, 
  3.785670835630065*^9}},ExpressionUUID->"ceeee744-247f-43cc-8c2e-\
5914e19618e0"],

Cell[CellGroupData[{

Cell[TextData[{
 "Correlation functions ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Sigma]", "i"], "x"], 
     SuperscriptBox[
      SubscriptBox["\[Sigma]", 
       RowBox[{"i", "+", "1"}]], "x"]}]}], TraditionalForm]],ExpressionUUID->
  "c08092ab-bbf2-4734-812c-4a68567f6fdf"],
 "\[RightAngleBracket] and duality with Arnoldi"
}], "Subsubsection",
 CellChangeTimes->{{3.782152064426895*^9, 3.782152111420862*^9}, {
  3.782980614429826*^9, 
  3.7829806221545763`*^9}},ExpressionUUID->"e97bbb5c-a1f4-4ce4-a28f-\
d8189499b241"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "6"}], ";", 
   RowBox[{"g", "=", "2."}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "=", 
    RowBox[{"H0Blocks", "[", 
     RowBox[{"n", ",", "g"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{
    RowBox[{"\[ScriptCapitalD]", "=", 
     RowBox[{"BlochRedfieldZero\[CapitalDelta]", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Eigensystem", "/@", "H"}], ")"}], "\[Transpose]"}], ",", 
       RowBox[{"1", "&"}]}], "]"}]}], ";"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"\[ScriptCapitalD]", "//", "Normal"}], ";"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7827223183954077`*^9, 3.782722479553298*^9}},
 CellLabel->
  "In[662]:=",ExpressionUUID->"f19aad67-850a-4e8d-8a3e-d2641b4876bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";", 
  RowBox[{"g", "=", "2."}], ";", 
  RowBox[{"\[CapitalDelta]", "=", ".05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]0", " ", "=", "5."}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"J", "[", 
    RowBox[{"w_", ",", "pm_"}], "]"}], ":=", 
   RowBox[{"Exp", "[", 
    RowBox[{"-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"w", "-", 
          RowBox[{"pm", " ", "\[Omega]0"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1.", "\[Omega]0"}], ")"}]}], ")"}], "^", "2"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.780734800802086*^9, 3.780734803798047*^9}, {
   3.7809033227927856`*^9, 3.780903329194536*^9}, {3.780903406453741*^9, 
   3.780903406929448*^9}, {3.7809172276689034`*^9, 3.780917227854027*^9}, {
   3.780933090599598*^9, 3.780933098406095*^9}, 3.7809349550517483`*^9, 
   3.780935034387147*^9, 3.780935111392322*^9, 3.7809351456027822`*^9, {
   3.780935308735344*^9, 3.780935335464348*^9}, {3.7809353686600647`*^9, 
   3.7809353878955603`*^9}, 3.780935478545561*^9, {3.780935577373745*^9, 
   3.78093559526127*^9}, {3.780935652051854*^9, 3.7809356792084007`*^9}, {
   3.780935723204611*^9, 3.780935724211331*^9}, {3.780935992040574*^9, 
   3.7809360366478453`*^9}, 3.780936727406884*^9, {3.7809378307444277`*^9, 
   3.780937831587202*^9}, {3.780938103135207*^9, 3.780938165546359*^9}, {
   3.780938813915801*^9, 3.780938866923204*^9}, {3.7809851820004673`*^9, 
   3.7809851935972357`*^9}, {3.780985230652946*^9, 3.780985244280312*^9}, {
   3.7809864838935432`*^9, 3.780986489506933*^9}, {3.780986577592587*^9, 
   3.78098658106946*^9}, 3.78101195663522*^9, {3.781011987968429*^9, 
   3.781012045371505*^9}, {3.7810128719451437`*^9, 3.781012872936488*^9}, {
   3.781012917122037*^9, 3.781012917733643*^9}, 3.781013084872511*^9, {
   3.781013129370537*^9, 3.7810131345201073`*^9}, 3.781013206601371*^9, 
   3.781013269845272*^9, {3.781015490283738*^9, 3.7810154911866503`*^9}, 
   3.78101555744597*^9, {3.78101570278878*^9, 3.781015704538477*^9}, {
   3.781015985248515*^9, 3.7810160263126297`*^9}, 3.781016230397357*^9, 
   3.78101628552756*^9, 3.7810164182733383`*^9, 3.78101652666392*^9, {
   3.7810166259292717`*^9, 3.78101663162681*^9}, 3.781016682448*^9, {
   3.781094453978011*^9, 3.781094472024515*^9}, {3.781510822795865*^9, 
   3.781510850337182*^9}, 3.781515574828932*^9, {3.7815156731609287`*^9, 
   3.781515696039394*^9}, {3.781515853901882*^9, 3.781515866403626*^9}, {
   3.7815159038443947`*^9, 3.781515919101705*^9}, 3.78151596217661*^9, {
   3.78159156983315*^9, 3.78159157129396*^9}, {3.782024349965366*^9, 
   3.782024362048718*^9}, 3.782024479298587*^9, {3.7820245412773447`*^9, 
   3.782024581641635*^9}, 3.7820246293304253`*^9, {3.7820249134444304`*^9, 
   3.7820249163786383`*^9}, 3.782024949183197*^9, 3.7820490431383467`*^9, {
   3.782049079123966*^9, 3.782049131395555*^9}, {3.7820491698320227`*^9, 
   3.7820492146893044`*^9}, {3.7820492503829203`*^9, 3.782049280753192*^9}, 
   3.782049415626333*^9, {3.782049490705174*^9, 3.782049491088394*^9}, {
   3.7820497237342863`*^9, 3.782049821796199*^9}, {3.7820499266590767`*^9, 
   3.782049930227427*^9}, {3.782049964404087*^9, 3.7820499752421513`*^9}, {
   3.7820500105567017`*^9, 3.7820500611062403`*^9}, {3.782115027043894*^9, 
   3.782115045318018*^9}, {3.782115457550482*^9, 3.7821154619238873`*^9}, 
   3.782115531383936*^9, 3.782115822347781*^9, 3.782117186276586*^9, 
   3.7821457601714983`*^9, {3.782146498682169*^9, 3.7821464989309387`*^9}, 
   3.782147291083487*^9, {3.782147920196048*^9, 3.782147926404978*^9}, {
   3.7821491434971533`*^9, 3.782149146073084*^9}, {3.782150804097971*^9, 
   3.7821508108516407`*^9}, {3.782155658342474*^9, 3.78215566018874*^9}, {
   3.7821557388484983`*^9, 3.7821557415520887`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"52412e82-bc2e-4b06-b537-88abeb28e639"],

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Lindblad", "/@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Tensor", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Sigmam", ",", 
             RowBox[{"i", "\[Equal]", "j"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Id", ",", "True"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.78215695583263*^9, 3.782156957313945*^9}},
 CellLabel->
  "In[340]:=",ExpressionUUID->"c103624e-c052-4932-83ba-eff9519f787c"],

Cell[BoxData[
 RowBox[{"DualityRhoSS", "[", 
  RowBox[{"8", ",", "g", ",", "\[CapitalDelta]", ",", 
   RowBox[{
    RowBox[{"J", "[", 
     RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
   "\"\<UnperturbedDissipator\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.782156987277547*^9, 3.7821570115695868`*^9}, 
   3.782158898525797*^9, 3.782158969318728*^9, {3.782159033589093*^9, 
   3.782159078252925*^9}, 
   3.782159651989551*^9},ExpressionUUID->"53d0a1e3-47d6-474e-b65b-\
4b96b3ec9815"],

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "\[LeftDoubleBracket]", 
   RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
  "HermitianMatrixQ"}]], "Input",
 CellChangeTimes->{{3.782157016364769*^9, 3.7821570255928097`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"176831fd-9b91-421e-a064-737d1561af08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]ssDualityListBruteN6", "=", 
   RowBox[{"DualityRhoSS", "[", 
    RowBox[{"6", ",", "g", ",", "\[CapitalDelta]", ",", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "\"\<BruteForce\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.782147013002376*^9, 3.7821470364908533`*^9}, {
   3.7821470882035837`*^9, 3.782147094879293*^9}, {3.782147136267991*^9, 
   3.782147176579576*^9}, {3.78214732675136*^9, 3.7821473831553783`*^9}, {
   3.7821474539191847`*^9, 3.782147507934355*^9}, 3.782147564978594*^9, {
   3.7821477968360643`*^9, 3.7821478280893*^9}, 3.782147999480649*^9, {
   3.782148486949944*^9, 3.782148487453311*^9}, {3.7821557502623053`*^9, 
   3.782155751751506*^9}, {3.782159635090263*^9, 
   3.782159640623673*^9}},ExpressionUUID->"812a3b04-1edd-443e-a04e-\
769b76013b70"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Eigensystem", "[", 
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{"{", 
      RowBox[{"8", ",", "8"}], "}"}], "]"}], "]"}], "\[Transpose]"}], 
  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.782155816208571*^9, 3.7821558639371023`*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"42fddb97-0062-4667-a810-604d27c980bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]ssDualityListUPDN6", "=", 
   RowBox[{"DualityRhoSS", "[", 
    RowBox[{"6", ",", "g", ",", "\[CapitalDelta]", ",", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
     "\"\<UnperturbedDissipator\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.782148356690259*^9, 3.78214838437167*^9}, {
  3.7821484824967012`*^9, 3.782148482573409*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"d6dbf29c-1a13-4281-9174-276e8d589247"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]ssDualityListPertN6", "=", 
   RowBox[{"DualityRhoSS", "[", 
    RowBox[{"6", ",", "g", ",", "\[CapitalDelta]", ",", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "\"\<Perturbative\>\""}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7821483939139357`*^9, 3.782148400414194*^9}, {
  3.782148489314814*^9, 3.78214848945914*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"b7ed23cb-bc66-44b2-ade9-b9db70790d80"],

Cell[BoxData[
 RowBox[{"SxSxDualityPlot", "[", 
  RowBox[{"{", 
   RowBox[{
   "\[Rho]ssDualityListBruteN6", ",", "\[Rho]ssDualityListUPDN6", ",", 
    "\[Rho]ssDualityListPertN6"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{
  3.782147378360661*^9, {3.7821476187312317`*^9, 3.782147624601905*^9}, {
   3.782147677559165*^9, 3.782147682526371*^9}, {3.782148290628481*^9, 
   3.782148293763949*^9}, {3.782148429891871*^9, 3.7821484338796873`*^9}, {
   3.7821485194920464`*^9, 3.7821485198327703`*^9}, {3.782149122828418*^9, 
   3.782149125298332*^9}, {3.782149156606724*^9, 3.7821491569678392`*^9}, {
   3.78215295363752*^9, 3.782152989091528*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"bbc3b5ba-e00d-4180-8200-7992fd508256"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ssDualityListUPDN7", "=", 
    RowBox[{"DualityRhoSS", "[", 
     RowBox[{"7", ",", "g", ",", "\[CapitalDelta]", ",", 
      RowBox[{
       RowBox[{"J", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
      "\"\<UnperturbedDissipator\>\""}], "]"}]}], ";"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.78214969367453*^9, 3.78214970538612*^9}, {
   3.782149755131421*^9, 3.782149779536841*^9}, 3.782149873599818*^9, {
   3.7821507923707037`*^9, 3.782150794180081*^9}, 3.782151745242118*^9, 
   3.782151949041808*^9},
 CellLabel->"In[76]:=",ExpressionUUID->"bf97fffb-7524-42b1-9c64-25c1e322a0fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ssDualityListPertN7", "=", 
    RowBox[{"DualityRhoSS", "[", 
     RowBox[{"7", ",", "g", ",", "\[CapitalDelta]", ",", 
      RowBox[{
       RowBox[{"J", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
      "\"\<Perturbative\>\""}], "]"}]}], ";"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.7821509439507437`*^9, 3.782150945850791*^9}, {
   3.782151750816143*^9, 3.7821517575980577`*^9}, 3.782151951080173*^9, {
   3.782153017481224*^9, 3.782153017638227*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"748c992e-536c-460a-b0a8-370538731559"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<Corr.png\>\"", ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Rho]ssDualityListPertN7", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
       "SxSxCorrelations"}], "//", "Re"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Mesh", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", "Thick"}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<i\>\"", ",", 
        "\"\<\!\(TraditionalForm\`\[LeftAngleBracket]\*SuperscriptBox[\
SubscriptBox[\(\[Sigma]\), \(i\)], \(x\)] \*SuperscriptBox[SubscriptBox[\(\
\[Sigma]\), \(i + 1\)], \(x\)]\[RightAngleBracket]\)\>\""}], "}"}]}]}], "]"}],
    ",", 
   RowBox[{"ImageResolution", "\[Rule]", "700"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.782151710491398*^9, {3.782154538177122*^9, 3.782154740980939*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"1efb1331-baa3-47cb-b190-d128874dbcaa"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.782156606501144*^9, 
  3.782156686069408*^9}},ExpressionUUID->"1b4c32d4-f943-4463-b7ef-\
69d3a7ddc060"],

Cell[BoxData[
 RowBox[{"SxSxDualityPlot", "[", 
  RowBox[{"{", 
   RowBox[{"\[Rho]ssDualityListUPDN7", ",", "\[Rho]ssDualityListPertN7"}], 
   "}"}], "]"}]], "Input",
 CellLabel->
  "In[120]:=",ExpressionUUID->"6d437c36-cd94-4b9f-82c4-18b199d8e490"],

Cell[BoxData[
 RowBox[{"\[Rho]ssDualityListPertN7", "\[LeftDoubleBracket]", 
  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.782154464716063*^9, 3.782154499667294*^9}, {
  3.7821549876522427`*^9, 
  3.782154993067095*^9}},ExpressionUUID->"225a72cf-f92c-40ad-98c0-\
4c23fe4513ca"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<N=7Plot.png\>\"", ",", 
   RowBox[{"SxSxDualityPlot", "[", 
    RowBox[{"{", 
     RowBox[{"\[Rho]ssDualityListUPDN7", ",", "\[Rho]ssDualityListPertN7"}], 
     "}"}], "]"}], ",", 
   RowBox[{"ImageResolution", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"600", ",", "450"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7821498290155*^9, 3.782149838202867*^9}, {
  3.782150910714281*^9, 3.782150910821898*^9}, {3.782151258184766*^9, 
  3.782151258412829*^9}, {3.782153350235484*^9, 3.7821533830082703`*^9}, {
  3.782153460309936*^9, 3.7821534622126827`*^9}, {3.782153539292556*^9, 
  3.782153566675374*^9}, {3.782153598896091*^9, 3.782153600199258*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"d65c7ec6-a2c5-4cc1-875d-47b3dedadb96"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"U", ".", 
    RowBox[{"\[Rho]ssDualityListUPDN7", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ".", 
    RowBox[{"U", "\[Transpose]"}]}], "//", "Abs"}], "//", 
  "ArrayPlot"}]], "Input",
 CellChangeTimes->{{3.782149581024638*^9, 3.7821495860466337`*^9}, {
  3.782153828175774*^9, 3.7821538786085577`*^9}, {3.7821539126913137`*^9, 
  3.7821539759123497`*^9}, {3.782154078897373*^9, 3.7821541096086607`*^9}, {
  3.782154309333658*^9, 3.782154317836952*^9}, {3.782154353221671*^9, 
  3.782154367209833*^9}, {3.78215492884494*^9, 
  3.7821549364409523`*^9}},ExpressionUUID->"e03c2548-b240-4958-8423-\
c76ef6e0df36"],

Cell[BoxData[
 RowBox[{
  RowBox[{"U", ".", 
   RowBox[{"\[Rho]ssDualityListUPDN3", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ".", 
   RowBox[{"U", "\[Transpose]"}]}], "//", "Threshold"}]], "Input",
 CellChangeTimes->{{3.782149484338183*^9, 3.782149492646244*^9}, {
  3.78214959559093*^9, 3.782149643127224*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"bd0c8b78-d158-47ed-b0e7-c5c74321fc62"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"\[ScriptCapitalL]", ".", 
     RowBox[{"Vectorise", "[", "\[Rho]ss", "]"}]}], ")"}], "//", "Norm"}], "//",
   "Timing"}]], "Input",
 CellChangeTimes->{{3.78211724817624*^9, 3.782117336922916*^9}, {
  3.782145952488283*^9, 3.782145954425249*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"4c35addc-e4d0-4979-bc27-d6091757b480"],

Cell[BoxData[
 RowBox[{"vect", "=", "%"}]], "Input",
 CellChangeTimes->{{3.78211714326049*^9, 3.782117144980122*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"c6e3f9fe-76c0-42ed-934a-3a6f6d310b54"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"range", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SxSxCorrelations", "[", 
         RowBox[{"\[Rho]SSpert", "/", 
          RowBox[{"Tr", "[", "\[Rho]SSpert", "]"}]}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "range"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Purple"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SxSxCorrelations", "[", 
         RowBox[{"\[Rho]SSUPD", "/", 
          RowBox[{"Tr", "[", "\[Rho]SSUPD", "]"}]}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "range"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SxSxCorrelations", "[", 
         RowBox[{"\[Rho]SSbrute", "/", 
          RowBox[{"Tr", "[", "\[Rho]SSbrute", "]"}]}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "range"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "[", "Green", "]"}]}], "}"}]}]}], "]"}]}], "}"}], 
   ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7806572136703444`*^9, 3.780657222600677*^9}, {
   3.7806574922270412`*^9, 3.780657510379417*^9}, {3.7806575495330267`*^9, 
   3.780657554439042*^9}, {3.780657822564834*^9, 3.78065782525452*^9}, {
   3.7806578571357603`*^9, 3.780657871858633*^9}, {3.780658888953266*^9, 
   3.780658892744738*^9}, {3.780658977959606*^9, 3.780659103751754*^9}, {
   3.780664353655685*^9, 3.780664355297867*^9}, {3.7806704459758873`*^9, 
   3.7806704485421953`*^9}, {3.780674834351507*^9, 3.780674834998605*^9}, {
   3.7807323817036858`*^9, 3.78073239011685*^9}, {3.78073311908997*^9, 
   3.7807331717090282`*^9}, {3.780734566753498*^9, 3.7807345908154097`*^9}, {
   3.780903659172467*^9, 3.780903735128092*^9}, {3.780904537158647*^9, 
   3.7809045745298767`*^9}, {3.780935311941835*^9, 3.780935320301145*^9}, {
   3.780936043398066*^9, 3.780936043787786*^9}, {3.7809865280034313`*^9, 
   3.780986550687003*^9}, 3.78101196906619*^9, {3.781013185348537*^9, 
   3.7810131898445873`*^9}, {3.781013220371069*^9, 3.7810132366469803`*^9}, {
   3.781015470821048*^9, 3.78101548413778*^9}, 3.781015582111306*^9, {
   3.78101561459564*^9, 3.7810156181056137`*^9}, {3.7810160380395947`*^9, 
   3.7810160406530857`*^9}, 3.781016195400374*^9, {3.7810164468229113`*^9, 
   3.781016454852942*^9}, {3.7810166091167507`*^9, 3.7810166110983887`*^9}, {
   3.781016959086123*^9, 3.781016959241337*^9}, {3.781515686443461*^9, 
   3.78151568777337*^9}, {3.78151592689244*^9, 3.781515933465571*^9}, {
   3.782024763920141*^9, 3.78202478252481*^9}, {3.782024819208956*^9, 
   3.782024828806086*^9}, {3.7820493436647463`*^9, 3.7820494022517138`*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"52794a95-e1f7-4174-b636-61a530ba1d4c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Duality to determine other \[Rho]", "Subsubsection",
 CellChangeTimes->{{3.783282443650174*^9, 
  3.7832824557351217`*^9}},ExpressionUUID->"228deb38-4753-4fb0-b44a-\
78aec3d34707"],

Cell[BoxData[
 SubscriptBox["\[Sigma]", "z"]], "Input",
 CellChangeTimes->{{3.783282584247939*^9, 3.783282586122727*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"16a74d4a-187d-480d-abae-d3591afc0b71"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OddSiteFlip", "[", "n_", "]"}], ":=", 
   RowBox[{"Product", "[", 
    RowBox[{
     RowBox[{"Tensor", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {
               SubscriptBox["\[Sigma]", "z"], 
               RowBox[{"j", "\[Equal]", "i"}]},
              {"Id", "True"}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             
             GridBoxAlignment->{
              "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{1.}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}},
             Selectable->True]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False,
         StripWrapperBoxes->True], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OddSiteFlip", "[", "5", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.783282480359127*^9, 3.7832826778098383`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"65d9c84d-ea49-4609-a5a0-dbe0954e4044"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Set", " ", "up", " ", "the", " ", "basic", " ", "problem", " ", "for", 
    " ", "Lindblad"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", "=", "4"}], ";", 
    RowBox[{"g", "=", "1."}], ";", 
    RowBox[{"\[CapitalDelta]", "=", "1."}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hplus", "=", 
     RowBox[{"HAnIsoXY", "[", 
      RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hneg", "=", 
     RowBox[{"HAnIsoXY", "[", 
      RowBox[{"n", ",", 
       RowBox[{"-", "g"}], ",", "\[CapitalDelta]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LindbladDissipation", "=", 
     RowBox[{"Total", "@", 
      RowBox[{"(", 
       RowBox[{"Lindblad", "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Tensor", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             TagBox[GridBox[{
                {"\[Piecewise]", GridBox[{
                   {
                    SuperscriptBox["\[Sigma]", "-"], 
                    RowBox[{"j", "\[Equal]", "i"}]},
                   {"Id", "True"}
                  },
                  AllowedDimensions->{2, Automatic},
                  Editable->True,
                  
                  GridBoxAlignment->{
                   "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                  
                  GridBoxItemSize->{
                   "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {{1.}}, "RowsIndexed" -> {}},
                  GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}},
                  Selectable->True]}
               },
               
               GridBoxAlignment->{
                "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{1.}}, "RowsIndexed" -> {}},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.35]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}],
              "Piecewise",
              DeleteWithContents->True,
              Editable->False,
              SelectWithContents->True,
              Selectable->False,
              StripWrapperBoxes->True], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[ScriptCapitalL]plus", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"SuperComm", "[", "Hplus", "]"}]}], "+", 
      "LindbladDissipation"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[ScriptCapitalL]neg", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"SuperComm", "[", "Hneg", "]"}]}], "+", 
      "LindbladDissipation"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]ssplus", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Eigenvectors", "[", 
        RowBox[{"\[ScriptCapitalL]plus", ",", "1", ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Arnoldi\>\"", ",", 
            RowBox[{"\"\<Criteria\>\"", "\[Rule]", "\"\<RealPart\>\""}]}], 
           "}"}]}]}], "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}], "//", "toHilbert"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]ssneg", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Eigenvectors", "[", 
        RowBox[{"\[ScriptCapitalL]neg", ",", "1", ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Arnoldi\>\"", ",", 
            RowBox[{"\"\<Criteria\>\"", "\[Rule]", "\"\<RealPart\>\""}]}], 
           "}"}]}]}], "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}], "//", "toHilbert"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]ssplus", "*=", 
     RowBox[{"1", "/", 
      RowBox[{"Tr", "[", "\[Rho]ssplus", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]ssneg", "*=", 
     RowBox[{"1", "/", 
      RowBox[{"Tr", "[", "\[Rho]ssneg", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"SxSxCorrelations", "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"OddSiteFlip", "[", "n", "]"}], ".", "\[Rho]ssplus", ".", 
        RowBox[{"OddSiteFlip", "[", "n", "]"}]}], ",", "\[Rho]ssneg"}], 
      "}"}]}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "We", " ", "need", " ", "to", " ", "check", " ", "explicitly", " ", "if", 
     " ", "this", " ", "only", " ", "applies", " ", "for", " ", "the", " ", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       SuperscriptBox["S", "x"], 
       SuperscriptBox["S", "x"]}], "\[RightAngleBracket]"}], " ", 
     "correlation", " ", "function"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SigmaySites", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[HermitianConjugate]"}], ".", "#"}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomComplex", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "-", "I"}], ",", 
            RowBox[{"1", "+", "I"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["2", "n"], ",", 
            SuperscriptBox["2", "n"]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RandomPauliSite", "[", 
     RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Tensor", "@@", 
     RowBox[{"Table", "[", 
      RowBox[{
       TagBox[GridBox[{
          {"\[Piecewise]", GridBox[{
             {
              RowBox[{"RandomChoice", "[", 
               RowBox[{"{", 
                RowBox[{"Id", ",", "Sigmax", ",", "Sigmay", ",", "Sigmaz"}], 
                "}"}], "]"}], 
              RowBox[{"j", "\[Equal]", "i"}]},
             {"Id", "True"}
            },
            AllowedDimensions->{2, Automatic},
            Editable->True,
            
            GridBoxAlignment->{
             "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{1.}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.84]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}},
            Selectable->True]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.35]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        "Piecewise",
        DeleteWithContents->True,
        Editable->False,
        SelectWithContents->True,
        Selectable->False,
        StripWrapperBoxes->True], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RandomPauliList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomPauliSite", "[", 
        RowBox[{"n", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RandomCorrelations", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{
          "RandomPauliList", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ".", 
          RowBox[{
          "RandomPauliList", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ".", "#"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"RandomCorrelations", "/@", 
     RowBox[{"{", 
      RowBox[{"\[Rho]ssplus", ",", "\[Rho]ssneg"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Duality", " ", "only", " ", "applies", " ", "at", " ", "the", " ", 
      "level", " ", "of", " ", "the", " ", "trace"}], "..."}], " ", 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.783282461117029*^9, 3.7832824721985617`*^9}, {
   3.783282706493869*^9, 3.783283026669754*^9}, {3.7832830685902567`*^9, 
   3.7832830923294153`*^9}, {3.783283139351967*^9, 3.783283140311735*^9}, {
   3.783283337010189*^9, 3.783283358854271*^9}, {3.783283483087668*^9, 
   3.7832835365162907`*^9}, {3.7832835799527817`*^9, 3.783283994634255*^9}, {
   3.783284055615522*^9, 3.7832840747426767`*^9}, {3.783284947071094*^9, 
   3.783284978874267*^9}, {3.783285142859167*^9, 3.783285160255275*^9}, {
   3.783285206689599*^9, 3.783285263668548*^9}, {3.783285305476289*^9, 
   3.7832853593125143`*^9}, {3.783285404566526*^9, 3.78328540817372*^9}, {
   3.783285446436509*^9, 3.78328544681*^9}, {3.783285493562496*^9, 
   3.783285494640361*^9}, {3.783285547156157*^9, 3.783285735576972*^9}, {
   3.783285776318007*^9, 3.783285886231991*^9}, 3.7833222314802933`*^9, {
   3.783322356656999*^9, 3.783322368340478*^9}, {3.783322473850726*^9, 
   3.78332247804195*^9}},ExpressionUUID->"62e5f80a-996e-45f4-aaaa-\
09012d35da19"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Memory scaling for Liouvillian vs N for different methods", "Subsection",
 CellChangeTimes->{{3.784189796199881*^9, 
  3.784189825946259*^9}},ExpressionUUID->"3d2ca3e5-9a2f-45a2-88cb-\
07302b8045a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nrange", "=", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4", ",", "5", ",", "6"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemVsNBrute", "=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g", "=", "1."}], ",", 
        RowBox[{"\[CapitalDelta]", "=", "1."}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "\[IndentingNewLine]", 
          RowBox[{"ByteCount", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"SuperComm", "[", 
              RowBox[{"HAnIsoXY", "[", 
               RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}], 
              "]"}]}], "+", 
            RowBox[{"BlochRedfieldBrute", "[", 
             RowBox[{
              RowBox[{"Eigensystem", "@", 
               RowBox[{"HAnIsoXY", "[", 
                RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], ",", 
              RowBox[{"1", "&"}]}], "]"}]}], "]"}]}], "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "nrange"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemVsNUPD", "=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g", "=", "1."}], ",", 
        RowBox[{"\[CapitalDelta]", "=", "1."}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "\[IndentingNewLine]", 
          RowBox[{"ByteCount", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"SuperComm", "[", 
              RowBox[{"HAnIsoXY", "[", 
               RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}], 
              "]"}]}], "+", 
            RowBox[{"BlochRedfieldZero\[CapitalDelta]", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Eigensystem", "/@", 
                 RowBox[{"H0Blocks", "[", 
                  RowBox[{"n", ",", "g"}], "]"}]}], ")"}], "\[Transpose]"}], 
              ",", 
              RowBox[{"1", "&"}]}], "]"}]}], "]"}]}], "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "nrange"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemVsNpert", "=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"g", "=", "1."}], ",", 
       RowBox[{"\[CapitalDelta]", "=", "1."}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "\[IndentingNewLine]", 
         RowBox[{"ByteCount", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            RowBox[{"SuperComm", "[", 
             RowBox[{"HAnIsoXY", "[", 
              RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}], "]"}]}],
            "+", 
           RowBox[{"BlochRedfieldPert", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Eigensystem", "/@", 
                RowBox[{"H0Blocks", "[", 
                 RowBox[{"n", ",", "g"}], "]"}]}], ")"}], "\[Transpose]"}], 
             ",", "\[CapitalDelta]", ",", 
             RowBox[{"1", "&"}]}], "]"}]}], "]"}]}], "}"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "nrange"}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.784189831777607*^9, 3.784189971315518*^9}, {
   3.7841900191588306`*^9, 3.784190030484846*^9}, {3.784190103552561*^9, 
   3.784190352879458*^9}, {3.78419039154712*^9, 3.784190439267064*^9}, {
   3.784190534864586*^9, 3.784190536120379*^9}, {3.784190921127141*^9, 
   3.784190923452157*^9}, {3.7841910427368803`*^9, 3.784191048548628*^9}, {
   3.784191139850108*^9, 3.784191142213792*^9}, 3.784191267598068*^9, {
   3.78419149551965*^9, 3.784191496931055*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"e26bd5ce-0dd7-4442-8c7a-e75ef8eebc4e"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"MemVsNBrute", ",", "MemVsNUPD", ",", "MemVsNpert"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.784189831777607*^9, 3.784189971315518*^9}, {
   3.7841900191588306`*^9, 3.784190030484846*^9}, {3.784190103552561*^9, 
   3.784190352879458*^9}, {3.78419039154712*^9, 3.7841904452706337`*^9}, 
   3.7841911145917997`*^9, {3.78419121978662*^9, 3.7841912333571587`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"b4fec963-573c-4a7c-9bb2-6f00a0c1f035"],

Cell["\<\
Chopping the data reveals they all have the same byte count because they are \
all Linbladians for flat bath. \
\>", "Text",
 CellChangeTimes->{{3.7842049779745483`*^9, 
  3.784205007357153*^9}},ExpressionUUID->"cd1b8067-0d8b-4904-804a-\
b1c090bd95cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nrange", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "5", ",", "6"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemVsNBrute", "=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g", "=", "1."}], ",", 
        RowBox[{"\[CapitalDelta]", "=", "1."}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "\[IndentingNewLine]", 
          RowBox[{"ByteCount", "[", 
           RowBox[{"Chop", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "I"}], " ", 
              RowBox[{"SuperComm", "[", 
               RowBox[{"HAnIsoXY", "[", 
                RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}], 
               "]"}]}], "+", 
             RowBox[{"BlochRedfieldBrute", "[", 
              RowBox[{
               RowBox[{"Eigensystem", "@", 
                RowBox[{"HAnIsoXY", "[", 
                 RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], 
               ",", 
               RowBox[{"1", "&"}]}], "]"}]}], "]"}], "]"}]}], "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "nrange"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemVsNUPD", "=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g", "=", "1."}], ",", 
        RowBox[{"\[CapitalDelta]", "=", "1."}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "\[IndentingNewLine]", 
          RowBox[{"ByteCount", "[", 
           RowBox[{"Chop", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "I"}], " ", 
              RowBox[{"SuperComm", "[", 
               RowBox[{"HAnIsoXY", "[", 
                RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}], 
               "]"}]}], "+", 
             RowBox[{"BlochRedfieldZero\[CapitalDelta]", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Eigensystem", "/@", 
                  RowBox[{"H0Blocks", "[", 
                   RowBox[{"n", ",", "g"}], "]"}]}], ")"}], "\[Transpose]"}], 
               ",", 
               RowBox[{"1", "&"}]}], "]"}]}], "]"}], "]"}]}], "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "nrange"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemVsNpert", "=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"g", "=", "1."}], ",", 
       RowBox[{"\[CapitalDelta]", "=", "1."}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "\[IndentingNewLine]", 
         RowBox[{"ByteCount", "[", 
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"SuperComm", "[", 
              RowBox[{"HAnIsoXY", "[", 
               RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}], 
              "]"}]}], "+", 
            RowBox[{"BlochRedfieldPert", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Eigensystem", "/@", 
                 RowBox[{"H0Blocks", "[", 
                  RowBox[{"n", ",", "g"}], "]"}]}], ")"}], "\[Transpose]"}], 
              ",", "\[CapitalDelta]", ",", 
              RowBox[{"1", "&"}]}], "]"}]}], "]"}], "]"}]}], "}"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "nrange"}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.784204781406126*^9, 3.784204798961897*^9}, {
  3.784204964641479*^9, 3.784204972792967*^9}, {3.7842051447322273`*^9, 
  3.784205145333055*^9}},ExpressionUUID->"710b5146-e374-4b12-827b-\
b0a3045b1b44"],

Cell["Now we consider the effect of putting a structured bath in:", "Text",
 CellChangeTimes->{{3.784205010966083*^9, 
  3.7842050249004087`*^9}},ExpressionUUID->"b362f666-a362-4a9a-942f-\
c3716657c3c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Gaussian", "=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"#", "-", "5."}], ")"}], "2"]}], "/", "25."}], " ", "]"}], 
    "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nrange", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "5", ",", "6"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemVsNBrute", "=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g", "=", "1."}], ",", 
        RowBox[{"\[CapitalDelta]", "=", "1."}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "\[IndentingNewLine]", 
          RowBox[{"ByteCount", "[", 
           RowBox[{"Chop", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "I"}], " ", 
              RowBox[{"SuperComm", "[", 
               RowBox[{"HAnIsoXY", "[", 
                RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}], 
               "]"}]}], "+", 
             RowBox[{"BlochRedfieldBrute", "[", 
              RowBox[{
               RowBox[{"Eigensystem", "@", 
                RowBox[{"HAnIsoXY", "[", 
                 RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], 
               ",", "Gaussian"}], "]"}]}], "]"}], "]"}]}], "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "nrange"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemVsNUPD", "=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g", "=", "1."}], ",", 
        RowBox[{"\[CapitalDelta]", "=", "1."}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "\[IndentingNewLine]", 
          RowBox[{"ByteCount", "[", 
           RowBox[{"Chop", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "I"}], " ", 
              RowBox[{"SuperComm", "[", 
               RowBox[{"HAnIsoXY", "[", 
                RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}], 
               "]"}]}], "+", 
             RowBox[{"BlochRedfieldZero\[CapitalDelta]", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Eigensystem", "/@", 
                  RowBox[{"H0Blocks", "[", 
                   RowBox[{"n", ",", "g"}], "]"}]}], ")"}], "\[Transpose]"}], 
               ",", "Gaussian"}], "]"}]}], "]"}], "]"}]}], "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "nrange"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemVsNpert", "=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"g", "=", "1."}], ",", 
       RowBox[{"\[CapitalDelta]", "=", "1."}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "\[IndentingNewLine]", 
         RowBox[{"ByteCount", "[", 
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"SuperComm", "[", 
              RowBox[{"HAnIsoXY", "[", 
               RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}], 
              "]"}]}], "+", 
            RowBox[{"BlochRedfieldPert", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Eigensystem", "/@", 
                 RowBox[{"H0Blocks", "[", 
                  RowBox[{"n", ",", "g"}], "]"}]}], ")"}], "\[Transpose]"}], 
              ",", "\[CapitalDelta]", ",", "Gaussian"}], "]"}]}], "]"}], 
          "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "nrange"}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.78420505161448*^9, 3.784205100152687*^9}, 
   3.784205152112707*^9},
 CellLabel->"In[72]:=",ExpressionUUID->"8d2b7a21-9202-43fd-a9bf-ef5a78b9044f"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"MemVsNBrute", ",", "MemVsNUPD", ",", "MemVsNpert"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellLabel->"In[77]:=",ExpressionUUID->"0aa42a74-3651-43de-9c0f-22fd949a0a72"]
}, Closed]],

Cell[CellGroupData[{

Cell["Now for varying g, fixed N", "Subsection",
 CellChangeTimes->{{3.784205257748975*^9, 
  3.784205267675737*^9}},ExpressionUUID->"a7471874-b919-45d4-8da6-\
772dbe09ec03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LfuncBruteFixN\[CapitalDelta]", "[", 
     RowBox[{"n_", ",", "\[CapitalDelta]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "I"}], " ", 
        RowBox[{"SuperComm", "[", 
         RowBox[{"HAnIsoXY", "[", 
          RowBox[{"n", ",", "#", ",", "\[CapitalDelta]"}], "]"}], "]"}]}], 
       "+", 
       RowBox[{"BlochRedfieldBrute", "[", 
        RowBox[{
         RowBox[{"Eigensystem", "@", 
          RowBox[{"HAnIsoXY", "[", 
           RowBox[{"n", ",", "#", ",", "\[CapitalDelta]"}], "]"}]}], ",", 
         RowBox[{"1", "&"}]}], "]"}]}], ")"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MemVsgBrute", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ByteCount", "@*", "Chop", "@*", 
      RowBox[{"LfuncBruteFixN\[CapitalDelta]", "[", 
       RowBox[{"4", ",", "1."}], "]"}]}], ")"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "2."}], ",", "2.", ",", ".2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.784205284292747*^9, 3.784205423725638*^9}, {
  3.7842054816749773`*^9, 3.7842055603494873`*^9}, {3.784205633089386*^9, 
  3.784205696820668*^9}, {3.7842057374880857`*^9, 3.784205792881825*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"6835d816-b2a4-48f2-a551-c3a740117fe3"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", "MemVsgBrute", "]"}]], "Input",
 CellChangeTimes->{{3.784205408650095*^9, 3.7842054184704523`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"0e09f27b-4f33-403b-ba9d-ad2007a44a11"],

Cell["\<\
So the memory doesn\[CloseCurlyQuote]t really seem to vary as a function of g \
except at g = 0.\
\>", "Text",
 CellChangeTimes->{{3.784205914120768*^9, 
  3.784205937152169*^9}},ExpressionUUID->"396328f8-af9d-46fa-a105-\
5b0b9852f59c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Dualities on the Eigenoperators", "Section",
 CellChangeTimes->{{3.797070650126687*^9, 
  3.797070655263442*^9}},ExpressionUUID->"99144d61-c019-47cd-ac0e-\
e68d27ccba3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", "g_", "]"}], ":=", 
   RowBox[{"HAnIsoXY", "[", 
    RowBox[{"6", ",", "g", ",", "0.05"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rodd", "[", "n_", "]"}], ":=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Site", "[", 
       RowBox[{"Sigmaz", ",", "i", ",", "n"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n", ",", "2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"A", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"EigOpBrute", "[", 
        RowBox[{
         RowBox[{"Eigensystem", "[", 
          RowBox[{"H", "[", "5.", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           FractionBox["0.5", "\[Pi]"], 
           RowBox[{
            RowBox[{"\[CapitalGamma]Lorentzian", "[", 
             RowBox[{"5.", ",", "5."}], "]"}], "[", "#", "]"}]}], "&"}]}], 
        "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "\[IndentingNewLine]", "AminusHminusg"}], "=", 
     RowBox[{
      RowBox[{"EigOpBrute", "[", 
       RowBox[{
        RowBox[{"Eigensystem", "[", 
         RowBox[{"-", 
          RowBox[{"H", "[", 
           RowBox[{"-", "5."}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox["0.5", "\[Pi]"], 
            RowBox[{
             RowBox[{"\[CapitalGamma]Lorentzian", "[", 
              RowBox[{"5.", ",", "5."}], "]"}], "[", "#", "]"}]}], ")"}], 
          "\[Conjugate]"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7970706674838123`*^9, 3.7970707636024847`*^9}, {
   3.797070794208089*^9, 3.797070996056583*^9}, {3.797071039990217*^9, 
   3.797071041913631*^9}, {3.797071137389207*^9, 3.797071140256588*^9}, 
   3.797071286925412*^9, {3.7970713263254967`*^9, 3.797071341647554*^9}, {
   3.797071553109912*^9, 3.79707155745718*^9}, {3.797144587345351*^9, 
   3.7971445979469843`*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"f3c25826-e83e-46b7-963b-3f6b742337d9"],

Cell[BoxData[{
 RowBox[{"A", "//", "MatrixPlot"}], "\[IndentingNewLine]", 
 RowBox[{"AminusHminusg", "//", "MatrixPlot"}]}], "Input",
 CellChangeTimes->{{3.79707100985608*^9, 3.797071074911978*^9}, {
   3.797071149741276*^9, 3.797071230125065*^9}, {3.797071266128275*^9, 
   3.797071320298699*^9}, {3.7970713528673353`*^9, 3.797071458494426*^9}, 
   3.797071566549547*^9},
 CellLabel->
  "In[141]:=",ExpressionUUID->"38fc7704-8ede-4946-ba8c-04b9cff90e0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]List", "=", 
   RowBox[{"ToPure", "/@", 
    RowBox[{"Eigenvectors", "[", 
     RowBox[{"H", "[", "1", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.797144629799288*^9, 3.797144656606073*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"88ab5992-331a-4098-93d7-e5b2cf29f7e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"SzT", "[", "6", "]"}], ".", "#"}], "]"}], "&"}], "/@", 
  "\[Rho]List"}]], "Input",
 CellChangeTimes->{{3.79714466052463*^9, 3.79714470006942*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"6ab6d1f2-6f81-4531-ae4e-e0144be17f3f"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"H", "[", "1", "]"}], "]"}], "]"}], ",", 
    RowBox[{"Sort", "@", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"-", 
       RowBox[{"H", "[", 
        RowBox[{"-", "1"}], "]"}]}], "]"}]}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7971445266238337`*^9, 3.797144579124627*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"5d601053-a9de-48d6-be15-017e48f951f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transport 2 sites", "Section",
 CellChangeTimes->{{3.783064291829459*^9, 3.783064331882264*^9}, {
  3.789284181599012*^9, 3.789284181729898*^9}, {3.7997772612812*^9, 
  3.799777265402116*^9}},ExpressionUUID->"04c33c07-f2ad-4c4c-ade3-\
76510608ecfb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"HAnIsoXY", "[", 
    RowBox[{"2", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalL]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{"SuperComm", "[", "H", "]"}]}], "+", 
    RowBox[{"BlochRedfieldBrute", "[", 
     RowBox[{
      RowBox[{"Eigensystem", "[", "H", "]"}], ",", 
      RowBox[{"1", "&"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"j1", "=", 
  RowBox[{"Tr", "[", 
   RowBox[{
    RowBox[{"SzT", "[", "2", "]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Eigenvectors", "[", 
       RowBox[{"\[ScriptCapitalL]", ",", 
        RowBox[{"-", "1"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}], ")"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.799779320509862*^9, 
  3.7997795680014887`*^9}},ExpressionUUID->"85e57689-79d8-4d86-8066-\
c1db14021ac2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Real-time evolution of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["\[Rho]", "."], " ", "=", " "}], TraditionalForm]],
  InitializationCell->True,ExpressionUUID->
  "5db0c203-e061-4183-baba-9d4a454071b4"],
 "\[ScriptCapitalL]\[Rho](t) to get ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "s"], TraditionalForm]],ExpressionUUID->
  "9215be3b-4bb1-4913-b396-0348f488a69d"]
}], "Section",
 CellChangeTimes->{{3.783064291829459*^9, 3.783064331882264*^9}, {
  3.789284181599012*^9, 
  3.789284181729898*^9}},ExpressionUUID->"387bb6b3-83c8-422d-a767-\
9e41d861cce4"],

Cell["\<\
One method for getting at the stead state properties of an open quantum \
system (OQS) is to directly time evolve it\[CloseCurlyQuote]s equation of \
motion using a numerical iteration scheme. Given that we can construct \
Liouvillians almost efficiently enough to get up to the memory limits of a \
single desktop (N=10/11 for Lindblad, 8/9 for Redfield), we may trade space \
constraints for long-time calculations. In theory you only need to store a \
single \[Rho] representing the current time and have a way to construct a \
black-box Runge-Kutta iterator (see below). 
\tThere are two possible downsides to this approach however. First, it may be \
easier to time evolve some parameter schemes more that others due to \
possibility of there being oscillations on very short time-scales. Here, \
adaptive numerical integrators reduce the time step massively to maintain the \
required tolerance. Given that we need to perform at least one sparse \
matrix-dense vector multiplication per time-step this is going to be costly \
in these cases. The second problem I can foresee is the possible existence of \
bistable steady states depending on the initial condition. (Maybe if there \
are no instabilities in this problem it means that a poorer but more \
efficient iteration scheme could be used since the same steady-state pops out?)
\tWhile Arnoldi iteration in principle and anecdotally seems to converge on \
the largest eigenvector very quickly, we are having issues getting it to work \
moderately large chains, since the \[OpenCurlyDoubleQuote]Criteria\
\[CloseCurlyDoubleQuote]->\[CloseCurlyDoubleQuote]RealPart\
\[CloseCurlyDoubleQuote] option does not always find the 0.+I0. eigenvalue. \
So, we turn to direct time-evolution for the largest chains we can construct, \
opting for a trustworthy but expensive method. \
\>", "Text",
 CellChangeTimes->{{3.78306434180929*^9, 3.7830643699247313`*^9}, {
   3.783064417964044*^9, 3.783064423170931*^9}, {3.783064502331143*^9, 
   3.7830651024591627`*^9}, {3.7831488126545467`*^9, 3.783148827279127*^9}, 
   3.783149703391514*^9, 
   3.784459060988064*^9},ExpressionUUID->"b740325d-a498-4c43-9f9d-\
8787a6b6e522"],

Cell[CellGroupData[{

Cell["Time evolution of density operators symbolic style", "Subsection",
 CellChangeTimes->{{3.7537136357888203`*^9, 3.753713645517354*^9}, {
  3.782980681855343*^9, 
  3.7829806869793797`*^9}},ExpressionUUID->"a6924e97-9747-4e27-8698-\
397927ded899"],

Cell["If we have a master equation of the form:", "Text",
 CellChangeTimes->{{3.753713655219749*^9, 
  3.7537136647367783`*^9}},ExpressionUUID->"693d10e7-6261-4ab6-a948-\
aa9de105bff3"],

Cell[CellGroupData[{

Cell[TextData[{
 "\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["\[Rho]", "."], " ", "=", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[ImaginaryI]", "[", 
       RowBox[{"H", ",", " ", "\[Rho]"}], "]"}]}], " ", "+", " ", 
     RowBox[{"\[ScriptCapitalD]", " ", "\[Rho]"}]}]}], TraditionalForm]],
  ExpressionUUID->"d6dc7581-1160-44e8-911b-64820ca42592"]
}], "Subsubsubsubsection",
 CellChangeTimes->{{3.753713667954328*^9, 
  3.753713688735215*^9}},ExpressionUUID->"ff84b507-36a9-4457-8f53-\
8747f0f49d48"],

Cell["\<\
we may simply time-evolve the the system of differential equations by finding \
the super operator \[ScriptCapitalL] such that\
\>", "Text",
 CellChangeTimes->{{3.7537136947783957`*^9, 
  3.753713728373296*^9}},ExpressionUUID->"1b6b705a-a2c0-4cde-9b1f-\
4f9265acea2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\t\t",
 Cell[BoxData[
  SubscriptBox["\[PartialD]", "t"]],ExpressionUUID->
  "ee2ced7b-72e4-46b3-b3c2-060a80ca8406"],
 " |\[Rho] \[RightAngleBracket]\[RightAngleBracket] = \[ScriptCapitalL] |\
\[Rho] \[RightAngleBracket]\[RightAngleBracket].                              \
                                                                (TE1)"
}], "Subsubsubsubsection",
 CellChangeTimes->{{3.753713734118887*^9, 3.753713817198052*^9}, {
  3.7830651479161663`*^9, 
  3.783065157317361*^9}},ExpressionUUID->"1a57d61d-2f76-472f-944c-\
a71e376bf729"],

Cell["\<\
In this code we expand in symbols the system of ODEs that (TE1) describes, \
feeding that system to NDSolve, which returns an array of \
InterpolatingFunction[] objects which encode the time-dependent density \
matrix \[Rho](t). Crucially, this method should only be used on small to \
moderately sized open spin-chains since making large symbolic arrays is \
costly. It\[CloseCurlyQuote]s possible to get potentially exact solutions if \
you feed this to DSolve for smaller systems.\
\>", "Text",
 CellChangeTimes->{{3.78306513045576*^9, 
  3.783065291309402*^9}},ExpressionUUID->"b8a2a75e-befc-4f8f-8ac1-\
506c4be750b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MESolve", "[", 
    RowBox[{"\[Rho]init_", ",", "\[ScriptCapitalL]_", ",", 
     RowBox[{"{", 
      RowBox[{"tmin_", ",", "tmax_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"eqns", ",", "init", ",", "soln", ",", "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["\[Rho]", "##"], "[", "t", "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", "\[Rho]init", "]"}], ",", 
             RowBox[{"Length", "[", "\[Rho]init", "]"}]}], "}"}]}], "]"}], "//",
          "Vectorise"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eqns", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"state", ",", "t"}], "]"}], "\[Equal]", 
         RowBox[{"\[ScriptCapitalL]", ".", "state"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"init", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"state", "/.", 
           RowBox[{"{", 
            RowBox[{"t", "\[Rule]", "tmin"}], "}"}]}], ")"}], "\[Equal]", 
         RowBox[{"Vectorise", "[", "\[Rho]init", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"soln", "=", 
       RowBox[{
        RowBox[{"toHilbert", "[", "state", "]"}], "/.", 
        RowBox[{
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"eqns", ",", "init"}], "}"}], ",", "state", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "tmin", ",", "tmax"}], "}"}]}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7537138477201757`*^9, 3.7537139627250547`*^9}, {
   3.753714028185511*^9, 3.753714091018626*^9}, {3.7537141833635798`*^9, 
   3.7537142206468554`*^9}, {3.75371519562551*^9, 3.7537153083883677`*^9}, {
   3.753715405488101*^9, 3.7537154165994387`*^9}, {3.7537168807741947`*^9, 
   3.753716884666161*^9}, {3.753718128675509*^9, 3.753718272309486*^9}, {
   3.753718315091565*^9, 3.753718357262211*^9}, {3.7537184486788054`*^9, 
   3.753718453558941*^9}, {3.7537185043192368`*^9, 3.753718553056116*^9}, {
   3.753718583574828*^9, 3.753718587262018*^9}, {3.7537186242867517`*^9, 
   3.753718655828538*^9}, {3.75371868796522*^9, 3.753718725298752*^9}, 
   3.7537188197963257`*^9, {3.753718867466938*^9, 3.753718920295538*^9}, {
   3.753718964379175*^9, 3.7537190005864143`*^9}, {3.7537190373529177`*^9, 
   3.753719038821206*^9}, {3.753728985249322*^9, 3.753729039533758*^9}, {
   3.7537290784167337`*^9, 3.753729163599649*^9}, {3.753729231735475*^9, 
   3.753729264032403*^9}, {3.753731024721628*^9, 3.753731093655037*^9}, {
   3.7537316546005697`*^9, 3.753731686979864*^9}, {3.753764017898611*^9, 
   3.753764018649763*^9}, {3.753764125012361*^9, 3.753764125207223*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"9964f613-4525-4e66-a972-e9aec5887ccc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"my\[ScriptCapitalL]", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", 
    RowBox[{"SuperComm", "[", 
     RowBox[{"HAnIsoXY", "[", 
      RowBox[{"nn", ",", "1.", ",", "2."}], "]"}], "]"}]}], "+", 
   RowBox[{"0.1", 
    RowBox[{"BlochRedfieldZero\[CapitalDelta]", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Eigensystem", "/@", 
         RowBox[{"H0Blocks", "[", 
          RowBox[{"nn", ",", "1."}], "]"}]}], ")"}], "\[Transpose]"}], ",", 
      RowBox[{"1", "&"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.7537142255572577`*^9, 3.753714316159226*^9}, {
   3.753718389908616*^9, 3.753718418439951*^9}, {3.7537184605171413`*^9, 
   3.753718485038862*^9}, 3.753718523248074*^9, {3.7537187338642893`*^9, 
   3.753718766265996*^9}, 3.753718923764619*^9, 3.753729176997225*^9, {
   3.753729304637903*^9, 3.753729316856776*^9}, {3.7537293806675653`*^9, 
   3.7537293978996162`*^9}, {3.7537294324345407`*^9, 3.753729554182119*^9}, {
   3.75372959786066*^9, 3.753729610047571*^9}, 3.753730176818492*^9, {
   3.753730209212161*^9, 3.753730227291318*^9}, {3.7537302630510063`*^9, 
   3.7537302947183228`*^9}, {3.753730328331015*^9, 3.753730329437119*^9}, {
   3.753730711717243*^9, 3.753730713239665*^9}, 3.753730878189603*^9, 
   3.7537309799979677`*^9, {3.753731099824561*^9, 3.753731107572798*^9}, {
   3.753731258523271*^9, 3.753731267256493*^9}, {3.7537312980277557`*^9, 
   3.7537313519647703`*^9}, 3.75373190461917*^9, 3.753732135247546*^9, {
   3.7537321998581533`*^9, 3.753732340775793*^9}, 3.7537323711755257`*^9, {
   3.753763425488575*^9, 3.753763457937419*^9}, {3.7537635060878077`*^9, 
   3.753763515776403*^9}, {3.75376359439799*^9, 3.7537636099566708`*^9}, {
   3.753763884059621*^9, 3.753763896451415*^9}, 3.753763971566161*^9, 
   3.753764110655567*^9, 3.753764168553801*^9, {3.753764205170874*^9, 
   3.753764212851451*^9}, 3.754159612233259*^9, 3.754224582819384*^9, 
   3.754224768444441*^9, 3.754333084897678*^9, 3.7543378875332003`*^9, 
   3.754341256818226*^9, 3.754400487798429*^9, 3.754700243869094*^9, {
   3.776939792448204*^9, 3.776939796645513*^9}, 3.7769400292521963`*^9, 
   3.7769401372661047`*^9, 3.776940214408983*^9, 3.7797028707109823`*^9},
 CellLabel->"In[50]:=",ExpressionUUID->"93c0131d-326c-491c-8854-f8b60e5359a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]init", "=", 
   RowBox[{"Tensor", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {
             RowBox[{"Outer", "[", 
              RowBox[{"Times", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], "]"}], 
             RowBox[{"i", "\[Equal]", "3"}]},
            {
             RowBox[{"Outer", "[", 
              RowBox[{"Times", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "True"}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}},
           Selectable->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "nn"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expOpers", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Tensor", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        TagBox[GridBox[{
           {"\[Piecewise]", GridBox[{
              {"Sigmaz", 
               RowBox[{"i", "\[Equal]", "j"}]},
              {"Id", "True"}
             },
             AllowedDimensions->{2, Automatic},
             Editable->True,
             
             GridBoxAlignment->{
              "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{1.}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}},
             Selectable->True]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.35]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         "Piecewise",
         DeleteWithContents->True,
         Editable->False,
         SelectWithContents->True,
         Selectable->False], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nn"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nn"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"soln", "[", "tt_", "]"}], "=", 
   RowBox[{
    RowBox[{"MESolve", "[", 
     RowBox[{"\[Rho]init", ",", "my\[ScriptCapitalL]", ",", 
      RowBox[{"{", 
       RowBox[{"0.", ",", "25."}], "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"t", "\[Rule]", "tt"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7537142255572577`*^9, 3.753714316159226*^9}, {
   3.753718389908616*^9, 3.753718418439951*^9}, {3.7537184605171413`*^9, 
   3.753718485038862*^9}, 3.753718523248074*^9, {3.7537187338642893`*^9, 
   3.753718766265996*^9}, 3.753718923764619*^9, 3.753729176997225*^9, {
   3.753729304637903*^9, 3.753729316856776*^9}, {3.7537293806675653`*^9, 
   3.7537293978996162`*^9}, {3.7537294324345407`*^9, 3.753729554182119*^9}, {
   3.75372959786066*^9, 3.753729610047571*^9}, 3.753730176818492*^9, {
   3.753730209212161*^9, 3.753730227291318*^9}, {3.7537302630510063`*^9, 
   3.7537302947183228`*^9}, {3.753730328331015*^9, 3.753730329437119*^9}, {
   3.753730711717243*^9, 3.753730713239665*^9}, 3.753730878189603*^9, 
   3.7537309799979677`*^9, {3.753731099824561*^9, 3.753731107572798*^9}, {
   3.753731258523271*^9, 3.753731267256493*^9}, {3.7537312980277557`*^9, 
   3.7537313519647703`*^9}, 3.75373190461917*^9, 3.753732135247546*^9, {
   3.7537321998581533`*^9, 3.7537322860135727`*^9}, {3.753763532158299*^9, 
   3.7537635715575657`*^9}, {3.753763601873866*^9, 3.75376362285115*^9}, {
   3.753763869423319*^9, 3.753763869723859*^9}, {3.753763908765443*^9, 
   3.7537639099345617`*^9}, {3.7541652246867247`*^9, 
   3.7541652348301573`*^9}, {3.754700252845889*^9, 3.754700287961199*^9}, 
   3.77693980866914*^9, {3.776939949417531*^9, 3.7769399694370203`*^9}, 
   3.779702741687348*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"2d0b53ce-c905-4f7a-acd4-07e17a56a99f"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Expect", "[", 
       RowBox[{
        RowBox[{
        "expOpers", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"soln", "[", "t", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "nn"}], "}"}]}], "]"}], "//", "Evaluate"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0.", ",", "15."}], "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", "Thick"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7537142255572577`*^9, 3.753714316159226*^9}, {
   3.753718389908616*^9, 3.753718418439951*^9}, {3.7537184605171413`*^9, 
   3.753718485038862*^9}, 3.753718523248074*^9, {3.7537187338642893`*^9, 
   3.753718766265996*^9}, 3.753718923764619*^9, 3.753729176997225*^9, {
   3.753729304637903*^9, 3.753729316856776*^9}, {3.7537293806675653`*^9, 
   3.7537293978996162`*^9}, {3.7537294324345407`*^9, 3.753729554182119*^9}, {
   3.75372959786066*^9, 3.753729610047571*^9}, 3.753730176818492*^9, {
   3.753730209212161*^9, 3.753730227291318*^9}, {3.7537302630510063`*^9, 
   3.7537302947183228`*^9}, {3.753730328331015*^9, 3.753730329437119*^9}, {
   3.753730711717243*^9, 3.753730713239665*^9}, 3.753730878189603*^9, 
   3.7537309799979677`*^9, {3.753731099824561*^9, 3.753731107572798*^9}, {
   3.753731258523271*^9, 3.753731267256493*^9}, {3.7537312980277557`*^9, 
   3.7537313519647703`*^9}, 3.75373190461917*^9, 3.753732135247546*^9, {
   3.7537321998581533`*^9, 3.7537322860135727`*^9}, {3.753763532158299*^9, 
   3.7537635715575657`*^9}, {3.753763601873866*^9, 3.75376362285115*^9}, {
   3.753763869423319*^9, 3.753763869723859*^9}, {3.753763908765443*^9, 
   3.7537639099345617`*^9}, {3.7541652246867247`*^9, 
   3.7541652348301573`*^9}, {3.754700252845889*^9, 3.754700287961199*^9}, 
   3.77693980866914*^9, {3.776939949417531*^9, 3.776939958037623*^9}, {
   3.7785227872922487`*^9, 3.778522830404414*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"9456d147-c04c-46d5-9c91-6f7bdb79ca53"],

Cell[BoxData[
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SxSxCorrelations", "[", 
       RowBox[{"soln", "[", "t", "]"}], "]"}], "//", "Evaluate"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", "Orange"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
        RowBox[{"Point", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "nn"}], "]"}], ",", 
            RowBox[{
             RowBox[{"SxSxCorrelations", "[", 
              RowBox[{"soln", "[", "t", "]"}], "]"}], "//", "Evaluate"}]}], 
           "}"}], "\[Transpose]"}], "]"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0.", ",", "13."}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7537318117556143`*^9, 3.753731884459594*^9}, {
   3.753731947297368*^9, 3.753731954054996*^9}, {3.753732012362915*^9, 
   3.7537321053231897`*^9}, {3.753763558478119*^9, 3.7537635587329473`*^9}, {
   3.753763635497138*^9, 3.7537636358155003`*^9}, {3.753763929322977*^9, 
   3.753763929410576*^9}, 3.75376419380639*^9, 3.753764224576909*^9, 
   3.754700295432308*^9, 3.776939821680832*^9, {3.77852285462307*^9, 
   3.778522854710992*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"24fb3e2e-8f03-41e0-8d85-a1628b379f4b"],

Cell["\<\
One benefit of calculating \[Rho](t) this way means that we can construct \
other interpolating functions out of them, meaning for instance we only need \
to perform one symbolic calculation on the elements of \[Rho](t), eg \
\[LeftAngleBracket]X\[RightAngleBracket] = Tr(X \[Rho](t)) instead of at \
every time step for a brand-new density matrix \[Rho](t+dt).\
\>", "Text",
 CellChangeTimes->{{3.783065300018095*^9, 
  3.7830654079222717`*^9}},ExpressionUUID->"68bf3904-bc02-48c1-9d1c-\
0702567cb3de"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Time evolution of large \[ScriptCapitalL] using Vectorised NDSolve", \
"Subsection",
 CellChangeTimes->{{3.782804878083952*^9, 3.782804912188883*^9}, 
   3.78289218766989*^9, {3.782980700399253*^9, 
   3.782980707445055*^9}},ExpressionUUID->"31e60b16-23c9-4189-8316-\
204277799d95"],

Cell[TextData[{
 "For very very large systems of ODEs Mathematica can set up solvers \
efficiently so long as you just never symbolise your method. Namely, we are \
now conceptually solving a vector differential equation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     OverscriptBox["\[Rho]", "."], "(", "t", ")"}], " ", "=", " ", 
    RowBox[{"\[ScriptCapitalL]", " ", 
     RowBox[{"\[Rho]", "(", "t", ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "e7f69a59-bf3c-43e1-9261-f0d2314fef66"],
 " where \[Rho](t) is just stored as a vector. This means everything is kept \
in floating point arithmetic terms.\n\tOn a first attempt, I tried to just \
put this directly into an unmodified NDSolve[",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     OverscriptBox["\[Rho]", "."], "(", "t", ")"}], " ", "=", " ", 
    RowBox[{"\[ScriptCapitalL]", " ", 
     RowBox[{"\[Rho]", "(", "t", ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "ef7d5113-6e29-4906-a4e7-3e488bacb27d"],
 ", {t, 0, tmax}] but for larger chain size, the intermediate storage of \
\[Rho](t) at each time step would fill my RAM and kill the kernel. This can \
be avoided as discussed below."
}], "Text",
 CellChangeTimes->{{3.783065419222261*^9, 3.7830656030273237`*^9}, {
  3.7830969980141697`*^9, 
  3.783097003117922*^9}},ExpressionUUID->"0e09f376-78a1-4c28-a9b8-\
489fc606c4b9"],

Cell["\<\
\tAnother idea: for large N, it seems that the problem with NDSolve generally \
is that the NDSolve`StateData objects stores a lot of data about the \
evolution. This is strictly not required for our purposes. I think that if we \
dive into the iterator we should be able to avoid this hard memory wall if we \
simply reinitialise the solver after some time scale which we know won\
\[CloseCurlyQuote]t kill the kernel. For example, we know that for n=7 we can \
certainly solve for small times, say tmax ~ 5. So how about we just do that \
and then call tmax t=0 and start afresh, deleting the old state data as we go?\
\>", "Text",
 CellChangeTimes->{
  3.782828486991231*^9, {3.7829181374825172`*^9, 3.782918137982832*^9}, 
   3.783065605658259*^9, 
   3.783097006138833*^9},ExpressionUUID->"ba5051c0-4a00-41ee-be7d-\
a9442e136326"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HrMinSec", "[", "seconds_", "]"}], ":=", 
    RowBox[{"Block", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"hrs", "=", 
         RowBox[{"Floor", "[", 
          RowBox[{"seconds", "/", 
           SuperscriptBox["60.", "2"]}], "]"}]}], ",", "mins", ",", "secs"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mins", "=", 
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"seconds", "-", 
            RowBox[{"hrs", "*", 
             SuperscriptBox["60.", "2"]}]}], ")"}], "/", "60."}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"secs", "=", 
        RowBox[{"(", 
         RowBox[{"seconds", "-", 
          RowBox[{"hrs", "*", 
           SuperscriptBox["60.", "2"]}], "-", 
          RowBox[{"mins", "*", "60."}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"hrs", ",", "mins", ",", "secs"}], "}"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HrMinSecShow", "[", "seconds_", "]"}], ":=", 
   RowBox[{"StringJoin", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ToString", "/@", 
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           "\"\< h \>\"", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           "\"\< m \>\"", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
           "\"\< s\>\""}], "}"}], ")"}]}], "&"}], "@", 
      RowBox[{"HrMinSec", "[", "seconds", "]"}]}], ")"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7829162583502007`*^9, 3.782916339505657*^9}, {
  3.782916373832065*^9, 3.782916593723076*^9}, {3.782916764383231*^9, 
  3.782916782016177*^9}, {3.7830642450736837`*^9, 3.783064248071742*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"e54a1f47-d2a8-4357-b48f-6a0db3fb9784"],

Cell[TextData[{
 "The function which performs this calculation should have some options the \
user can specify to control the ODE solver. Namely, how long the total \
integration time will be, how far apart the reinitialisation points are and \
how small Norm[\[ScriptCapitalL].\[Rho]] needs to be to halt integration.\n\t\
How I want to be able to use this function:\n\t\t1) You call it for a set of \
parameters and it checks if it\[CloseCurlyQuote]s the first time loading and \
or evolving this system\n\t\t2) If it is the first time:\n\t\t\ta) Calculate \
\[ScriptCapitalL] and store\n\t\t\tb) Initialise \[Rho] and evolve, storing \
every 100 reinit steps until ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"\[ScriptCapitalL]", ".", "\[Rho]"}], "]"}], " ", "<", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "7"}]]}], TraditionalForm]],ExpressionUUID->
  "6a3a59c7-0a0b-4185-ad38-84d93dcf2cb0"],
 "(Default)\n\t\t3) If it is not the first time (\[ScriptCapitalL] and \
\[Rho](t \[Rule] ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["t", "prev"], ")"}], ")"}], TraditionalForm]],
  ExpressionUUID->"06c94867-8282-4e13-833c-500620e5b1b9"],
 " both present:\n\t\t\t- Evolve \[Rho] for t = 10 more units\n\t\t\t- OR \
evolve based on a given tmax\n\t\t4) If only \[Rho] present, recalculate \
\[ScriptCapitalL] and evolve for 10 to tmax units.\n\tThis function should \
make use of SaveDataCall and also SaveDataCallRange if necessary."
}], "Text",
 CellChangeTimes->{{3.7828291833404818`*^9, 3.782829364908957*^9}, {
  3.783065648396688*^9, 3.783065733250671*^9}, {3.783065768264974*^9, 
  3.7830659877988577`*^9}, {3.78306835768795*^9, 
  3.7830684509914494`*^9}},ExpressionUUID->"6c70606a-792d-4d64-9bf3-\
37afeb0d496c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SteadyTimeEvo", "[", 
   RowBox[{"n_", ",", "g_", ",", "\[CapitalDelta]_", ",", 
    RowBox[{"{", 
     RowBox[{"Jname_", ",", "J_"}], "}"}], ",", "method_", ",", "flags___"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "stateData", ",", "\[IndentingNewLine]", "\[Rho]init", ",", 
      "\[Rho]and\[Rho]dot", ",", "\[IndentingNewLine]", "H", ",", 
      "\[ScriptCapitalL]", ",", "\[ScriptCapitalD]", ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "FlagsDefault", ",", 
      "\[IndentingNewLine]", "tol", ",", "OverwriteFlag", ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fileNameBase", "=", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"ToString", "/@", 
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{
            "\"\<[N=\>\"", ",", "n", ",", "\"\<][g=\>\"", ",", "g", ",", 
             "\"\<][\[CapitalDelta]=\>\"", ",", "\[CapitalDelta]", ",", 
             "\"\<][method=\>\"", ",", "method", ",", "\"\<]\>\""}], "}"}], 
           ")"}]}], "]"}], "<>", "\"\<[\>\"", "<>", "Jname", "<>", 
        "\"\<]\>\""}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "optFlags", ",", "\[IndentingNewLine]", 
      RowBox[{"CheckpointFlag", "=", 
       RowBox[{"Checkpoint", "\[Rule]", "True"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MaxNormFlag", "=", 
       RowBox[{"MaxNorm", "\[Rule]", "False"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"processEq", "=", "NDSolve`ProcessEquations"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"iterate", "=", "NDSolve`Iterate"}], ",", "\[IndentingNewLine]", 
      RowBox[{"processSol", "=", "NDSolve`ProcessSolutions"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"reInit", "=", "NDSolve`Reinitialize"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "evolveState", ",", 
      "tstep"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Flag", " ", 
      RowBox[{"handling", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FlagsDefault", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MaxNorm", "\[Rule]", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]]}], ",", 
        RowBox[{"Overwrite", "\[Rule]", "False"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tol", ",", "OverwriteFlag"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"MaxNorm", ",", "Overwrite"}], "}"}], "/.", 
        RowBox[{"{", "flags", "}"}]}], "/.", "FlagsDefault"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tstep", "=", "0.1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"HAnIsoXY", "[", 
       RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Liouvillian", " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalD]", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"method", "\[Equal]", "\"\<BruteForce\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"BlochRedfieldBrute", "[", 
         RowBox[{
          RowBox[{"Eigensystem", "[", "H", "]"}], ",", "J"}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"method", "\[Equal]", "\"\<UnperturbedDissipator\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"BlochRedfieldZero\[CapitalDelta]", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Eigensystem", "/@", 
             RowBox[{"H0Blocks", "[", 
              RowBox[{"n", ",", "g"}], "]"}]}], ")"}], "\[Transpose]"}], ",", 
          "J"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"method", "\[Equal]", "\"\<PerturbationTheory\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"BlochRedfieldPert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Eigensystem", "/@", 
             RowBox[{"H0Blocks", "[", 
              RowBox[{"n", ",", "g"}], "]"}]}], ")"}], "\[Transpose]"}], ",", 
          "\[CapitalDelta]", ",", "J"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalL]", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"SuperComm", "[", "H", "]"}]}], "+", "\[ScriptCapitalD]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Initial", " ", "density", " ", "matrix"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", 
         RowBox[{
         "\"\<Data/rhoSS_\>\"", "<>", "fileNameBase", "<>", "\"\<.mat\>\""}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{" ", 
          RowBox[{"\[Rho]", " ", "=", " ", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Sum]", "i"], 
             SubscriptBox["\[Lambda]", "i"]}], "|", 
            SubscriptBox["\[Psi]", "i"]}]}], "\[RightAngleBracket]"}], 
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Psi]", "i"], "|"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[Psi]", "i"], " ", "\[Element]", " ", 
             RowBox[{"Configuration", " ", "basis"}]}], "}"}]}], " "}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Rho]init", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           SuperscriptBox["2.", 
            RowBox[{"-", "n"}]], 
           SubscriptBox["\[ScriptCapitalI]", 
            SuperscriptBox["2", "n"]]}], "]"}]}], ";", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
          "\"\<Data/rhoSS_\>\"", "<>", "fileNameBase", "<>", "\"\<.mat\>\""}],
           ",", "\[Rho]init"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Else", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Rho]init", "=", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{
           "\"\<Data/rhoSS_\>\"", "<>", "fileNameBase", "<>", 
            "\"\<.mat\>\""}], "]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Norm", "[", 
          RowBox[{"\[ScriptCapitalL]", ".", 
           RowBox[{"SparseArray", "[", "\[Rho]init", "]"}]}], "]"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Steady", " ", "state", " ", "by", " ", "time"}], "-", 
       "evolution"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"stateData", "=", 
      RowBox[{
       RowBox[{"processEq", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"\[ScriptCapitalL]", ".", 
             RowBox[{"\[Rho]", "[", "t", "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "\[Rho]init"}]}], 
          "}"}], ",", "\[Rho]", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<ExplicitRungeKutta\>\""}]}], "]"}],
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Basic", " ", "evolution", " ", "block"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evolveState", "[", "t_", "]"}], ":=", "\[IndentingNewLine]", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iterate", "[", 
         RowBox[{"stateData", ",", "t"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]and\[Rho]dot", "=", 
         RowBox[{"processSol", "[", 
          RowBox[{"stateData", ",", "\"\<Forward\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"stateData", "=", 
         RowBox[{
          RowBox[{"reInit", "[", 
           RowBox[{"stateData", ",", 
            RowBox[{"Equal", "@@@", 
             RowBox[{"Most", "[", "\[Rho]and\[Rho]dot", "]"}]}]}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";"}], 
       "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "tol", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"evolveState", "[", "tstep", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NestWhile", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"evolveState", "[", 
           RowBox[{"tstep", "*", "#"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"#", "+", "1"}]}], "\[IndentingNewLine]", ")"}], "&"}], ",",
        "1", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"\[ScriptCapitalL]", ".", 
           RowBox[{"SparseArray", "[", 
            RowBox[{"\[Rho]and\[Rho]dot", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], 
          "]"}], ">", "tol"}], "&"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
       "\"\<Data/rhoSS_\>\"", "<>", "fileNameBase", "<>", "\"\<.mat\>\""}], 
       ",", 
       RowBox[{"\[Rho]and\[Rho]dot", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"\[Rho]and\[Rho]dot", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7828291528928843`*^9, 3.782829181293891*^9}, {
   3.782829426231729*^9, 3.782829484876115*^9}, {3.782855916565639*^9, 
   3.782855970305794*^9}, {3.782887455501051*^9, 3.78288751662991*^9}, {
   3.7828876157572327`*^9, 3.7828876901319923`*^9}, {3.783068516623464*^9, 
   3.78306853734744*^9}, {3.7830686493343363`*^9, 3.78306869972575*^9}, {
   3.783068844964548*^9, 3.78306884658875*^9}, {3.783084597291317*^9, 
   3.783084694202691*^9}, {3.7830847310566*^9, 3.783084832307102*^9}, {
   3.783085055930808*^9, 3.783085081432351*^9}, {3.783085137011656*^9, 
   3.783085186572941*^9}, {3.783085218137106*^9, 3.783085609692523*^9}, {
   3.7830856930825777`*^9, 3.783085724722763*^9}, {3.783085811621882*^9, 
   3.7830858327789288`*^9}, {3.78308587825336*^9, 3.783085936319992*^9}, {
   3.7830860957025633`*^9, 3.783086149973002*^9}, {3.783086221530279*^9, 
   3.783086354163468*^9}, {3.7830864457216063`*^9, 3.7830865138074083`*^9}, 
   3.783086547069351*^9, {3.7830865811505413`*^9, 3.783086582252836*^9}, {
   3.783086747172583*^9, 3.783086763511251*^9}, {3.7830868228503523`*^9, 
   3.783086839518401*^9}, {3.7830870375558453`*^9, 3.783087054828453*^9}, {
   3.783096858077999*^9, 3.783096876175949*^9}, {3.783097235322125*^9, 
   3.7830973491307983`*^9}, {3.783097424358057*^9, 3.7830974800518847`*^9}, {
   3.78309751455659*^9, 3.7830975832345324`*^9}, {3.783097705471697*^9, 
   3.7830977081733303`*^9}, {3.783097843094174*^9, 3.783097894573634*^9}, {
   3.7830981195933437`*^9, 3.783098127764267*^9}, 3.783098293196868*^9, 
   3.783098361394702*^9, 3.7830983954034843`*^9, {3.783098465374058*^9, 
   3.783098476775861*^9}, {3.7830985108501263`*^9, 3.783098524747531*^9}, 
   3.783098614983932*^9, 3.783098673328328*^9, {3.78309875956103*^9, 
   3.783098768816298*^9}, {3.7830988426963043`*^9, 3.7830988503290653`*^9}, {
   3.783099162850154*^9, 3.783099192405312*^9}, {3.783099422595333*^9, 
   3.783099424270269*^9}, {3.783103406944686*^9, 3.783103426757444*^9}, {
   3.783103618345087*^9, 3.783103620500325*^9}, 3.78310458091862*^9, 
   3.783104622646062*^9, {3.783104668350614*^9, 3.7831046701500597`*^9}, {
   3.783104703333069*^9, 3.783104726096702*^9}, {3.783105054538867*^9, 
   3.783105086033441*^9}, {3.7831051254737587`*^9, 3.7831051820208807`*^9}, {
   3.7831052396476717`*^9, 3.783105265958438*^9}, {3.7831055056901617`*^9, 
   3.7831055072933826`*^9}, {3.7831082624008837`*^9, 
   3.7831082827782907`*^9}, {3.7831504056373796`*^9, 3.783150408684968*^9}, {
   3.7831509837388144`*^9, 3.783151161679688*^9}, {3.7831514448330917`*^9, 
   3.783151499190237*^9}, {3.783152159929887*^9, 3.783152172954143*^9}, {
   3.783152205477805*^9, 3.7831522544673643`*^9}, {3.783152696621833*^9, 
   3.783152743959499*^9}, {3.783152778265532*^9, 3.783152783847272*^9}, {
   3.783152852858322*^9, 3.78315286272401*^9}, {3.783152893144904*^9, 
   3.7831530591365843`*^9}, {3.7831531105426493`*^9, 3.783153133647869*^9}, {
   3.78315319510741*^9, 3.783153272184766*^9}, {3.7831533088650007`*^9, 
   3.783153458531764*^9}, {3.783153534559535*^9, 3.7831536383224983`*^9}, {
   3.783153778207362*^9, 3.7831537997659073`*^9}, {3.78315396569816*^9, 
   3.78315400879657*^9}, {3.783154175687912*^9, 3.783154201949449*^9}, {
   3.783154247322703*^9, 3.783154269285852*^9}, {3.783154344253772*^9, 
   3.783154396988422*^9}, {3.783154589451333*^9, 3.783154597471528*^9}, {
   3.78315463804497*^9, 3.7831546843355103`*^9}, {3.783155018791017*^9, 
   3.783155033397129*^9}, {3.7831550956249933`*^9, 3.7831551117388563`*^9}, {
   3.7831552423141537`*^9, 3.783155248140222*^9}, {3.783155342319367*^9, 
   3.783155385450946*^9}, {3.7831554680312862`*^9, 3.783155475264722*^9}, {
   3.7831555188514013`*^9, 3.7831555488014097`*^9}, {3.783155588679491*^9, 
   3.783155634534832*^9}, {3.783155685223617*^9, 3.783155730024666*^9}, {
   3.7831557618699903`*^9, 3.7831557933097563`*^9}, {3.783155862203623*^9, 
   3.783155869580665*^9}, {3.783155976586362*^9, 3.783155992900757*^9}, {
   3.78315631405168*^9, 3.783156326359082*^9}, {3.783156388876137*^9, 
   3.783156405000351*^9}, {3.783156445529078*^9, 3.78315644692563*^9}, {
   3.783156507766644*^9, 3.783156538115696*^9}, {3.783156588196702*^9, 
   3.783156592599183*^9}, {3.783156633834694*^9, 3.783156640316876*^9}, {
   3.783156704770815*^9, 3.7831567050618887`*^9}, 3.783157234537771*^9, 
   3.7831574731804533`*^9, {3.783157551374703*^9, 3.783157590783016*^9}, {
   3.7831576396367607`*^9, 3.7831576401222486`*^9}, {3.7831577601730824`*^9, 
   3.783157813498218*^9}, {3.783158400583791*^9, 3.783158427928356*^9}, {
   3.7833449374682837`*^9, 3.783345011000272*^9}, {3.7833452525632687`*^9, 
   3.78334529240541*^9}, {3.783345570513175*^9, 3.7833455824696302`*^9}, {
   3.783345640794722*^9, 3.783345643629624*^9}, {3.783345680427307*^9, 
   3.783345690691391*^9}, {3.783345802245574*^9, 3.783345803233781*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"43c80013-7644-43fc-b277-d894878cf7c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GeneralFileName", "[", 
   RowBox[{"n_", ",", "g_", ",", "method_", ",", "Jname_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"ToString", "/@", 
     RowBox[{"(", 
      RowBox[{"{", 
       RowBox[{
       "\"\<[N=\>\"", ",", "n", ",", "\"\<][g=\>\"", ",", "g", ",", 
        "\"\<][\[CapitalDelta]=\>\"", ",", "\[CapitalDelta]", ",", 
        "\"\<][method=\>\"", ",", "method", ",", "\"\<]\>\""}], "}"}], 
      ")"}]}], "]"}], "<>", "\"\<[\>\"", "<>", "Jname", "<>", 
   "\"\<]\>\""}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.783358548305542*^9, 3.783358570705552*^9}, {
  3.783358601109838*^9, 3.783358613047832*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"7ad660b8-9c17-4577-957e-583780b90ce3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "8"}], ";", 
   RowBox[{"\[CapitalDelta]", "=", ".1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]0", " ", "=", "5."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"J", "[", 
    RowBox[{"w_", ",", "pm_"}], "]"}], ":=", 
   RowBox[{"Exp", "[", 
    RowBox[{"-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"w", "-", 
          RowBox[{"pm", " ", "\[Omega]0"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1.", "\[Omega]0"}], ")"}]}], ")"}], "^", "2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaussianJ", "=", 
    RowBox[{
     RowBox[{"J", "[", 
      RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LgSweep", "[", "g_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"H", "=", 
        RowBox[{"HAnIsoXY", "[", 
         RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], ",", 
       RowBox[{"\[ScriptCapitalD]", "=", 
        RowBox[{"BlochRedfieldZero\[CapitalDelta]", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Eigensystem", "/@", 
             RowBox[{"H0Blocks", "[", 
              RowBox[{"n", ",", "g"}], "]"}]}], ")"}], "\[Transpose]"}], ",", 
          RowBox[{"1", "&"}]}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       RowBox[{"SuperComm", "[", "H", "]"}]}], "+", "\[ScriptCapitalD]"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gSweepNames", "[", "g_", "]"}], ":=", 
    RowBox[{"GeneralFileName", "[", 
     RowBox[{"n", ",", "g", ",", "\"\<UPD\>\"", ",", "\"\<Gaussian\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ssSweeps", "=", 
    RowBox[{
     RowBox[{"AdiabaticSweep", "[", 
      RowBox[{"LgSweep", ",", "gSweepNames", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3."}], ",", "3.", ",", "1."}], "}"}]}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.783359544228281*^9, 3.783359545226454*^9}, {
   3.783359579578862*^9, 3.7833599027201*^9}, {3.7833602135247517`*^9, 
   3.783360253379147*^9}, {3.783360298422768*^9, 3.78336032282528*^9}, {
   3.783360434817129*^9, 3.7833604350018*^9}, 3.783360494566716*^9, {
   3.7833605792199793`*^9, 3.7833606203524446`*^9}, {3.783360677611903*^9, 
   3.783360707992065*^9}, {3.783361046623981*^9, 3.783361051438301*^9}, {
   3.7833610892142067`*^9, 3.783361092590114*^9}, {3.7833612999201307`*^9, 
   3.7833613884576473`*^9}, 3.7833617410850687`*^9, {3.783361903712961*^9, 
   3.7833619187466373`*^9}, {3.783369464106674*^9, 
   3.783369465678537*^9}},ExpressionUUID->"abe7aacc-3431-4d63-92f1-\
3f1149494658"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SxSxCorrelations", "[", "#", "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], "&"}], "@*", 
    "toHilbert"}], "/@", "\[Rho]ssSweeps"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.783367213504229*^9, 3.783367253504281*^9}, {
  3.7833673361831217`*^9, 3.783367347268229*^9}, {3.7833674281203327`*^9, 
  3.78336744130546*^9}},ExpressionUUID->"fd0340bf-2fce-4e74-9e82-\
2b0449b1e9bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AdiabaticSweep", "[", 
   RowBox[{"LiouvillianFunc_", ",", "NameFunc_", ",", 
    RowBox[{"{", 
     RowBox[{"varMin_", ",", "varMax_", ",", "varStep_"}], "}"}], ",", 
    "flags___"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "stateData", ",", "\[IndentingNewLine]", "\[Rho]init", ",", 
      "\[Rho]and\[Rho]dot", ",", "\[IndentingNewLine]", "H", ",", 
      "\[ScriptCapitalL]", ",", "\[ScriptCapitalD]", ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "FlagsDefault", ",", 
      "\[IndentingNewLine]", "tol", ",", "OverwriteFlag", ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "optFlags", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckpointFlag", "=", 
       RowBox[{"Checkpoint", "\[Rule]", "True"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MaxNormFlag", "=", 
       RowBox[{"MaxNorm", "\[Rule]", "False"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"processEq", "=", "NDSolve`ProcessEquations"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"iterate", "=", "NDSolve`Iterate"}], ",", "\[IndentingNewLine]", 
      RowBox[{"processSol", "=", "NDSolve`ProcessSolutions"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"reInit", "=", "NDSolve`Reinitialize"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "evolveState", ",", 
      RowBox[{"tstep", "=", "0.1"}], ",", "res"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"FLAG", " ", "HANDLING"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FlagsDefault", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MaxNorm", "\[Rule]", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]]}], ",", 
        RowBox[{"Overwrite", "\[Rule]", "False"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tol", ",", "OverwriteFlag"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"MaxNorm", ",", "Overwrite"}], "}"}], "/.", 
        RowBox[{"{", "flags", "}"}]}], "/.", "FlagsDefault"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"INITIALISE", " ", "SOLVER"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalL]", "=", 
      RowBox[{"LiouvillianFunc", "[", "varMin", "]"}]}], ";", 
     RowBox[{"\[Rho]init", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        SuperscriptBox["2.", 
         RowBox[{"-", "n"}]], 
        SubscriptBox["\[ScriptCapitalI]", 
         SuperscriptBox["2", "n"]]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"stateData", "=", 
      RowBox[{
       RowBox[{"processEq", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"\[ScriptCapitalL]", ".", 
             RowBox[{"\[Rho]", "[", "t", "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "\[Rho]init"}]}], 
          "}"}], ",", "\[Rho]", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<ExplicitRungeKutta\>\""}]}], "]"}],
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Basic", " ", "evolution", " ", "block"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evolveState", "[", "t_", "]"}], ":=", "\[IndentingNewLine]", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iterate", "[", 
         RowBox[{"stateData", ",", "t"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]and\[Rho]dot", "=", 
         RowBox[{"processSol", "[", 
          RowBox[{"stateData", ",", "\"\<Forward\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"stateData", "=", 
         RowBox[{
          RowBox[{"reInit", "[", 
           RowBox[{"stateData", ",", 
            RowBox[{"Equal", "@@@", 
             RowBox[{"Most", "[", "\[Rho]and\[Rho]dot", "]"}]}]}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";"}], 
       "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"LOOP", " ", "OVER", " ", "SWEEP", " ", "VARIABLES"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Reap", "[", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"evolveState", "[", "tstep", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"NestWhile", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"evolveState", "[", 
                 RowBox[{"tstep", "*", "#"}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"#", "+", "1"}]}], "\[IndentingNewLine]", ")"}], 
              "&"}], ",", "1", ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "<", "15"}], "||", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"\[ScriptCapitalL]", ".", 
                   RowBox[{"SparseArray", "[", 
                    RowBox[{"\[Rho]and\[Rho]dot", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
                    "]"}]}], "]"}], ">", "tol"}]}], ")"}], "&"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Sow", "[", 
            RowBox[{"\[Rho]and\[Rho]dot", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"\"\<Data/rhoSS_\>\"", "<>", 
              RowBox[{"NameFunc", "[", "var", "]"}], "<>", "\"\<.mat\>\""}], 
             ",", 
             RowBox[{"\[Rho]and\[Rho]dot", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"Norm", "[", 
             RowBox[{"\[ScriptCapitalL]", ".", 
              RowBox[{"SparseArray", "[", 
               RowBox[{"\[Rho]and\[Rho]dot", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], 
             "]"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"\[ScriptCapitalL]", "=", 
            RowBox[{"LiouvillianFunc", "[", "var", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"stateData", "=", 
            RowBox[{
             RowBox[{"processEq", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
                  RowBox[{"\[ScriptCapitalL]", ".", 
                   RowBox[{"\[Rho]", "[", "t", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", 
                  RowBox[{"\[Rho]and\[Rho]dot", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
                "}"}], ",", "\[Rho]", ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
               RowBox[{"Method", "\[Rule]", "\"\<ExplicitRungeKutta\>\""}]}], 
              "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"END", " ", "DO"}], " ", "*)"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"{", 
           RowBox[{"var", ",", 
            RowBox[{"varMin", "+", "varStep"}], ",", "varMax", ",", 
            "varStep"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "res", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.783347119446594*^9, 3.783347124812447*^9}, {
   3.783357757981876*^9, 3.783357759055319*^9}, {3.783358122393333*^9, 
   3.783358187303258*^9}, 3.783358275756143*^9, {3.783358362683175*^9, 
   3.783358515617996*^9}, {3.783358722034608*^9, 3.783358767346072*^9}, {
   3.783358799004838*^9, 3.783358850296235*^9}, {3.7833589702904882`*^9, 
   3.78335902395366*^9}, {3.783359321964085*^9, 3.783359351336958*^9}, {
   3.783359410687437*^9, 3.783359476533242*^9}, {3.7833595116708317`*^9, 
   3.783359511780113*^9}, {3.783359920479108*^9, 3.7833600075452213`*^9}, {
   3.783360048222693*^9, 3.783360105154396*^9}, {3.7833601576561623`*^9, 
   3.7833602031624947`*^9}, {3.783360869800233*^9, 3.7833608702449827`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"ae26c2f1-fcca-4ca1-bd37-d40a6c137e85"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparing Arnoldi with converge time evolution", "Subsection",
 CellChangeTimes->{{3.7831628456312723`*^9, 
  3.783162855175373*^9}},ExpressionUUID->"f94a1f3a-8e76-44b2-b1e1-\
8b3d5a7c667f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "\[ScriptCapitalL]", ",", "H", ",", "\[ScriptCapitalL]UPD", ",", 
    "\[ScriptCapitalL]Lind"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]0", " ", "=", "5."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"J", "[", 
     RowBox[{"w_", ",", "pm_"}], "]"}], ":=", 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"w", "-", 
           RowBox[{"pm", " ", "\[Omega]0"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1.", "\[Omega]0"}], ")"}]}], ")"}], "^", "2"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "3"}], ";", 
   RowBox[{"g", "=", 
    RowBox[{"-", "1."}]}], ";", 
   RowBox[{"\[CapitalDelta]", "=", ".5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GaussianJ", "=", 
   RowBox[{
    RowBox[{"J", "[", 
     RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "=", 
    RowBox[{"HAnIsoXY", "[", 
     RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"\[ScriptCapitalL]UPD", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "I"}], " ", 
     RowBox[{"SuperComm", "[", "H", "]"}]}], "+", 
    RowBox[{"BlochRedfieldZero\[CapitalDelta]", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Eigensystem", "/@", 
         RowBox[{"H0Blocks", "[", 
          RowBox[{"n", ",", "g"}], "]"}]}], ")"}], "\[Transpose]"}], ",", 
      "GaussianJ"}], "]"}]}]}], ";", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[ScriptCapitalL]Lind", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       RowBox[{"SuperComm", "[", "H", "]"}]}], "+", 
      RowBox[{"Total", "[", 
       RowBox[{"Lindblad", "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Tensor", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Piecewise", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Sigmam", ",", 
                  RowBox[{"i", "\[Equal]", "j"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Id", ",", "True"}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], "]"}]}]}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.783083905045539*^9, 3.7830839084735813`*^9}, {
   3.783086288428031*^9, 3.783086290012047*^9}, {3.783086569165225*^9, 
   3.783086596263172*^9}, {3.783086704681563*^9, 3.783086709790697*^9}, {
   3.7830981467127943`*^9, 3.7830981517604847`*^9}, {3.7830985338413887`*^9, 
   3.7830985352970753`*^9}, {3.7830987769888363`*^9, 3.783098777115489*^9}, {
   3.783098823541718*^9, 3.783098826425948*^9}, {3.7830988871906633`*^9, 
   3.783098887464744*^9}, {3.7830989679711246`*^9, 3.7830989761998262`*^9}, {
   3.783099057384674*^9, 3.783099058771908*^9}, {3.783104524927709*^9, 
   3.7831045406783447`*^9}, 3.783104574953673*^9, {3.7831521800158453`*^9, 
   3.783152188307209*^9}, {3.783152793054006*^9, 3.783152802228853*^9}, {
   3.7831551429547157`*^9, 3.783155151998105*^9}, {3.783155302101454*^9, 
   3.783155318835621*^9}, {3.783155440352139*^9, 3.783155447469496*^9}, 
   3.7831559246532288`*^9, {3.783156426931645*^9, 3.783156434782652*^9}, 
   3.783156689238764*^9, 3.7831567750199842`*^9, {3.783157063728012*^9, 
   3.783157067894001*^9}, {3.783157149150024*^9, 3.783157154099547*^9}, {
   3.783157453695736*^9, 3.78315745605567*^9}, {3.783157510663927*^9, 
   3.783157519115807*^9}, {3.783157650330586*^9, 3.78315765235141*^9}, {
   3.7831576913661547`*^9, 3.783157696121969*^9}, {3.783157851593635*^9, 
   3.783157856688697*^9}, {3.783157897893773*^9, 3.7831579004033737`*^9}, {
   3.783158050356453*^9, 3.7831580538886547`*^9}, {3.783158089746423*^9, 
   3.783158090194785*^9}, {3.783158183739694*^9, 3.783158202909939*^9}, {
   3.783158308794859*^9, 3.783158333023593*^9}, {3.783158375613674*^9, 
   3.783158396514531*^9}, 3.783158474393201*^9, {3.783158517708271*^9, 
   3.783158527460143*^9}, {3.783158757169979*^9, 3.783158760940827*^9}, {
   3.78315895163802*^9, 3.783158954502438*^9}, {3.7831629381527653`*^9, 
   3.783162939568265*^9}, 3.7831659137043133`*^9, 3.783266952645721*^9, {
   3.783267108510345*^9, 3.783267128910021*^9}, {3.7832673606924133`*^9, 
   3.783267401275185*^9}, {3.7832677916426992`*^9, 3.783267872915245*^9}, {
   3.7832685970796957`*^9, 3.7832686889081497`*^9}, 3.783268837793185*^9, {
   3.78326897664786*^9, 3.783268981252184*^9}, {3.7832695091441708`*^9, 
   3.783269509319796*^9}, {3.783270806283532*^9, 3.7832708345531807`*^9}, {
   3.783272323093739*^9, 3.783272341976124*^9}, 3.783345525594698*^9},
 CellLabel->"In[69]:=",ExpressionUUID->"965effd0-03fe-473b-90f9-72582c7ce6dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ssArnoldi", "=", 
    RowBox[{"Eigenvectors", "[", 
     RowBox[{"\[ScriptCapitalL]Lind", ",", "1", ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Arnoldi\>\"", ",", 
         RowBox[{"\"\<Criteria\>\"", "\[Rule]", "\"\<RealPart\>\""}], ",", 
         RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "100"}]}], "}"}]}]}], 
     "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Rho]ssArnoldi", "=", 
     RowBox[{"\[Rho]ss", "[", 
      RowBox[{
      "n", ",", "g", ",", "\[CapitalDelta]", ",", "GaussianJ", ",", 
       "\"\<UnperturbedDissipator\>\""}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Norm", "[", 
    RowBox[{"\[ScriptCapitalL]Lind", ".", 
     RowBox[{"Vectorise", "[", "\[Rho]ssArnoldi", "]"}]}], "]"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.783083905045539*^9, 3.7830839084735813`*^9}, {
   3.783086288428031*^9, 3.783086290012047*^9}, {3.783086569165225*^9, 
   3.783086596263172*^9}, {3.783086704681563*^9, 3.783086709790697*^9}, {
   3.7830981467127943`*^9, 3.7830981517604847`*^9}, {3.7830985338413887`*^9, 
   3.7830985352970753`*^9}, {3.7830987769888363`*^9, 3.783098777115489*^9}, {
   3.783098823541718*^9, 3.783098826425948*^9}, {3.7830988871906633`*^9, 
   3.783098887464744*^9}, {3.7830989679711246`*^9, 3.7830989761998262`*^9}, {
   3.783099057384674*^9, 3.783099058771908*^9}, {3.783104524927709*^9, 
   3.7831045406783447`*^9}, 3.783104574953673*^9, {3.7831521800158453`*^9, 
   3.783152188307209*^9}, {3.783152793054006*^9, 3.783152802228853*^9}, {
   3.7831551429547157`*^9, 3.783155151998105*^9}, {3.783155302101454*^9, 
   3.783155318835621*^9}, {3.783155440352139*^9, 3.783155447469496*^9}, 
   3.7831559246532288`*^9, {3.783156426931645*^9, 3.783156434782652*^9}, 
   3.783156689238764*^9, 3.7831567750199842`*^9, {3.783157063728012*^9, 
   3.783157067894001*^9}, {3.783157149150024*^9, 3.783157154099547*^9}, {
   3.783157453695736*^9, 3.78315745605567*^9}, {3.783157510663927*^9, 
   3.783157519115807*^9}, {3.783157650330586*^9, 3.78315765235141*^9}, {
   3.7831576913661547`*^9, 3.783157696121969*^9}, {3.783157851593635*^9, 
   3.783157856688697*^9}, {3.783157897893773*^9, 3.7831579004033737`*^9}, {
   3.783158050356453*^9, 3.7831580538886547`*^9}, {3.783158089746423*^9, 
   3.783158090194785*^9}, {3.783158183739694*^9, 3.783158202909939*^9}, {
   3.783158308794859*^9, 3.783158333023593*^9}, {3.783158375613674*^9, 
   3.783158396514531*^9}, 3.783158474393201*^9, {3.783158517708271*^9, 
   3.783158527460143*^9}, {3.783158757169979*^9, 3.783158760940827*^9}, {
   3.78315895163802*^9, 3.783158954502438*^9}, {3.7831629381527653`*^9, 
   3.783162939568265*^9}, 3.7831659137043133`*^9, 3.783266952645721*^9, {
   3.783267108510345*^9, 3.783267128910021*^9}, {3.7832673606924133`*^9, 
   3.783267401275185*^9}, {3.7832677916426992`*^9, 3.783267872915245*^9}, {
   3.7832685970796957`*^9, 3.7832686889081497`*^9}, 3.783268837793185*^9, {
   3.78326897664786*^9, 3.783268981252184*^9}, {3.7832695091441708`*^9, 
   3.783269509319796*^9}, {3.783270806283532*^9, 3.783270846043853*^9}, 
   3.783271278692609*^9},ExpressionUUID->"e133774f-e27b-4e8b-b884-\
7d1b2cff3261"],

Cell[BoxData["n"], "Input",
 CellChangeTimes->{3.7833455207607193`*^9},
 CellLabel->
  "In[750]:=",ExpressionUUID->"0de1c1f9-731b-49f9-af23-26bb305b1c99"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"RandomMats", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.783173231013015*^9, 
  3.783173290617934*^9}},ExpressionUUID->"30080d96-f31d-49da-87ef-\
390a1a44616b"],

Cell[BoxData[
 RowBox[{"\[Rho]ssvsgflat6", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"SteadyTimeEvo", "[", 
     RowBox[{"n", ",", "g", ",", "\[CapitalDelta]", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Flat\>\"", ",", 
        RowBox[{"1", "&"}]}], "}"}], ",", "\"\<UnperturbedDissipator\>\"", 
      ",", 
      RowBox[{"MaxNorm", "\[Rule]", 
       SuperscriptBox["10", 
        RowBox[{"-", "3"}]]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"g", ",", "3.", ",", 
      RowBox[{"-", "3."}], ",", 
      RowBox[{"-", ".1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7831657280483103`*^9, 3.783165734887395*^9}, {
   3.783345348077632*^9, 3.783345433810195*^9}, {3.783345470133862*^9, 
   3.783345470442383*^9}, {3.783345537518167*^9, 3.783345545336153*^9}, 
   3.7833456597633057`*^9, 3.783345750615183*^9, {3.783345784610526*^9, 
   3.783345790954381*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"35649eda-304a-4e1a-bc03-2cec70bcad95"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SigmaxSites", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Tensor", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Sigmax", ",", 
             RowBox[{"i", "\[Equal]", "j"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Id", ",", "True"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"NNCorrelation", "=", 
   RowBox[{
    RowBox[{"Tr", "[", 
     RowBox[{
      RowBox[{"SigmaxSites", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ".", 
      RowBox[{"SigmaxSites", "[", 
       RowBox[{"[", "4", "]"}], "]"}], ".", "#"}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CorrelationsvsG", "=", 
   RowBox[{"NNCorrelation", "/@", "\[Rho]ssvsg"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CorrelationsvsGflat", "=", 
   RowBox[{"NNCorrelation", "/@", "\[Rho]ssvsgflat"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"CorrelationsvsG", ",", "CorrelationsvsGflat"}], "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", "Thick"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.783165323978598*^9, 3.7831653411273203`*^9}, {
  3.783165375754282*^9, 3.783165649966758*^9}, {3.783165751644918*^9, 
  3.783165780537274*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"7c62a476-d577-4105-b171-a8c1e609ba40"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.783157165997876*^9, 
  3.783157166704536*^9}},ExpressionUUID->"4f683885-76bb-4b0d-91da-\
3df405b7d717"]
}, Closed]],

Cell[CellGroupData[{

Cell["Data gathering functionality", "Subsection",
 CellChangeTimes->{{3.781425869430059*^9, 
  3.7814258760347967`*^9}},ExpressionUUID->"343dabf3-2152-4b94-95bf-\
ebb36f396c8c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Protect", "[", "Overwrite", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SaveDataCall", "[", 
     RowBox[{"fTemplate_", ",", "ArgList_", ",", "flags___"}], "]"}], ":=", 
    RowBox[{"Block", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "FileName", ",", "\[IndentingNewLine]", "FunctionName", ",", 
        "\[IndentingNewLine]", "ArgSymbs", ",", "\[IndentingNewLine]", 
        "CallRules", ",", "\[IndentingNewLine]", "ArgsEq", ",", 
        "\[IndentingNewLine]", "FlagsDefault", ",", "OverwriteFlag", ",", 
        "\[IndentingNewLine]", "out"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FlagsDefault", "=", 
        RowBox[{"{", 
         RowBox[{"Overwrite", "\[Rule]", "False"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "OverwriteFlag", "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "Overwrite", "}"}], "/.", 
          RowBox[{"{", "flags", "}"}]}], "/.", "FlagsDefault"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "fTemplate", "]"}], "===", "HoldForm"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"FunctionName", ",", "ArgSymbs"}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "0"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ReleaseHold", "@@", 
                RowBox[{"(", 
                 RowBox[{"Hold", "@@@", "#"}], ")"}]}], "}"}]}], "}"}], "&"}],
            "@", "fTemplate"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FunctionName", "=", 
           RowBox[{"Head", "[", "fTemplate", "]"}]}], ";", 
          RowBox[{"ArgSymbs", "=", 
           RowBox[{"List", "@@", "fTemplate"}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"CallRules", "=", 
        RowBox[{"Thread", "[", 
         RowBox[{"ArgSymbs", "\[Rule]", "ArgList"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ArgsEq", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<=\>\""}], ")"}], 
          "&"}], "/@", "ArgSymbs"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"FileName", "=", 
        RowBox[{
         RowBox[{"ToString", "[", "FunctionName", "]"}], "<>", "\"\<(\>\"", "<>", 
         RowBox[{"Riffle", "[", 
          RowBox[{"ArgsEq", ",", 
           RowBox[{"ToString", "/@", "ArgList"}]}], "]"}], "<>", 
         "\"\<).mat\>\""}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"!", 
           RowBox[{"FileExistsQ", "[", "FileName", "]"}]}], "||", 
          "OverwriteFlag"}], ",", "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{
           RowBox[{"Reap", "[", 
            RowBox[{"Export", "[", 
             RowBox[{"FileName", ",", 
              RowBox[{"Sow", "[", 
               RowBox[{
                RowBox[{"fTemplate", "/.", "CallRules"}], "//", 
                "ReleaseHold"}], "]"}], ",", "\"\<MTX\>\""}], "]"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{"Import", "[", 
           RowBox[{"FileName", ",", "\"\<MTX\>\""}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "out"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SaveDataCallRange", "[", 
    RowBox[{"f_", ",", "ArgsLists_", ",", "flags___"}], "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ArgSymbs", "=", 
        RowBox[{"ArgsLists", "\[LeftDoubleBracket]", 
         RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Labels", " ", "defining", " ", "each", " ", "of", " ", "the", " ", 
         "ranges"}], "*)"}], "\[IndentingNewLine]", "FileNamesFromArgs", ",", 
       "\[IndentingNewLine]", "AllFileNames", ",", "\[IndentingNewLine]", 
       "EvaluateWithArgs", ",", "\[IndentingNewLine]", "FlagsList", ",", 
       "ArgsEq", ",", "\[IndentingNewLine]", "NonExistentFiles", ",", 
       "\[IndentingNewLine]", "AllArgsValues", ",", "\[IndentingNewLine]", 
       "TuplesToCalculate", ",", "\[IndentingNewLine]", "FlagsDefault", ",", 
       "\[IndentingNewLine]", "OverwriteFlag"}], "\[IndentingNewLine]", "}"}],
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Flag", " ", 
       RowBox[{"handling", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FlagsDefault", "=", 
       RowBox[{"{", 
        RowBox[{"Overwrite", "\[Rule]", "False"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "OverwriteFlag", "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "Overwrite", "}"}], "/.", 
         RowBox[{"{", "flags", "}"}]}], "/.", "FlagsDefault"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ArgsEq", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<=\>\""}], ")"}], 
         "&"}], "/@", "ArgSymbs"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FileNamesFromArgs", "[", "Args__", "]"}], ":=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", "f", "]"}], "<>", "\"\<(\>\"", "<>", 
          RowBox[{"Riffle", "[", 
           RowBox[{"ArgsEq", ",", 
            RowBox[{"ToString", "/@", "ArgSymbs"}]}], "]"}], "<>", 
          "\"\<).mat\>\""}], ",", "Args"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AllFileNames", "=", 
       RowBox[{"FileNamesFromArgs", "@@", "ArgsLists"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "AllFileNames", "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"NonExistentFiles", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "AllFileNames", "]"}], ",", 
         RowBox[{"Not", "@*", "FileExistsQ"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Find", " ", "the", " ", "positions", " ", "in", " ", "the", " ", 
        "full", " ", "list", " ", "which", " ", "have", " ", "not", " ", 
        "been", " ", "calculated", " ", "and", " ", "calculate", " ", "the", 
        " ", "tuples", " ", "of", " ", "arguments", " ", "that", " ", "these",
         " ", "positions", " ", "correspond", " ", 
        RowBox[{"to", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"AllArgsValues", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"ArgSymbs", ",", "##"}], "]"}], "&"}], "@@", 
        "ArgsLists"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TuplesToCalculate", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"AllArgsValues", ",", "##"}], "]"}], "&"}], "@@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"AllFileNames", ",", "#"}], "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}], "/@",
           "NonExistentFiles"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"OverwriteFlag", ",", "\[IndentingNewLine]", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Export", "[", 
             RowBox[{"#1", ",", 
              RowBox[{"f", "@@", "#2"}], ",", "\"\<MTX\>\""}], "]"}], ")"}], 
           "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"AllFileNames", ",", "AllArgsValues"}], "}"}], ",", "2"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Export", "[", 
             RowBox[{"#1", ",", 
              RowBox[{"f", "@@", "#2"}], ",", "\"\<MTX\>\""}], "]"}], ")"}], 
           "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"NonExistentFiles", ",", "TuplesToCalculate"}], "}"}]}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.781274378121982*^9, 3.781274461696096*^9}, {
   3.781274838515991*^9, 3.78127484315383*^9}, {3.781276738230618*^9, 
   3.781276751549059*^9}, {3.781276798964188*^9, 3.7812768138608427`*^9}, {
   3.781276873760797*^9, 3.781276875705969*^9}, {3.7812769988586082`*^9, 
   3.781277048721919*^9}, {3.781277630313923*^9, 3.7812777085309477`*^9}, {
   3.78127775393062*^9, 3.781277762360713*^9}, {3.781277797982465*^9, 
   3.781277803436461*^9}, {3.781277850931067*^9, 3.7812778680942307`*^9}, {
   3.7812780630406713`*^9, 3.781278088046196*^9}, {3.7812782751593533`*^9, 
   3.781278299990284*^9}, {3.781278676237074*^9, 3.781278705856284*^9}, {
   3.781278791296719*^9, 3.781278854855954*^9}, {3.781278935188945*^9, 
   3.781278945237196*^9}, {3.781279011457851*^9, 3.781279051080929*^9}, {
   3.781279124311448*^9, 3.7812791289695253`*^9}, {3.781279247601451*^9, 
   3.781279261138678*^9}, 3.781279786917226*^9, {3.781280056417066*^9, 
   3.7812800572585783`*^9}, {3.781280497256978*^9, 3.781280498075212*^9}, {
   3.781281116150032*^9, 3.781281125170144*^9}, 3.78128143738078*^9, {
   3.781282813103085*^9, 3.7812828447213373`*^9}, {3.7812828975584497`*^9, 
   3.781282993149026*^9}, {3.7812830400232697`*^9, 3.78128314150737*^9}, {
   3.781283472546233*^9, 3.781283488964385*^9}, 3.7812837322252073`*^9, 
   3.7812852739981937`*^9, 3.781285484609177*^9, {3.781287493069621*^9, 
   3.7812874933171167`*^9}, {3.7812875901316967`*^9, 3.781287596825992*^9}, {
   3.781287833624275*^9, 3.781287847873433*^9}, {3.7812889712193317`*^9, 
   3.7812889776787043`*^9}, {3.7812893257805557`*^9, 3.781289351275126*^9}, {
   3.781343052368279*^9, 3.781343146471552*^9}, 3.7813432292555943`*^9, {
   3.781343271390286*^9, 3.781343282226903*^9}, {3.7813433524546432`*^9, 
   3.781343394226404*^9}, {3.7813434548140583`*^9, 3.781343476060143*^9}, {
   3.781343514013741*^9, 3.781343606224297*^9}, {3.7813436899196243`*^9, 
   3.781343695277812*^9}, {3.781343731226926*^9, 3.781343761511498*^9}, {
   3.7813438164533377`*^9, 3.781343854720549*^9}, {3.781344077397855*^9, 
   3.781344150790822*^9}, {3.7813442173672533`*^9, 3.78134423082342*^9}, {
   3.781344995364298*^9, 3.781345000973284*^9}, {3.781345042950255*^9, 
   3.7813450662254887`*^9}, 3.7813489209140787`*^9, {3.781348955197316*^9, 
   3.781348959695629*^9}, {3.7813677541445*^9, 3.7813680010527363`*^9}, {
   3.781368042332902*^9, 3.781368067535735*^9}, {3.7813682114496593`*^9, 
   3.781368252984568*^9}, 3.7813683084354*^9, {3.78136844832623*^9, 
   3.781368453802429*^9}, 3.7813685789208393`*^9, 3.7814207087173223`*^9, {
   3.78142625616409*^9, 3.781426298712071*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"8aaa1765-51db-4a61-b9e8-94a882b5b0c4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting functionality", "Subsection",
 CellChangeTimes->{{3.7815916758362427`*^9, 3.781591680992939*^9}, 
   3.782023857956113*^9},ExpressionUUID->"b25173a5-afb1-47ba-a389-\
d90ec3e8d6d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatexListPlot", "[", 
   RowBox[{"data_", ",", "opts___"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newopts", "=", 
       RowBox[{
        RowBox[{"{", "opts", "}"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x_", "?", "StringQ"}], "\[RuleDelayed]", 
          RowBox[{"MaTeX", "[", "x", "]"}]}], "}"}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TicksOpts", "=", 
       RowBox[{
        RowBox[{"AbsoluteOptions", "[", 
         RowBox[{
          RowBox[{"ListPlot", "[", "data", "]"}], ",", "Ticks"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", ":", 
           RowBox[{"{", 
            RowBox[{"a_", ",", "x_", ",", 
             RowBox[{"b", ":", 
              RowBox[{"{", 
               RowBox[{"_", ",", "_"}], "}"}]}], ",", 
             RowBox[{"c", ":", 
              RowBox[{"{", 
               RowBox[{"_", ",", "_"}], "}"}]}]}], "}"}]}], "\[RuleDelayed]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", "===", "Null"}], ",", "T", ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", 
              RowBox[{"MaTeX", "[", 
               RowBox[{"ToString", "[", "x", "]"}], "]"}], ",", "b", ",", 
              "c"}], "}"}]}], "]"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Doesn", "'"}], "t", " ", "always", " ", "give", " ", 
        RowBox[{"precise", " ", "'"}], 
        RowBox[{"Automatic", "'"}], " ", "option"}], ",", " ", 
       RowBox[{
       "probably", " ", "best", " ", "to", " ", "just", " ", "construct", " ",
         "my", " ", "own", " ", "ticks", " ", 
        RowBox[{"function", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{"data", ",", "##"}], "]"}], "&"}], "@", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newopts", ",", "TicksOpts"}], "}"}], ",", "1"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.781591885663968*^9, 3.7815918887317038`*^9}, {
   3.7815969107825327`*^9, 3.781596929236431*^9}, {3.781597092709687*^9, 
   3.781597133343102*^9}, {3.781597225567471*^9, 3.78159724774177*^9}, {
   3.781612367725615*^9, 3.781612390957088*^9}, {3.781612612621313*^9, 
   3.781612632082176*^9}, {3.781612676987221*^9, 3.781612683195204*^9}, 
   3.781623623023291*^9, {3.781781518552497*^9, 3.7817815461344013`*^9}, {
   3.781781579267967*^9, 3.7817815987508*^9}, {3.781781665472472*^9, 
   3.7817816898873158`*^9}, {3.7817817801024942`*^9, 3.781781833096621*^9}, {
   3.781781975977775*^9, 3.7817819780445747`*^9}, {3.781782010291094*^9, 
   3.781782035589822*^9}, {3.781782065785594*^9, 3.781782116150229*^9}, {
   3.781782225772066*^9, 3.781782301852434*^9}, {3.782023873244899*^9, 
   3.782023901232925*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"3a54e072-2c07-4880-b8c9-8e4fb4c2886a"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Two-time correlation functions of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "ss"], TraditionalForm]],ExpressionUUID->
  "7c0e87cc-2eec-4d97-a198-1f8fbea816d8"]
}], "Section",
 CellChangeTimes->{{3.784465120701583*^9, 
  3.7844651380722*^9}},ExpressionUUID->"de539516-c5fe-41a1-be15-f9d2b7ff7489"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TwoTimeCorrelator", "[", 
   RowBox[{
   "\[Rho]ss_", ",", "\[ScriptCapitalL]_", ",", "X_", ",", "Y_", ",", 
    "tstep_", ",", "tmax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "stateDataL", ",", "stateDataR", ",", "\[IndentingNewLine]", 
      "\[Rho]init", ",", "\[Rho]and\[Rho]dotL", ",", "\[Rho]and\[Rho]dotR", 
      ",", "\[IndentingNewLine]", "H", ",", "\[ScriptCapitalD]", ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "FlagsDefault", ",", 
      "\[IndentingNewLine]", "tol", ",", "OverwriteFlag", ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "optFlags", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"CheckpointFlag", "=", 
       RowBox[{"Checkpoint", "\[Rule]", "True"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MaxNormFlag", "=", 
       RowBox[{"MaxNorm", "\[Rule]", "False"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"processEq", "=", "NDSolve`ProcessEquations"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"iterate", "=", "NDSolve`Iterate"}], ",", "\[IndentingNewLine]", 
      RowBox[{"processSol", "=", "NDSolve`ProcessSolutions"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"reInit", "=", "NDSolve`Reinitialize"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "evolveState", ",", "res",
       ",", 
      RowBox[{"tCurr", "=", "0."}], ",", "i"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"stateDataL", "=", 
      RowBox[{
       RowBox[{"processEq", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"\[ScriptCapitalL]", ".", 
             RowBox[{"\[Rho]", "[", "t", "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"SuperLR", "[", 
              RowBox[{"Y", ",", 
               SubscriptBox["\[ScriptCapitalI]", 
                RowBox[{"Y", "//", "Length"}]]}], "]"}], ".", 
             "\[Rho]ss"}]}]}], "}"}], ",", "\[Rho]", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<ExplicitRungeKutta\>\""}]}], "]"}],
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stateDataR", "=", 
      RowBox[{
       RowBox[{"processEq", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"\[ScriptCapitalL]", ".", 
             RowBox[{"\[Rho]", "[", "t", "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"SuperLR", "[", 
              RowBox[{
               SubscriptBox["\[ScriptCapitalI]", 
                RowBox[{"Y", "//", "Length"}]], ",", "Y"}], "]"}], ".", 
             "\[Rho]ss"}]}]}], "}"}], ",", "\[Rho]", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<ExplicitRungeKutta\>\""}]}], "]"}],
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Basic", " ", "evolution", " ", "block"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evolveState", "[", "t_", "]"}], ":=", "\[IndentingNewLine]", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iterate", "[", 
         RowBox[{"stateDataL", ",", "t"}], "]"}], ";", 
        RowBox[{"iterate", "[", 
         RowBox[{"stateDataR", ",", "t"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]and\[Rho]dotL", "=", 
         RowBox[{"processSol", "[", 
          RowBox[{"stateDataL", ",", "\"\<Forward\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Rho]and\[Rho]dotR", "=", 
         RowBox[{"processSol", "[", 
          RowBox[{"stateDataR", ",", "\"\<Forward\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"stateDataL", "=", 
         RowBox[{
          RowBox[{"reInit", "[", 
           RowBox[{"stateDataL", ",", 
            RowBox[{"Equal", "@@@", 
             RowBox[{"Most", "[", "\[Rho]and\[Rho]dotL", "]"}]}]}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"stateDataR", "=", 
         RowBox[{
          RowBox[{"reInit", "[", 
           RowBox[{"stateDataR", ",", 
            RowBox[{"Equal", "@@@", 
             RowBox[{"Most", "[", "\[Rho]and\[Rho]dotR", "]"}]}]}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";"}], 
       "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Reap", "[", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"tCurr", "\[LessEqual]", "tmax"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"evolveState", "[", 
            RowBox[{"tstep", "*", "i"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"i", "++"}], ";", 
           RowBox[{"tCurr", "+=", "tstep"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{
              RowBox[{"S", 
               RowBox[{"(", "t", ")"}]}], " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"\[LeftAngleBracket]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"X", 
                    RowBox[{"(", "t", ")"}]}], ",", " ", 
                   RowBox[{"X", 
                    RowBox[{"(", "0", ")"}]}]}], "}"}], 
                 "\[RightAngleBracket]"}], "/", "2"}], " ", "=", " ", 
               RowBox[{
                RowBox[{"Tr", "[", 
                 RowBox[{
                  RowBox[{"X", 
                   RowBox[{
                    RowBox[{"(", "t", ")"}], ".", "Y"}], 
                   RowBox[{
                    RowBox[{"(", "0", ")"}], ".", "\[Rho]"}]}], " ", "+", " ", 
                  RowBox[{"Y", 
                   RowBox[{
                    RowBox[{"(", "0", ")"}], ".", "X"}], 
                   RowBox[{
                    RowBox[{"(", "t", ")"}], ".", "\[Rho]"}]}]}], "]"}], "/", 
                "2"}]}]}], " ", ";", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Chi]", "''"}], 
               RowBox[{"(", "t", ")"}]}], " ", "=", " ", 
              RowBox[{
               RowBox[{"\[ImaginaryI]", 
                RowBox[{"\[LeftAngleBracket]", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"X", 
                    RowBox[{"(", "t", ")"}]}], ",", " ", 
                   RowBox[{"X", 
                    RowBox[{"(", "0", ")"}]}]}], "]"}], 
                 "\[RightAngleBracket]"}]}], " ", "=", " ", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"Tr", "[", 
                 RowBox[{
                  RowBox[{"X", 
                   RowBox[{
                    RowBox[{"(", "t", ")"}], ".", "Y"}], 
                   RowBox[{
                    RowBox[{"(", "0", ")"}], ".", "\[Rho]"}]}], " ", "-", " ", 
                  RowBox[{"Y", 
                   RowBox[{
                    RowBox[{"(", "0", ")"}], ".", "X"}], 
                   RowBox[{
                    RowBox[{"(", "t", ")"}], ".", "\[Rho]"}]}]}], 
                 "]"}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Sow", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Tr", "[", 
                RowBox[{
                 RowBox[{"X", ".", 
                  RowBox[{"toHilbert", "[", 
                   RowBox[{"\[Rho]and\[Rho]dotL", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "]"}]}], "+", 
                 RowBox[{"X", ".", 
                  RowBox[{"toHilbert", "[", 
                   RowBox[{"\[Rho]and\[Rho]dotR", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "]"}]}]}], "]"}], "/", "2"}], ",", "\[IndentingNewLine]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"Tr", "[", 
                RowBox[{
                 RowBox[{"X", ".", 
                  RowBox[{"toHilbert", "[", 
                   RowBox[{"\[Rho]and\[Rho]dotL", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "]"}]}], "-", 
                 RowBox[{"X", ".", 
                  RowBox[{"toHilbert", "[", 
                   RowBox[{"\[Rho]and\[Rho]dotR", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "}"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
        "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], 
      "\[Transpose]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.784465141761426*^9, 3.784465268118477*^9}, {
   3.784465357587553*^9, 3.78446539769711*^9}, 3.784465533370873*^9, {
   3.7844659027958403`*^9, 3.784465914622795*^9}, {3.784465960336379*^9, 
   3.784465960642221*^9}, {3.784466006087378*^9, 3.7844660850579023`*^9}, {
   3.784466125483399*^9, 3.78446634299431*^9}, 3.784466793673217*^9, {
   3.7844668258156023`*^9, 3.784466827077031*^9}, {3.7844674511890697`*^9, 
   3.784467520459611*^9}, {3.784467608075099*^9, 3.784467634134893*^9}, {
   3.784467679741336*^9, 3.784467686223639*^9}, 3.784468037137827*^9, {
   3.7844680741823*^9, 3.78446810829317*^9}, {3.784468147384618*^9, 
   3.7844681806530323`*^9}, {3.784468390766947*^9, 3.7844684021774282`*^9}, 
   3.7845350961802063`*^9, {3.7846181394915323`*^9, 3.784618161858081*^9}, {
   3.7846185019131393`*^9, 3.784618826953167*^9}, {3.784619052318186*^9, 
   3.7846190771965427`*^9}, {3.7846191426044292`*^9, 3.784619319687223*^9}, {
   3.784791612607904*^9, 3.78479161987814*^9}, {3.785011919688582*^9, 
   3.7850119232078257`*^9}},ExpressionUUID->"a4a093d4-1a5a-4e18-9fb0-\
44b0dffe2d33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"my\[ScriptCapitalL]", "[", 
     RowBox[{"n_", ",", "g_", ",", "\[CapitalDelta]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"SuperComm", "[", 
       RowBox[{"HAnIsoXY", "[", 
        RowBox[{"n", ",", "g", ",", "\[CapitalDelta]"}], "]"}], "]"}]}], "+", 
     RowBox[{"BlochRedfieldZero\[CapitalDelta]", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"(", 
         RowBox[{"Eigensystem", " ", "/@", " ", 
          RowBox[{"H0Blocks", "[", 
           RowBox[{"n", ",", "g"}], "]"}]}], ")"}]}], ",", "GaussianJ"}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sigmaxi", "[", 
    RowBox[{"i_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Tensor", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"j", "\[Equal]", "i"}], ",", "Sigmax", ",", "Id"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.784466385725573*^9, 3.7844663949493732`*^9}, {
   3.784466429117978*^9, 3.78446670760364*^9}, 3.784466925677313*^9, {
   3.784466967880921*^9, 3.784466987886636*^9}, {3.784467743844446*^9, 
   3.784467753572928*^9}, 3.784467875426347*^9},
 CellLabel->"In[77]:=",ExpressionUUID->"670298ac-85df-4f56-a46a-14f74ec2276b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Corr1", "=", 
   RowBox[{"Normal", "@", 
    RowBox[{
     RowBox[{"myDataSetUPD", "[", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"#g", "\[Equal]", 
         RowBox[{"-", "1.01"}]}], "&"}], "]"}], "]"}], "[", 
     RowBox[{"1", ",", 
      RowBox[{
       RowBox[{"TwoTimeCorrelator", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#\[Rho]SS", "[", "\"\<dat\>\"", "]"}], "//", "Normal"}], "//",
           "Vectorise"}], ",", 
         RowBox[{"my\[ScriptCapitalL]", "[", 
          RowBox[{"#n", ",", "#g", ",", "#\[CapitalDelta]"}], "]"}], ",", 
         RowBox[{"Sigmaxi", "[", 
          RowBox[{"1", ",", "#n"}], "]"}], ",", 
         RowBox[{"Sigmaxi", "[", 
          RowBox[{"1", ",", "#n"}], "]"}], ",", "0.025", ",", "50"}], "]"}], 
       "&"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.784621942849203*^9, 3.784621943561521*^9}, {
  3.784635886012445*^9, 3.784636019036838*^9}, {3.784636433363813*^9, 
  3.784636441450787*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"cd46fcc4-a9fe-4154-9550-aad9486f5f86"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Corr5", "=", 
   RowBox[{"Normal", "@", 
    RowBox[{"myDataSetUPD", "[", 
     RowBox[{"1", ",", 
      RowBox[{
       RowBox[{"TwoTimeCorrelator", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#\[Rho]SS", "[", "\"\<dat\>\"", "]"}], "//", "Normal"}], "//",
           "Vectorise"}], ",", 
         RowBox[{"my\[ScriptCapitalL]", "[", 
          RowBox[{"#n", ",", "#g", ",", "#\[CapitalDelta]"}], "]"}], ",", 
         RowBox[{"Sigmaxi", "[", 
          RowBox[{"1", ",", "#n"}], "]"}], ",", 
         RowBox[{"Sigmaxi", "[", 
          RowBox[{"1", ",", "#n"}], "]"}], ",", "0.025", ",", "50"}], "]"}], 
       "&"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.784533482692813*^9, 3.784533488616378*^9}, 
   3.7845336196375103`*^9, {3.784533665445115*^9, 3.7845336682661133`*^9}, {
   3.784533961084414*^9, 3.78453396374543*^9}, 3.784619505475692*^9, {
   3.784619625947348*^9, 3.784619663552719*^9}, 3.7846197194792147`*^9, {
   3.784620616348175*^9, 3.7846206200028467`*^9}, 3.7846217267727003`*^9, {
   3.784635876251197*^9, 3.784635882328205*^9}, 3.784636006517579*^9, 
   3.7846360954803658`*^9},
 CellLabel->
  "In[240]:=",ExpressionUUID->"219a9144-4954-46c3-b5ad-25ac89845596"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "[", "\[Omega]", "]"}], ",", 
     RowBox[{
      RowBox[{"\[Chi]", "''"}], "[", "\[Omega]", "]"}]}], "}"}], "=", 
   RowBox[{"Fourier", "/@", "Corr1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "\[Omega]", "]"}], "=", 
   RowBox[{"2", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{"S", "[", "\[Omega]", "]"}], "]"}], "/", 
     RowBox[{"Im", "[", 
      RowBox[{
       RowBox[{"\[Chi]", "''"}], "[", "\[Omega]", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsColumn", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"S", "[", "\[Omega]", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", "2000"}], "\[RightDoubleBracket]"}], "//", "Abs"}],
       ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]", "''"}], "[", "\[Omega]", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", "200"}], "\[RightDoubleBracket]"}], "//", "Abs"}], 
      ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{
         RowBox[{"F", "[", "\[Omega]", "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "200"}], "\[RightDoubleBracket]"}]}], ")"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.784619668744276*^9, 3.7846197062344437`*^9}, {
   3.784620358798139*^9, 3.7846203599213448`*^9}, {3.7846204231657248`*^9, 
   3.784620596745276*^9}, {3.784620665725564*^9, 3.78462079707758*^9}, {
   3.784620852461979*^9, 3.7846208529299994`*^9}, {3.784620929294162*^9, 
   3.784620934058016*^9}, {3.784621545322806*^9, 3.784621559626321*^9}, {
   3.784621603070457*^9, 3.784621687794601*^9}, {3.784622208477879*^9, 
   3.784622210034835*^9}, {3.784622261428553*^9, 3.784622263887953*^9}, {
   3.784622569546192*^9, 3.7846225725086184`*^9}, {3.784635276356223*^9, 
   3.78463527924892*^9}, {3.784635318365419*^9, 3.784635354603979*^9}, {
   3.784635431962998*^9, 3.784635445167438*^9}, {3.784635610479473*^9, 
   3.784635632653901*^9}, {3.784636160961884*^9, 3.784636182829197*^9}, 
   3.784637437927367*^9, 3.784637505431603*^9, {3.784649871120266*^9, 
   3.784649872006585*^9}, {3.7846499443016987`*^9, 3.7846499577690487`*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"a26eca8e-aa9e-4a08-83ac-541cbdb65b43"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Abs", "@*", "Fourier"}], "@", "Corr"}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "200"}], "]"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"Inset", "[", 
     RowBox[{
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"Corr", "//", "Re"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "250."}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"3500.", ",", "1.75"}], "}"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.784466385725573*^9, 3.7844663949493732`*^9}, {
   3.784466429117978*^9, 3.78446670760364*^9}, 3.784466925677313*^9, {
   3.784466967880921*^9, 3.784466987886636*^9}, {3.784467743844446*^9, 
   3.784467753572928*^9}, {3.784467875426347*^9, 3.784467878804017*^9}, {
   3.784467916016412*^9, 3.784467931730906*^9}, {3.784468228589033*^9, 
   3.784468229426305*^9}, 3.784468276666985*^9, {3.784468365710037*^9, 
   3.78446838381205*^9}, {3.784468415012765*^9, 3.784468565162315*^9}, {
   3.784468597237549*^9, 3.7844686274861927`*^9}, {3.784468682301544*^9, 
   3.784468722898423*^9}, {3.784468762430838*^9, 3.7844688235624657`*^9}, {
   3.7845278071675777`*^9, 3.7845278123866873`*^9}, {3.784528795293869*^9, 
   3.7845288415125713`*^9}, {3.7845334747569313`*^9, 3.784533570577677*^9}, 
   3.784533623800083*^9, {3.784533663494609*^9, 3.7845336639142036`*^9}, {
   3.784533811462455*^9, 3.784533860257689*^9}, {3.78453392569958*^9, 
   3.784533946476778*^9}, 3.784535304598494*^9, {3.7845360162586803`*^9, 
   3.784536042535585*^9}, {3.784537957754107*^9, 3.784537981270343*^9}, {
   3.78454251047959*^9, 3.784542517798766*^9}, {3.7845710994999313`*^9, 
   3.7845711000648127`*^9}, {3.784571497354876*^9, 3.78457158283263*^9}, {
   3.784571641690627*^9, 3.7845716437484283`*^9}, {3.7845719180348797`*^9, 
   3.784571969398328*^9}, {3.784572851256796*^9, 3.784572866662737*^9}, {
   3.784572903044417*^9, 3.7845730457052317`*^9}, {3.784573487105383*^9, 
   3.784573528681162*^9}, {3.784650075123382*^9, 
   3.7846501219587603`*^9}},ExpressionUUID->"789e3066-83d5-4572-879f-\
a9302c653931"],

Cell[TextData[StyleBox["Using duality to avoid slow-convergence",
 FontSize->36,
 FontWeight->"Bold",
 FontSlant->"Italic",
 FontColor->RGBColor[0.5, 0, 0.5]]], "Subsection",
 CellChangeTimes->{{3.782767706993628*^9, 3.7827677296384068`*^9}, {
   3.782767766990347*^9, 3.782767784022325*^9}, {3.782769005817195*^9, 
   3.7827690066411753`*^9}, {3.782980812597793*^9, 3.782980829720235*^9}, 
   3.782980861580955*^9, {3.782980939058238*^9, 3.782980957917297*^9}, {
   3.782981008685337*^9, 3.782981020496685*^9}, {3.78326585986362*^9, 
   3.7832658672596827`*^9}},
 TextAlignment->Center,ExpressionUUID->"215a244e-cbd8-454e-a3f3-b3407649f930"]
}, Closed]]
}, Open  ]]
},
WindowSize->{950, 1016},
WindowMargins->{{552, Automatic}, {Automatic, 120}},
TaggingRules->{"TryRealOnly" -> False},
SpellingDictionaries->{"CorrectWords"->{
 "vectorisation", "vectorised", "superoperator", "Superoperators", 
  "Vectorisation"}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"a40405ba-cdd3-4f6d-a3f0-df4b2c0eb784"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 258, 4, 119, "Title",ExpressionUUID->"9a6541f6-6e5a-4a0b-81ae-684aa90ced29"],
Cell[841, 28, 254, 4, 38, "Subsubtitle",ExpressionUUID->"cd367d62-e6f8-4e51-8feb-e88431a7f824"],
Cell[1098, 34, 2130, 36, 653, "Text",ExpressionUUID->"24652ef9-fa9b-4466-b8e4-62ecfeba1919"],
Cell[CellGroupData[{
Cell[3253, 74, 232, 5, 42, "Subsection",ExpressionUUID->"e6d358c6-3334-4296-a59b-d3b9da42052c"],
Cell[3488, 81, 11418, 322, 887, "Input",ExpressionUUID->"3dae8cad-8af4-4daf-b5f7-7ccf859d290d",
 InitializationCell->True],
Cell[14909, 405, 2652, 67, 225, "Input",ExpressionUUID->"64f09110-8704-405a-b419-265879908b21"],
Cell[17564, 474, 1864, 48, 98, "Input",ExpressionUUID->"2674cfca-836d-4988-a99b-5bed0697764d"],
Cell[19431, 524, 29296, 669, 2612, "Input",ExpressionUUID->"ddd986c8-1c40-42da-8b38-49dac05edf17"],
Cell[48730, 1195, 397, 9, 49, "Input",ExpressionUUID->"a8ebe624-eae2-44b3-8473-b672fa534667"],
Cell[49130, 1206, 154, 3, 49, "Input",ExpressionUUID->"841f3749-93f3-4719-bd3c-5a674d4c75cc"],
Cell[49287, 1211, 292, 7, 49, "Input",ExpressionUUID->"ff930e79-fb54-4e46-846f-495579bf6ee1"],
Cell[49582, 1220, 929, 26, 73, "Input",ExpressionUUID->"204c0c21-9098-4e09-a003-0b4e70dd73d2",
 InitializationCell->True],
Cell[50514, 1248, 223, 5, 42, "Text",ExpressionUUID->"efaa4c7d-7842-46c8-8943-e901b56610d9"],
Cell[50740, 1255, 1055, 22, 122, "Input",ExpressionUUID->"59e8dcb7-d84c-4d9a-9c85-b60dd571a4cc",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[51832, 1282, 166, 3, 42, "Subsection",ExpressionUUID->"44d65023-07d0-4aa4-bc98-4d2d9ea1c09c"],
Cell[52001, 1287, 571, 10, 126, "Text",ExpressionUUID->"75679fcb-6d09-4191-8339-0ff6b84ad41f"],
Cell[CellGroupData[{
Cell[52597, 1301, 247, 6, 58, "Subsubsubsubsection",ExpressionUUID->"a28bb186-20f2-44da-b2c0-91082fdf4b55"],
Cell[52847, 1309, 356, 8, 42, "Text",ExpressionUUID->"4aa6145b-e948-4287-9f8d-5caed4184481"],
Cell[53206, 1319, 399, 9, 49, "Input",ExpressionUUID->"7d56c287-4d0e-4167-960f-eaa45eb6b0f3",
 InitializationCell->True],
Cell[53608, 1330, 268, 6, 70, "Text",ExpressionUUID->"b9016e34-1a93-4e4b-914c-81b28cd844d7"],
Cell[53879, 1338, 396, 11, 49, "Input",ExpressionUUID->"bb63ba91-911e-4baf-87e8-4667d8b1fc43"],
Cell[54278, 1351, 268, 6, 42, "Text",ExpressionUUID->"73aaf152-b23f-47d9-b97a-e8a9836d0e60"],
Cell[54549, 1359, 665, 18, 53, "Input",ExpressionUUID->"851d5e77-02e3-4b74-a50a-aab265c2aa0a",
 InitializationCell->True],
Cell[55217, 1379, 691, 20, 49, "Input",ExpressionUUID->"fa5ea1a5-8727-4d83-80df-2bfd26c9eeb7"],
Cell[55911, 1401, 247, 4, 42, "Text",ExpressionUUID->"45a8a8a8-fe2f-4451-a878-caeb8d19c26d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56195, 1410, 182, 3, 33, "Subsubsubsubsection",ExpressionUUID->"7db30a52-c1bc-49df-8a23-8363b8960b4f"],
Cell[56380, 1415, 289, 6, 70, "Text",ExpressionUUID->"c13877c1-a28f-4a92-9ff9-1e61c09f6838"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56706, 1426, 483, 11, 37, "Subsubsubsubsection",ExpressionUUID->"341a1913-fd2a-47e6-b4c5-fbd1f0e06ae3"],
Cell[57192, 1439, 928, 20, 104, "Text",ExpressionUUID->"249cd4e8-7808-4c43-b61e-6379ab302bfc"],
Cell[58123, 1461, 575, 13, 49, "Input",ExpressionUUID->"61935a72-8996-4cd5-83ae-858493c11171",
 InitializationCell->True],
Cell[58701, 1476, 1020, 25, 98, "Input",ExpressionUUID->"d219b44e-3e74-4a04-b231-00fdd9c7c52c"],
Cell[59724, 1503, 361, 7, 70, "Text",ExpressionUUID->"2854c931-81c1-46c2-b632-1d0585bfe9f7"],
Cell[60088, 1512, 511, 14, 78, "Text",ExpressionUUID->"e879f5bd-5afe-4342-828c-aff492ea092a"],
Cell[60602, 1528, 861, 21, 74, "Input",ExpressionUUID->"8016488b-2c3a-4787-8b74-9a88a21824dd",
 InitializationCell->True],
Cell[61466, 1551, 277, 7, 49, "Input",ExpressionUUID->"514efa67-3e6f-4e09-83da-60e4417d0d5c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61792, 1564, 197, 3, 42, "Subsection",ExpressionUUID->"243bebf4-710c-4e0c-be88-8cda197bba95"],
Cell[61992, 1569, 1056, 31, 42, "Text",ExpressionUUID->"3c2f73e1-9c63-4aff-9089-c9d67cd7a8be"],
Cell[63051, 1602, 4210, 112, 88, "Input",ExpressionUUID->"53cbbadd-6dc4-4879-90ae-d1acb99ed212",
 InitializationCell->True],
Cell[67264, 1716, 1031, 31, 42, "Text",ExpressionUUID->"f575048a-2a90-4600-908f-db5af5bd0817"],
Cell[68298, 1749, 4091, 111, 90, "Input",ExpressionUUID->"1a61cb6a-c37a-432a-bb46-b52592b3654f",
 InitializationCell->True],
Cell[72392, 1862, 234, 6, 42, "Text",ExpressionUUID->"056778e9-930b-4b16-8ddf-ba74a0e40d53"],
Cell[72629, 1870, 2490, 64, 92, "Input",ExpressionUUID->"68911ace-f75a-4bc0-ad09-3c6eccc35af4",
 InitializationCell->True],
Cell[75122, 1936, 273, 7, 49, "Input",ExpressionUUID->"1bd9984c-0b91-4279-864d-20949533e689"],
Cell[75398, 1945, 278, 6, 42, "Text",ExpressionUUID->"44679c90-e395-45ba-a468-0fd454aacb0c"],
Cell[CellGroupData[{
Cell[75701, 1955, 1301, 37, 37, "Subsubsubsubsection",ExpressionUUID->"63f11a1b-648c-4370-9550-a0e16e6c8e52"],
Cell[77005, 1994, 1183, 37, 73, "Text",ExpressionUUID->"eb911832-ba2a-4b4c-b22b-94127142e68a"],
Cell[78191, 2033, 227, 5, 42, "Text",ExpressionUUID->"f6803a27-b7a8-4ebd-a3af-9277e538fdc2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78455, 2043, 1404, 46, 36, "Subsubsubsubsection",ExpressionUUID->"a17fe85e-e3c9-4c56-8412-bf1a011db1f8"],
Cell[79862, 2091, 1004, 26, 98, "Text",ExpressionUUID->"ad2afcbc-dec5-41d0-abaa-085136228c43"],
Cell[80869, 2119, 3526, 75, 146, "Input",ExpressionUUID->"582d41b9-2e74-4abb-aba6-c770071fa34b",
 InitializationCell->True],
Cell[84398, 2196, 279, 5, 49, "Input",ExpressionUUID->"e7f47351-afb9-411e-95f3-9249e6a57c85"],
Cell[84680, 2203, 4530, 112, 439, "Text",ExpressionUUID->"465edc96-a196-41e2-856e-8951a6f54c8b"],
Cell[89213, 2317, 1262, 30, 103, "Input",ExpressionUUID->"8511841e-3bf6-40b8-a87a-282c1c33030c",
 InitializationCell->True],
Cell[90478, 2349, 992, 26, 148, "Text",ExpressionUUID->"a59316a3-3c5b-459f-94dd-a7bd0570435f"],
Cell[91473, 2377, 675, 20, 74, "Input",ExpressionUUID->"7c0bbc33-8ebb-41c9-95ef-fbb0020185b4",
 InitializationCell->True],
Cell[92151, 2399, 729, 16, 126, "Text",ExpressionUUID->"65b2de77-3a9d-4881-b599-00696bc5ec22"],
Cell[92883, 2417, 2146, 51, 218, "Input",ExpressionUUID->"9bb5849d-5140-491a-846f-663e85aee910",
 InitializationCell->True],
Cell[95032, 2470, 966, 25, 98, "Text",ExpressionUUID->"dfe298a6-5f55-406f-b923-0b66001e5bef"],
Cell[96001, 2497, 3821, 97, 276, "Input",ExpressionUUID->"175a8bd5-481a-482c-8461-5e259d45648a",
 InitializationCell->True],
Cell[99825, 2596, 2542, 57, 242, "Input",ExpressionUUID->"947884b6-16d8-42e0-868e-28f5c9c37c45",
 InitializationCell->True],
Cell[102370, 2655, 597, 15, 98, "Text",ExpressionUUID->"df7b57d4-7563-4a6d-a14e-e08464005fd4"],
Cell[102970, 2672, 3735, 89, 375, "Input",ExpressionUUID->"27fea042-22aa-4c43-a242-0ac013a7f749",
 InitializationCell->True],
Cell[106708, 2763, 376, 7, 98, "Text",ExpressionUUID->"45a58041-7735-486a-984e-caae16a3d890"],
Cell[107087, 2772, 718, 19, 49, "Input",ExpressionUUID->"1b345f93-2c1d-45fb-9fe2-f000bd233076",
 InitializationCell->True],
Cell[107808, 2793, 884, 24, 74, "Input",ExpressionUUID->"fdb3adec-20fa-481b-a16c-e6204f3cae66",
 InitializationCell->True],
Cell[108695, 2819, 3054, 75, 375, "Input",ExpressionUUID->"2a21a298-50e4-4e60-8154-0d17ee2b5c1c",
 InitializationCell->True],
Cell[111752, 2896, 870, 24, 98, "Input",ExpressionUUID->"7b14e44e-504d-4ee5-a988-046fcecb9f86",
 InitializationCell->True],
Cell[112625, 2922, 493, 13, 49, "Input",ExpressionUUID->"47ccf236-4d1f-4bf9-a618-240f681d842e"],
Cell[113121, 2937, 806, 19, 74, "Input",ExpressionUUID->"2420181a-dc11-4933-8e7b-fc8c83c2ba77",
 InitializationCell->True],
Cell[113930, 2958, 6728, 154, 520, "Input",ExpressionUUID->"449274c7-2e03-42d8-aff9-832e79fcc7f8"],
Cell[120661, 3114, 337, 8, 49, "Input",ExpressionUUID->"d9416076-9868-4c7d-8218-ff0fb97159ff"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[121047, 3128, 189, 3, 42, "Subsection",ExpressionUUID->"d18599da-45bb-4350-8716-9521ebda7ff6"],
Cell[121239, 3133, 1099, 30, 98, "Input",ExpressionUUID->"e6c00a1c-e139-48bc-98aa-95626455800c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[122375, 3168, 194, 3, 42, "Subsection",ExpressionUUID->"b061796f-15ac-4471-8fca-2ae9e0cd43c2"],
Cell[CellGroupData[{
Cell[122594, 3175, 171, 3, 41, "Subsubsection",ExpressionUUID->"af6abe0d-b71d-48f4-84e6-efd0900ea99e"],
Cell[122768, 3180, 500, 12, 45, "Text",ExpressionUUID->"9bf8a601-a55f-406f-8d5c-46e9b697f44d"],
Cell[CellGroupData[{
Cell[123293, 3196, 522, 16, 33, "Subsubsubsubsection",ExpressionUUID->"854c3152-42de-4deb-a69a-2c96a661db7c"],
Cell[123818, 3214, 199, 3, 40, "Text",ExpressionUUID->"ea961ad9-2661-4b73-ab0e-d8aabf9f50dd"],
Cell[124020, 3219, 422, 10, 50, "Input",ExpressionUUID->"debc9315-6715-4d9d-a4df-d9a059894932",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[124491, 3235, 244, 4, 40, "Subsubsection",ExpressionUUID->"78f3e632-6df5-4410-a409-869263b1d5eb"],
Cell[124738, 3241, 324, 7, 70, "Text",ExpressionUUID->"5d97b636-d503-4b51-afcd-20aa5a3bd37a"],
Cell[125065, 3250, 1015, 27, 98, "Input",ExpressionUUID->"0b3c1959-e670-4ec3-9836-4c6aa43f1046",
 InitializationCell->True],
Cell[126083, 3279, 1276, 25, 49, "Input",ExpressionUUID->"4caa0fba-7761-42da-9aa5-b9e0dcc410aa",
 InitializationCell->True],
Cell[127362, 3306, 4024, 90, 157, "Input",ExpressionUUID->"974c49ec-57d0-48b0-a376-c219d2e9f988"],
Cell[131389, 3398, 599, 16, 122, "Input",ExpressionUUID->"b9a3ca9a-4044-4650-b533-c8b65e3b2de0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[132037, 3420, 166, 3, 42, "Subsection",ExpressionUUID->"a06ccba4-fb4a-444e-899c-3de90decc58f"],
Cell[132206, 3425, 359, 7, 70, "Text",ExpressionUUID->"31fd13b1-2941-4a22-9e4d-b802d3cd42c2"],
Cell[CellGroupData[{
Cell[132590, 3436, 1805, 53, 36, "Subsubsubsubsection",ExpressionUUID->"0719a73d-da3d-40b7-b95b-f8f5b8c2d949"],
Cell[134398, 3491, 462, 12, 42, "Text",ExpressionUUID->"eaaa4f34-198e-4281-8561-3dd86d8b54d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134897, 3508, 830, 25, 36, "Subsubsubsubsection",ExpressionUUID->"cc6656fa-6f47-4cae-bc96-e89894ca1ca1"],
Cell[135730, 3535, 1859, 50, 100, "Text",ExpressionUUID->"823efcb3-366d-4e91-b1b0-3be9a31df830"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137626, 3590, 1304, 39, 36, "Subsubsubsubsection",ExpressionUUID->"1992a218-eb91-413f-bbf3-b06478fe8a9e"],
Cell[138933, 3631, 197, 3, 42, "Text",ExpressionUUID->"b084223d-0d68-4459-89ee-0165507e71fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139167, 3639, 1197, 36, 35, "Subsubsubsubsection",ExpressionUUID->"d26e99f8-27ce-4e23-b4b9-f196ec5c8ef1"],
Cell[140367, 3677, 3774, 78, 497, "Text",ExpressionUUID->"4267017f-22de-438d-b3d6-42ece6a65f8a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[144190, 3761, 180, 3, 42, "Subsection",ExpressionUUID->"f399adfc-1c85-4948-a92a-c9fb44dd19eb"],
Cell[144373, 3766, 556, 13, 70, "Text",ExpressionUUID->"30e85e41-cb61-479c-81c9-2b64eab21753"],
Cell[144932, 3781, 6109, 155, 645, "Input",ExpressionUUID->"9762b6d3-118a-430f-abe7-ff561f6b41d4",
 InitializationCell->True],
Cell[151044, 3938, 9363, 225, 789, "Input",ExpressionUUID->"2c7c5f50-1a02-44ff-99ee-cdbb4bdc639b",
 InitializationCell->True],
Cell[160410, 4165, 615, 16, 42, "Text",ExpressionUUID->"733cabd6-617e-49fb-b7cb-73c0f0b94ef9"],
Cell[CellGroupData[{
Cell[161050, 4185, 1296, 40, 35, "Subsubsubsubsection",ExpressionUUID->"642f9b30-910d-435a-9990-992e2ae55140"],
Cell[162349, 4227, 1374, 37, 146, "Input",ExpressionUUID->"ad3423e6-6361-4e6f-a89a-f3c0bbb3190d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[163772, 4270, 193, 3, 42, "Subsection",ExpressionUUID->"936a3811-3de8-4928-ac71-7084a9745b7b"],
Cell[163968, 4275, 8153, 199, 886, "Input",ExpressionUUID->"2572b0e9-90c6-4591-9462-a7e1896bdd16",
 InitializationCell->True],
Cell[172124, 4476, 11705, 276, 1000, "Input",ExpressionUUID->"22c1df37-082d-4d5e-8273-4226e0748c4a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[183866, 4757, 169, 3, 41, "Subsection",ExpressionUUID->"a90d8dd0-7c18-43fb-af3c-6311bcc56292"],
Cell[184038, 4762, 23003, 604, 2312, "Input",ExpressionUUID->"8a0cf1f1-d58f-4636-bd4b-8310875eff9c",
 InitializationCell->True],
Cell[207044, 5368, 39164, 772, 3101, "Input",ExpressionUUID->"35377d4c-a3cf-4340-bdd9-34e3be7783da",
 InitializationCell->True],
Cell[246211, 6142, 3712, 95, 525, "Input",ExpressionUUID->"f8ba7f8d-bd25-4920-b694-f3e29b049bd3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[249960, 6242, 323, 9, 41, "Subsection",ExpressionUUID->"6dbd48af-73cc-4617-b406-5501773b2862"],
Cell[250286, 6253, 11219, 217, 1250, "Input",ExpressionUUID->"2911c71d-9210-4f5f-96b6-ebd1bb13b76d",
 InitializationCell->True],
Cell[261508, 6472, 2250, 55, 278, "Input",ExpressionUUID->"e42d8cd5-bfff-4432-8ef2-52036a94a0e0",
 InitializationCell->True],
Cell[263761, 6529, 3482, 76, 415, "Input",ExpressionUUID->"896c8073-8d9b-4d0d-ae6a-8a4d6e7cb608",
 InitializationCell->True],
Cell[267246, 6607, 1129, 30, 80, "Input",ExpressionUUID->"6ebc747b-e00e-457d-845d-e026dc77d950",
 InitializationCell->True],
Cell[268378, 6639, 152, 3, 51, "Input",ExpressionUUID->"ceeee744-247f-43cc-8c2e-5914e19618e0"],
Cell[CellGroupData[{
Cell[268555, 6646, 602, 17, 40, "Subsubsection",ExpressionUUID->"e97bbb5c-a1f4-4ce4-a28f-d8189499b241"],
Cell[269160, 6665, 965, 28, 215, "Input",ExpressionUUID->"f19aad67-850a-4e8d-8a3e-d2641b4876bf"],
Cell[270128, 6695, 3995, 68, 130, "Input",ExpressionUUID->"52412e82-bc2e-4b06-b537-88abeb28e639"],
Cell[274126, 6765, 786, 22, 130, "Input",ExpressionUUID->"c103624e-c052-4932-83ba-eff9519f787c"],
Cell[274915, 6789, 490, 11, 50, "Input",ExpressionUUID->"53d0a1e3-47d6-474e-b65b-4b96b3ec9815"],
Cell[275408, 6802, 306, 6, 50, "Input",ExpressionUUID->"176831fd-9b91-421e-a064-737d1561af08"],
Cell[275717, 6810, 878, 17, 50, "Input",ExpressionUUID->"812a3b04-1edd-443e-a04e-769b76013b70"],
Cell[276598, 6829, 411, 10, 50, "Input",ExpressionUUID->"42fddb97-0062-4667-a810-604d27c980bb"],
Cell[277012, 6841, 515, 12, 75, "Input",ExpressionUUID->"d6dbf29c-1a13-4281-9174-276e8d589247"],
Cell[277530, 6855, 502, 11, 75, "Input",ExpressionUUID->"b7ed23cb-bc66-44b2-ade9-b9db70790d80"],
Cell[278035, 6868, 727, 13, 75, "Input",ExpressionUUID->"bbc3b5ba-e00d-4180-8200-7992fd508256"],
Cell[278765, 6883, 670, 15, 75, "Input",ExpressionUUID->"bf97fffb-7524-42b1-9c64-25c1e322a0fb"],
Cell[279438, 6900, 615, 13, 50, "Input",ExpressionUUID->"748c992e-536c-460a-b0a8-370538731559"],
Cell[280056, 6915, 1266, 32, 112, "Input",ExpressionUUID->"1efb1331-baa3-47cb-b190-d128874dbcaa"],
Cell[281325, 6949, 152, 3, 50, "Input",ExpressionUUID->"1b4c32d4-f943-4463-b7ef-69d3a7ddc060"],
Cell[281480, 6954, 249, 6, 50, "Input",ExpressionUUID->"6d437c36-cd94-4b9f-82c4-18b199d8e490"],
Cell[281732, 6962, 317, 6, 50, "Input",ExpressionUUID->"225a72cf-f92c-40ad-98c0-4c23fe4513ca"],
Cell[282052, 6970, 791, 15, 75, "Input",ExpressionUUID->"d65c7ec6-a2c5-4cc1-875d-47b3dedadb96"],
Cell[282846, 6987, 695, 14, 50, "Input",ExpressionUUID->"e03c2548-b240-4958-8423-c76ef6e0df36"],
Cell[283544, 7003, 434, 9, 50, "Input",ExpressionUUID->"bd0c8b78-d158-47ed-b0e7-c5c74321fc62"],
Cell[283981, 7014, 389, 9, 50, "Input",ExpressionUUID->"4c35addc-e4d0-4979-bc27-d6091757b480"],
Cell[284373, 7025, 196, 3, 50, "Input",ExpressionUUID->"c6e3f9fe-76c0-42ed-934a-3a6f6d310b54"],
Cell[284572, 7030, 3748, 80, 240, "Input",ExpressionUUID->"52794a95-e1f7-4174-b636-61a530ba1d4c"]
}, Closed]],
Cell[CellGroupData[{
Cell[288357, 7115, 186, 3, 40, "Subsubsection",ExpressionUUID->"228deb38-4753-4fb0-b44a-78aec3d34707"],
Cell[288546, 7120, 200, 3, 50, "Input",ExpressionUUID->"16a74d4a-187d-480d-abae-d3591afc0b71"],
Cell[288749, 7125, 2484, 65, 136, "Input",ExpressionUUID->"65d9c84d-ea49-4609-a5a0-dbe0954e4044"],
Cell[291236, 7192, 11324, 286, 1328, "Input",ExpressionUUID->"62e5f80a-996e-45f4-aaaa-09012d35da19"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[302609, 7484, 205, 3, 41, "Subsection",ExpressionUUID->"3d2ca3e5-9a2f-45a2-88cb-07302b8045a1"],
Cell[302817, 7489, 4485, 117, 701, "Input",ExpressionUUID->"e26bd5ce-0dd7-4442-8c7a-e75ef8eebc4e"],
Cell[307305, 7608, 583, 10, 50, "Input",ExpressionUUID->"b4fec963-573c-4a7c-9bb2-6f00a0c1f035"],
Cell[307891, 7620, 262, 6, 40, "Text",ExpressionUUID->"cd1b8067-0d8b-4904-804a-b1c090bd95cd"],
Cell[308156, 7628, 4291, 116, 701, "Input",ExpressionUUID->"710b5146-e374-4b12-827b-b0a3045b1b44"],
Cell[312450, 7746, 203, 3, 40, "Text",ExpressionUUID->"b362f666-a362-4a9a-942f-c3716657c3c6"],
Cell[312656, 7751, 4445, 122, 736, "Input",ExpressionUUID->"8d2b7a21-9202-43fd-a9bf-ef5a78b9044f"],
Cell[317104, 7875, 293, 6, 50, "Input",ExpressionUUID->"0aa42a74-3651-43de-9c0f-22fd949a0a72"]
}, Closed]],
Cell[CellGroupData[{
Cell[317434, 7886, 174, 3, 41, "Subsection",ExpressionUUID->"a7471874-b919-45d4-8da6-772dbe09ec03"],
Cell[317611, 7891, 1407, 36, 165, "Input",ExpressionUUID->"6835d816-b2a4-48f2-a551-c3a740117fe3"],
Cell[319021, 7929, 222, 3, 50, "Input",ExpressionUUID->"0e09f27b-4f33-403b-ba9d-ad2007a44a11"],
Cell[319246, 7934, 246, 6, 40, "Text",ExpressionUUID->"396328f8-af9d-46fa-a105-5b0b9852f59c"]
}, Closed]],
Cell[CellGroupData[{
Cell[319529, 7945, 176, 3, 67, "Section",ExpressionUUID->"99144d61-c019-47cd-ac0e-e68d27ccba3d"],
Cell[319708, 7950, 2234, 60, 160, "Input",ExpressionUUID->"f3c25826-e83e-46b7-963b-3f6b742337d9"],
Cell[321945, 8012, 455, 8, 74, "Input",ExpressionUUID->"38fc7704-8ede-4946-ba8c-04b9cff90e0b"],
Cell[322403, 8022, 327, 8, 49, "Input",ExpressionUUID->"88ab5992-331a-4098-93d7-e5b2cf29f7e7"],
Cell[322733, 8032, 315, 9, 49, "Input",ExpressionUUID->"6ab6d1f2-6f81-4531-ae4e-e0144be17f3f"],
Cell[323051, 8043, 513, 14, 49, "Input",ExpressionUUID->"5d601053-a9de-48d6-be15-017e48f951f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[323601, 8062, 255, 4, 86, "Section",ExpressionUUID->"04c33c07-f2ad-4c4c-ade3-76510608ecfb"],
Cell[323859, 8068, 976, 28, 98, "Input",ExpressionUUID->"85e57689-79d8-4d86-8066-c1db14021ac2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[324872, 8101, 602, 17, 86, "Section",ExpressionUUID->"387bb6b3-83c8-422d-a767-9e41d861cce4"],
Cell[325477, 8120, 2181, 32, 514, "Text",ExpressionUUID->"b740325d-a498-4c43-9f9d-8787a6b6e522"],
Cell[CellGroupData[{
Cell[327683, 8156, 251, 4, 42, "Subsection",ExpressionUUID->"a6924e97-9747-4e27-8698-397927ded899"],
Cell[327937, 8162, 185, 3, 40, "Text",ExpressionUUID->"693d10e7-6261-4ab6-a948-aa9de105bff3"],
Cell[CellGroupData[{
Cell[328147, 8169, 533, 15, 28, "Subsubsubsubsection",ExpressionUUID->"ff84b507-36a9-4457-8f53-8747f0f49d48"],
Cell[328683, 8186, 278, 6, 67, "Text",ExpressionUUID->"1b6b705a-a2c0-4cde-9b1f-4f9265acea2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328998, 8197, 565, 12, 28, "Subsubsubsubsection",ExpressionUUID->"1a57d61d-2f76-472f-944c-a71e376bf729"],
Cell[329566, 8211, 632, 11, 187, "Text",ExpressionUUID->"b8a2a75e-befc-4f8f-8ac1-506c4be750b9"],
Cell[330201, 8224, 3277, 70, 300, "Input",ExpressionUUID->"9964f613-4525-4e66-a972-e9aec5887ccc",
 InitializationCell->True],
Cell[333481, 8296, 2401, 42, 103, "Input",ExpressionUUID->"93c0131d-326c-491c-8854-f8b60e5359a3"],
Cell[335885, 8340, 6240, 151, 150, "Input",ExpressionUUID->"2d0b53ce-c905-4f7a-acd4-07e17a56a99f"],
Cell[342128, 8493, 2204, 40, 103, "Input",ExpressionUUID->"9456d147-c04c-46d5-9c91-6f7bdb79ca53"],
Cell[344335, 8535, 1805, 43, 240, "Input",ExpressionUUID->"24fb3e2e-8f03-41e0-8d85-a1628b379f4b"],
Cell[346143, 8580, 513, 9, 128, "Text",ExpressionUUID->"68bf3904-bc02-48c1-9d1c-0702567cb3de"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[346705, 8595, 288, 5, 41, "Subsection",ExpressionUUID->"31e60b16-23c9-4189-8316-204277799d95"],
Cell[346996, 8602, 1363, 30, 209, "Text",ExpressionUUID->"0e09f376-78a1-4c28-a9b8-489fc606c4b9"],
Cell[348362, 8634, 845, 14, 181, "Text",ExpressionUUID->"ba5051c0-4a00-41ee-be7d-a9442e136326"],
Cell[349210, 8650, 2181, 57, 262, "Input",ExpressionUUID->"e54a1f47-d2a8-4357-b48f-6a0db3fb9784",
 InitializationCell->True],
Cell[351394, 8709, 1790, 35, 405, "Text",ExpressionUUID->"6c70606a-792d-4d64-9bf3-37afeb0d496c"],
Cell[353187, 8746, 16559, 339, 2215, "Input",ExpressionUUID->"43c80013-7644-43fc-b277-d894878cf7c0",
 InitializationCell->True],
Cell[369749, 9087, 784, 18, 122, "Input",ExpressionUUID->"7ad660b8-9c17-4577-957e-583780b90ce3",
 InitializationCell->True],
Cell[370536, 9107, 3114, 83, 362, "Input",ExpressionUUID->"abe7aacc-3431-4d63-92f1-3f1149494658"],
Cell[373653, 9192, 521, 12, 74, "Input",ExpressionUUID->"fd0340bf-2fce-4e74-9e82-2b0449b1e9bd"],
Cell[374177, 9206, 9613, 204, 1701, "Input",ExpressionUUID->"ae26c2f1-fcca-4ca1-bd37-d40a6c137e85"]
}, Open  ]],
Cell[CellGroupData[{
Cell[383827, 9415, 196, 3, 40, "Subsection",ExpressionUUID->"f94a1f3a-8e76-44b2-b1e1-8b3d5a7c667f"],
Cell[384026, 9420, 5126, 115, 420, "Input",ExpressionUUID->"965effd0-03fe-473b-90f9-72582c7ce6dd"],
Cell[389155, 9537, 3331, 58, 206, "Input",ExpressionUUID->"e133774f-e27b-4e8b-b884-7d1b2cff3261"],
Cell[392489, 9597, 154, 3, 51, "Input",ExpressionUUID->"0de1c1f9-731b-49f9-af23-26bb305b1c99"],
Cell[392646, 9602, 453, 13, 83, "Input",ExpressionUUID->"30080d96-f31d-49da-87ef-390a1a44616b"],
Cell[393102, 9617, 971, 22, 87, "Input",ExpressionUUID->"35649eda-304a-4e1a-bc03-2cec70bcad95"],
Cell[394076, 9641, 1683, 47, 175, "Input",ExpressionUUID->"7c62a476-d577-4105-b171-a8c1e609ba40"],
Cell[395762, 9690, 152, 3, 50, "Input",ExpressionUUID->"4f683885-76bb-4b0d-91da-3df405b7d717"]
}, Closed]],
Cell[CellGroupData[{
Cell[395951, 9698, 178, 3, 40, "Subsection",ExpressionUUID->"343dabf3-2152-4b94-95bf-ebb36f396c8c"],
Cell[396132, 9703, 12098, 257, 2150, "Input",ExpressionUUID->"8aaa1765-51db-4a61-b9e8-94a882b5b0c4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[408267, 9965, 195, 3, 40, "Subsection",ExpressionUUID->"b25173a5-afb1-47ba-a389-d90ec3e8d6d2"],
Cell[408465, 9970, 3217, 73, 381, "Input",ExpressionUUID->"3a54e072-2c07-4880-b8c9-8e4fb4c2886a",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[411731, 10049, 327, 8, 67, "Section",ExpressionUUID->"de539516-c5fe-41a1-be15-f9d2b7ff7489"],
Cell[412061, 10059, 10976, 239, 1350, "Input",ExpressionUUID->"a4a093d4-1a5a-4e18-9fb0-44b0dffe2d33"],
Cell[423040, 10300, 1457, 37, 122, "Input",ExpressionUUID->"670298ac-85df-4f56-a46a-14f74ec2276b"],
Cell[424500, 10339, 1122, 29, 98, "Input",ExpressionUUID->"cd46fcc4-a9fe-4154-9550-aad9486f5f86"],
Cell[425625, 10370, 1265, 28, 146, "Input",ExpressionUUID->"219a9144-4954-46c3-b5ad-25ac89845596"],
Cell[426893, 10400, 2680, 64, 146, "Input",ExpressionUUID->"a26eca8e-aa9e-4a08-83ac-541cbdb65b43"],
Cell[429576, 10466, 2388, 44, 98, "Input",ExpressionUUID->"789e3066-83d5-4572-879f-a9302c653931"],
Cell[431967, 10512, 642, 11, 66, "Subsection",ExpressionUUID->"215a244e-cbd8-454e-a3f3-b3407649f930"]
}, Closed]]
}, Open  ]]
}
]
*)

